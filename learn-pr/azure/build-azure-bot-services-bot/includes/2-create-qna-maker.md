### <a name="exercise-2-create-a-knowledge-base-with-microsoft-qna-maker"></a>演習 2: Microsoft QnA Maker でナレッジ ベースを作成する

[Azure Cognitive Services](https://www.microsoft.com/cognitive-services/) の一部である [Microsoft QnA Maker](https://www.qnamaker.ai/) は、AI と機械学習によるインテリジェントなアプリをビルドするためのサービスと API のスイートです。 ボットがユーザーからのあらゆる質問を予測して応答を提供するためのコードを書くのではなく、ボットを QnA Maker で作成された質問と回答のナレッジ ベースに接続することができます。 一般的な使用シナリオは、「Windows プロダクト キーはどこにありますか」や「Visual Studio Code はどこでダウンロードできますか」といったドメイン固有の質問にボットが回答できるように、よく寄せられる質問からナレッジ ベースを作成することです。

この演習では、QnA Maker を使用して、"スーパー ボウルで最も優勝回数の多い NFL チームはどこですか" や "世界最大の都市はどこですか?" といった質問を含むナレッジ ベースを作成します 次に、HTTPS エンドポイントを経由してアクセスできるように、ナレッジ ベースを Azure Web アプリにデプロイします。

1. ブラウザーで [Microsoft QnA Maker ポータル](https://www.qnamaker.ai/)を開き、自分の Microsoft アカウントでサインインします (まだサインインしていない場合)。 次に、ページ上部のメニュー バーで **[ナレッジ ベースの作成]** をクリックします。
 
    ![ナレッジ ベースを作成する](../images/qna-new-kb.png)

    "ナレッジ ベースを作成する"__

1. **[Create a QnA service]\(QnA サービスの作成\)** をクリックします。

    ![QnA サービスを作成する](../images/create-kb-1.png)

    "QnA サービスを作成する"__

1. **[名前]** ボックスに "qa-factbot-kb" などの名前を入力します。 この名前は、Azure 内で一意である必要があるため、名前の横、*および*ブレードの下の方にある **[アプリ名]** ボックスに緑色のチェック マークが表示されることを確認します。 **[リソース グループ]** の下で **[既存のものを使用]** を選択し、[演習 1](#Exercise1) で Azure Web アプリ ボットをデプロイしたときに作成した "factbot-rg" リソース グループを選択します。 価格レベルとして **[F0]** と **[F]** を選択します  (どちらも無料で、ボットを試すには最適なレベルです)。両方の場所のドロップダウンで最も近い場所を選択してから、ブレードの下部にある **[作成]** ボタンをクリックします。

    ![QnA サービスを作成する](../images/new-qna-maker-service.png)

    "QnA サービスを作成する"__

1. ポータルの左側にあるリボンで **[リソース グループ]** をクリックして、"factbot-rg" リソース グループを開きます。 ブレードの上部の "デプロイ中" が、QnA のサービスとそれに関連付けられているリソースが正常にデプロイされたことを示す "成功" に変わるまで待ちます。 デプロイの状態を更新するには、もう一度ブレードの上部の **[更新]** をクリックします。

    ![デプロイに成功](../images/resource-group-master-2.png)

    "デプロイに成功"__

1. QnA Maker ポータルで [[ナレッジ ベースの作成]](https://www.qnamaker.ai/Create) ページに戻ります。 **Azure QnA サービス**の下で、手順 3 で指定した名前の QnA サービスを選択します。 次に、ナレッジ ベースに "Factbot ナレッジ ベース" などの名前を割り当てます。

    ![ナレッジ ベースに名前を付ける](../images/create-kb-2-3.png)

    "ナレッジ ベースに名前を付ける"__

1. QnA Maker のナレッジ ベースに手動で質問と回答を入力することも、オンラインのよく寄せられる質問またはローカル ファイルから質問と回答をインポートすることもできます。 サポートされている形式には、タブ区切りテキスト ファイル、Microsoft Word 文書、Excel スプレッドシート、PDF ファイルが含まれます。

    試してみるには、[ここをクリック](https://topcs.blob.core.windows.net/public/bots-resources.zip)して、**Factbot.tsv** という名前のテキスト ファイルを含む ZIP ファイルをダウンロードし、ファイルをご使用のコンピューターにコピーします。 次に、QnA Maker ポータルで下にスクロールして、**[+ ファイルの追加]** をクリックして、**Factbot.tsv** を選択します。 このファイルには、20 の質問と回答がタブ区切り形式で含まれています。

    ![ナレッジ ベースを追加する](../images/create-kb-4.png)

    "ナレッジ ベースを追加する"__

1. ページの下部の **[Create your KB]\(KB の作成\)** をクリックして、ナレッジ ベースが作成されるのを待ちます。 通常は 1 分以内に終わります。

    ![ナレッジ ベースを作成する](../images/create-kb-5.png)

    "ナレッジ ベースを作成する"__

1. **Factbot.tsv** からインポートされた質問と回答がナレッジ ベースに表示されることを確認します。 **[Save and train]\(保存してトレーニング\)** をクリックして、トレーニングが完了するのを待ちます。

    ![ナレッジ ベースをトレーニングする](../images/save-and-train.png)

    "ナレッジ ベースをトレーニングする"__

1. **[Save and train]\(保存してトレーニング\)** ボタンの右にある **[テスト]** ボタンをクリックします。 メッセージ ボックスに「こんにちは」と入力して、**Enter** キーを押します。 次に示すように、応答が "QnA Factbot へようこそ" となることを確認します。

    ![ナレッジ ベースをテストする](../images/test-kb.png)

    "ナレッジ ベースをテストする"__

1. メッセージ ボックスに、「最も売れた本は何ですか?」と入力し、 **Enter** キーを押します。 応答はどのようになるでしょう。

1. もう一度 **[テスト]** ボタンをクリックして、[テスト] パネルを折りたたみます。 次に、ページ上部のメニューで **[発行]** をクリックして、ページの下部にある **[発行]** ボタンをクリックしてナレッジ ベースを発行します。 *発行*すると、ナレッジ ベースが HTTPS エンドポイントで使用可能になります。

    ![ナレッジ ベースを発行する](../images/publish-kb.png)

    "ナレッジ ベースを発行する"__ 

発行プロセスが完了するまで待機し、QnA サービスのデプロイ完了のメッセージが表示されるのを確認します。 これで、Azure Web アプリで独自のナレッジ ベースがホストされるようになったので、次の手順では、それを使用できるボットをデプロイします。