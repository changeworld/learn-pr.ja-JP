この演習では、Azure portal を使用してロード バランサー、仮想ネットワーク、および複数の仮想マシンを作成します。

あなたは、オンライン銀行サービスを立ち上げようとしているスタートアップ企業である Woodgrove Bank で働いているものとします。 このセクターは競争が激しいので、99.99% 以上のサービス可用性を保証する必要があります。 あなたは、3 つの仮想マシンを含むプールを使用する Azure Load Balancer でこの目標が達成されると判断しました。

## <a name="create-a-public-load-balancer"></a>パブリック ロード バランサーを作成する

1. ブラウザーで [Azure portal](https://portal.azure.com/?azure-portal=true) に移動し、自分のアカウントにサインインします。

1. サイドバーで **[リソースの作成]** をクリックし、**[新規]** ブレードで **[ネットワーキング]** をクリックして、**[ロード バランサー]** をクリックします。

1. [ロード バランサーの作成] ブレードで次の情報を入力または選択します。
    - 名前: **woodgrove-LB**
    - 種類: **パブリック**
    - SKU: **Basic**
    - パブリック IP アドレス: **[新規作成]** を選択し、とテキスト ボックスに「**woodgrove-LB-ip**」と入力して、[割り当て] は **[動的]** のままにします
    - リソース グループ: **[新規作成]** を選択し、ボックスに「**woodgrove-RG**」と入力します
    - 場所: 近くのリージョンを選択します

1. **[作成]** をクリックします。

1. ロード バランサーが展開されるまで待ってから、演習を続けます。

## <a name="create-a-virtual-network"></a>仮想ネットワークを作成する

1. 左側のメニューで **[リソースの作成]** をクリックし、**[新規]** ブレードで **[ネットワーキング]** をクリックして、**[仮想ネットワーク]** をクリックします。

1. **[仮想ネットワークの作成]** ブレードで次の情報を入力または選択します。
    - 名前: **woodgrove-VNET**
    - アドレス空間: **172.20.0.0/16**
    - リソース グループ: **[既存のものを使用]** を選択し、**woodgrove-RG** を選択します。
    - サブネット: **backendSubnet**
    - アドレス空間: **172.20.0.0/24**
    - DDoS protection: **Basic (基本)**
    - サービス エンドポイント: **無効**

1. **[作成]** をクリックします。

1. 仮想ネットワークが展開されるまで待ってから、演習を続けます。

## <a name="create-a-vm-template"></a>VM テンプレートを作成する

最初に、VM の基本的な情報を定義します。

1. Azure portal の左側のメニューで **[Virtual Machines]** をクリックし、**[仮想マシンの作成]** をクリックします。

1. [Compute] ブレードの **[お勧め]** セクションで、**[Windows Server]** をクリックします。

1. **[Windows Server]** ブレードで、**[Windows Server 2016 Datacenter]** をクリックします。

1. **[Windows Server 2016 Datacenter]** ブレードで、**[作成]** をクリックします。

1. **[基本]** ブレードで、**[名前]** ボックスに「**woodgrove-SVR01**」と入力します。

1. **[ユーザー名]** ボックスと **[パスワード]** ボックスに、このサーバーの管理者アカウントの安全な名前とパスワードを入力します。

1. **[サブスクリプション]** ボックスで Azure サブスクリプションを選択します。

1. **[リソース グループ]** で **[既存のものを使用]** を選択し、一覧で **woodgrove-RG** を選択します。

1. **[場所]** ドロップダウン リストで、近くのリージョンを選択します

1. **[OK]** をクリックします。

VM のサイズを選択し、設定を構成します。

1. **[サイズの選択]** ブレードで、**[D2s_v3]** などの **[Standard]** を選択してから、**[選択]** をクリックします。

1. **[設定]** ブレードで **[可用性セット]** をクリックします。

1. **[可用性セットの変更]** ブレードで、**[新規作成]** をクリックします。

1. **[新規作成]** ブレードで、**[名前]** ボックスに「**woodgrove-AS**」と入力して、**[OK]** をクリックします。

1. **[設定]** ブレードで、**[ネットワーク セキュリティ グループ]** の **[詳細設定]** をクリックして、**(新規) woodgrove-SVR01 nsg** をクリックします。

1. **[ネットワーク セキュリティ グループの作成]** ブレードの **[名前]** ボックスで、名前を「**woodgrove-NSG**」に変更して、**[OK]** をクリックします。

1. **[設定]** ブレードで **[OK]** をクリックします。

設定をテンプレートに保存し、複数の VM を簡単に展開できるようにします。

1. **[作成]** ブレードで、**[テンプレートとパラメーターのダウンロード]** をクリックします。

1. **[テンプレート]** ブレードで、**[ライブラリに追加]** をクリックします。

1. **[テンプレートの保存]** ブレードで、**[名前]** ボックスと **[説明]** ボックスに「**woodgrove-server-template**」と入力して、**[保存]** をクリックします。

> [!NOTE]
> このテンプレートを探す必要がある場合は、左側のメニューで **[すべてのサービス]** をクリックし、フィルター ボックスに「**テンプレート**」と入力して、**[Templates (PREVIEW)]\(テンプレート (プレビュー)\)** をクリックします。

## <a name="use-the-template-to-provision-the-first-vm"></a>テンプレートを使用して最初の VM をプロビジョニングする

1. **[テンプレート]** ブレードで、**[デプロイ]** をクリックします。

1. **[カスタム デプロイ]** ブレードの **[リソース グループ]** で **[既存のものを使用]** を選択し、一覧で **woodgrove-RG** を選択します。

1. **[カスタム デプロイ]** ブレードの **[管理パスワード]** ボックスに、以前に使用したものと同じパスワードを入力します。

1. **[カスタム デプロイ]** ブレードで、**[上記のご契約条件に同意します]** チェック ボックスをオンにし、**[購入]** をクリックします (コストは通常の Azure コンピューティング料金であり、VM の価格レベルに依存します)。

1. VM が展開されるまで待ってから、演習を続行します。これにより、他の VM のプロビジョニングに使用する前にテンプレートが正しく構成されていることを確認でき、関連するすべてのリソースが作成されます。

## <a name="use-the-template-to-provision-two-additional-vms"></a>テンプレートを使用して他の 2 つの VM をプロビジョニングする

1. Azure portal の **[テンプレート]** ブレードで、**[デプロイ]** をクリックします。

1. **[カスタム デプロイ]** ブレードの **[リソース グループ]** で **[既存のものを使用]** を選択し、一覧で **woodgrove-RG** を選択します。

1. **[カスタム デプロイ]** ブレードで、**[仮想マシン名]** ボックスの名前を「**woodgrove-SVR02**」に変更します。

1. **[カスタム デプロイ]** ブレードで、**[Network Interface Name]\(ネットワーク インターフェイス名\)** ボックスの名前を「**woodgrovesvr02222**」に変更します。

1. **[カスタム デプロイ]** ブレードの **[管理パスワード]** ボックスに、以前に使用したものと同じパスワードを入力します。

1. **[カスタム デプロイ]** ブレードで、**[パブリック IP アドレス名]** ボックスの名前を「**woodgrove-SVR02-ip**」に変更します。

1. **[カスタム デプロイ]** ブレードで、**[上記のご契約条件に同意します]** チェック ボックスをオンにし、**[購入]** をクリックします (コストは通常の Azure コンピューティング料金であり、VM の価格レベルに依存します)。

1. 次の情報を使用して、手順 1 - 7 を繰り返します。
    - 仮想マシン名: **woodgrove-SVR03**
    - Network Interface Name (ネットワーク インターフェイス名): **woodgrovesvr03333**
    - パブリック IP アドレス名: **woodgrove-SVRr03-ip**

1. VM が展開されるまで待ってから、演習を続けます。

パブリック ロード バランサーを構成できる状態になり、このロード バランサーで 3 つの VM を使用する準備ができました。