<span data-ttu-id="9ff20-101">分散された音楽共有アプリケーションのアーキテクチャを計画しているとします。</span><span class="sxs-lookup"><span data-stu-id="9ff20-101">Suppose you are planning the architecture of a distributed music-sharing application.</span></span> <span data-ttu-id="9ff20-102">アプリケーションでできるだけ高い信頼性とスケーラビリティを確保し、Azure テクノロジを使用して堅牢な通信インフラストラクチャを構築しようとしています。</span><span class="sxs-lookup"><span data-stu-id="9ff20-102">You want to ensure that the application is as reliable and scalable as possible and you intend to use Azure technologies to build a robust communication infrastructure.</span></span>

<span data-ttu-id="9ff20-103">適切な Azure テクノロジを選択するには、まずアプリケーションのコンポーネントが交わす個々の通信について理解しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="9ff20-103">Before you can choose the right Azure technology, you must understand each individual communication that the components of the application exchange.</span></span> <span data-ttu-id="9ff20-104">通信ごとに異なる Azure テクノロジを選択できます。</span><span class="sxs-lookup"><span data-stu-id="9ff20-104">For each communication you can choose a different Azure technology.</span></span>

<span data-ttu-id="9ff20-105">通信についてまず理解しなければならないのは、メッセージとイベントのどちらを送信するかということです。</span><span class="sxs-lookup"><span data-stu-id="9ff20-105">The first thing to understand about a communication is whether it sends messages or events.</span></span> <span data-ttu-id="9ff20-106">Azure テクノロジには、イベントをターゲットとするものとメッセージをターゲットとするものがあり、これが基本的な選択肢となります。</span><span class="sxs-lookup"><span data-stu-id="9ff20-106">Some Azure technologies target events and other target messages so this is a fundamental choice.</span></span>

## <a name="what-is-a-message"></a><span data-ttu-id="9ff20-107">メッセージとは何でしょうか。</span><span class="sxs-lookup"><span data-stu-id="9ff20-107">What is a message?</span></span>

<span data-ttu-id="9ff20-108">分散アプリケーションの用語で、**メッセージ**には次の特性があります。</span><span class="sxs-lookup"><span data-stu-id="9ff20-108">In the terminology of distributed applications, **messages** have the following characteristics:</span></span>

- <span data-ttu-id="9ff20-109">メッセージには、1 つのコンポーネントによって生成され、別のコンポーネントで使用される生のデータが含まれています。</span><span class="sxs-lookup"><span data-stu-id="9ff20-109">A message contains raw data, produced by one component, that will be consumed by another component.</span></span>
- <span data-ttu-id="9ff20-110">メッセージには、データへの参照だけでなく、データ自体が含まれています。</span><span class="sxs-lookup"><span data-stu-id="9ff20-110">A message contains the data itself, not just a reference to that data.</span></span>
- <span data-ttu-id="9ff20-111">送信側コンポーネントは、メッセージのコンテンツが宛先コンポーネントによって特定の方法で処理されることを想定しています。</span><span class="sxs-lookup"><span data-stu-id="9ff20-111">The sending component expects the message content to be processed in a certain way by the destination component.</span></span> <span data-ttu-id="9ff20-112">システム全体の整合性は、特定のジョブを実行する送信側と受信側の両方によって決まる場合があります。</span><span class="sxs-lookup"><span data-stu-id="9ff20-112">The integrity of the overall system may depend on both sender and receiver doing a specific job.</span></span>

<span data-ttu-id="9ff20-113">たとえば、ユーザーがモバイルの音楽共有アプリを使用して新しい曲をアップロードするとします。</span><span class="sxs-lookup"><span data-stu-id="9ff20-113">For example, suppose a user uploads a new song by using the mobile music-sharing app.</span></span> <span data-ttu-id="9ff20-114">モバイル アプリは、Azure で実行されている Web API にその曲を送信する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9ff20-114">The mobile app must send that song to the web API that runs in Azure.</span></span> <span data-ttu-id="9ff20-115">新しい曲が追加されたことを示すアラートだけでなく、曲のメディア ファイル自体を送信する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9ff20-115">The song media file itself must be sent, not just an alert that indicates that a new song has been added.</span></span> <span data-ttu-id="9ff20-116">モバイル アプリは、Web API が新しい曲をデータベースに格納し、他のユーザーが利用できるようにすることを想定しています。</span><span class="sxs-lookup"><span data-stu-id="9ff20-116">The mobile app expects that the web API will store the new song in the database and make it available to other users.</span></span> <span data-ttu-id="9ff20-117">これはメッセージの例です。</span><span class="sxs-lookup"><span data-stu-id="9ff20-117">This is an example of a message.</span></span>

## <a name="what-is-an-event"></a><span data-ttu-id="9ff20-118">イベントとは何でしょうか。</span><span class="sxs-lookup"><span data-stu-id="9ff20-118">What is an event?</span></span>

<span data-ttu-id="9ff20-119">**イベント**はメッセージよりも軽量で、ほとんどの場合、ブロードキャスト通信に使用されます。</span><span class="sxs-lookup"><span data-stu-id="9ff20-119">**Events** are lighter-weight than messages and are most often used for broadcast communications.</span></span> <span data-ttu-id="9ff20-120">イベントを送信するコンポーネントは**発行元**と呼ばれ、受信側は**サブスクライバー**と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="9ff20-120">The components sending the event are known as **publishers** and receivers are known as **subscribers**.</span></span>

<span data-ttu-id="9ff20-121">イベントでは、一般的に受信側コンポーネントは対象の通信を決定し、それらの通信を "サブスクライブ" します。</span><span class="sxs-lookup"><span data-stu-id="9ff20-121">With events, receiving components will generally decide in which communications they are interested and "subscribe" to those.</span></span> <span data-ttu-id="9ff20-122">通常、サブスクリプションは Azure Event Grid や Azure Event Hubs などの仲介役によって管理されます。</span><span class="sxs-lookup"><span data-stu-id="9ff20-122">The subscription is usually managed by an intermediary like Azure Event Grid or Azure Event Hub.</span></span> <span data-ttu-id="9ff20-123">発行元がイベントを送信すると、仲介役は対象のサブスクライバーにそのイベントをルーティングします。</span><span class="sxs-lookup"><span data-stu-id="9ff20-123">When publishers send an event, the intermediary will route that event to interested subscribers.</span></span> <span data-ttu-id="9ff20-124">これは "発行/サブスクライブ アーキテクチャ" と呼ばれ、イベントを処理する唯一の方法ではありませんが、最も一般的です。</span><span class="sxs-lookup"><span data-stu-id="9ff20-124">This is known as a "publish-subscribe architecture", it is not the only way to deal with events, but it is the most common.</span></span>

<span data-ttu-id="9ff20-125">イベントには次の特性があります。</span><span class="sxs-lookup"><span data-stu-id="9ff20-125">Events have the following characteristics:</span></span>

- <span data-ttu-id="9ff20-126">イベントは、何かが発生したことを示す軽量の通知です。</span><span class="sxs-lookup"><span data-stu-id="9ff20-126">An event is a lightweight notification that indicates that something happened.</span></span>
- <span data-ttu-id="9ff20-127">イベントは複数の受信側に送信される場合も、まったく送信されない場合もあります。</span><span class="sxs-lookup"><span data-stu-id="9ff20-127">The event may be sent to multiple receivers or to none at all.</span></span>
- <span data-ttu-id="9ff20-128">多くの場合、イベントは "ファンアウト" することを意図したり、発行元ごとに多数のサブスクライバーが存在します。</span><span class="sxs-lookup"><span data-stu-id="9ff20-128">Events are often intended to "fan-out" or have a large number of subscribers for each publisher.</span></span>
- <span data-ttu-id="9ff20-129">イベントの発行元は、受信側コンポーネントが実行するアクションについて何も想定していません。</span><span class="sxs-lookup"><span data-stu-id="9ff20-129">The publisher of the event has no expectation about the action a receiving component takes.</span></span>
- <span data-ttu-id="9ff20-130">一部のイベントは個別のユニットであり、他のイベントに関連しません。</span><span class="sxs-lookup"><span data-stu-id="9ff20-130">Some events are discrete units and unrelated to other events.</span></span> 
- <span data-ttu-id="9ff20-131">また、順序指定された関連するシリーズの一部であるイベントもあります。</span><span class="sxs-lookup"><span data-stu-id="9ff20-131">Some events are part of a related and ordered series.</span></span>  

<span data-ttu-id="9ff20-132">たとえば、音楽ファイルのアップロードが完了し、データベースに新しい曲が追加されたとします。</span><span class="sxs-lookup"><span data-stu-id="9ff20-132">For example, suppose the music file upload has been completed and the new song has been added to the database.</span></span> <span data-ttu-id="9ff20-133">ユーザーに新しいファイルを通知するために、Web API は Web フロント エンドおよびモバイル アプリ ユーザーに新しいファイルを通知する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9ff20-133">In order to inform users of the new file, the web API must inform the web front-end and mobile app users of the new file.</span></span> <span data-ttu-id="9ff20-134">ユーザーは、新しい曲を聴くかどうかを選択できます。つまり、最初の通知には音楽ファイルは含まれず、その曲が存在することをユーザーに通知するだけです。</span><span class="sxs-lookup"><span data-stu-id="9ff20-134">The users can choose whether to listen to the new song, so the initial notification does not include the music file but only notifies users that the song exists.</span></span> <span data-ttu-id="9ff20-135">送信側は、イベントの受信側がこのイベント受信に応答して特に何かを実行することは、想定していません。</span><span class="sxs-lookup"><span data-stu-id="9ff20-135">The sender does not have a specific expectation that the event receivers will do anything particular in response the receiving this event.</span></span>

<span data-ttu-id="9ff20-136">これは、個別のイベントの例です。</span><span class="sxs-lookup"><span data-stu-id="9ff20-136">This is an example of a discrete event.</span></span>

## <a name="how-to-choose-messages-or-events"></a><span data-ttu-id="9ff20-137">メッセージまたはイベントを選択する方法</span><span class="sxs-lookup"><span data-stu-id="9ff20-137">How to choose messages or events</span></span>

<span data-ttu-id="9ff20-138">1 つのアプリケーションが、ある目的のためにイベントを使用し、別の目的のためにメッセージを使用するということはよくあります。</span><span class="sxs-lookup"><span data-stu-id="9ff20-138">A single application is likely to use events for some purposes and messages for others.</span></span> <span data-ttu-id="9ff20-139">選択を行う前に、アプリケーションのアーキテクチャとそのすべてのユース ケースを分析して、そのコンポーネントが相互に通信する際のさまざまな目的をすべて識別する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9ff20-139">Before you choose, you must analyze your application architecture and all its use cases to identify all the different purposes its components have to communicate with each other.</span></span> 

<span data-ttu-id="9ff20-140">イベントは、ブロードキャストに使用される可能性が高く、多くの場合に一時的です。つまり、通信が現在サブスクライブされていない場合、受信側で処理されない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="9ff20-140">Events are more likely to be used for broadcasts and are often ephemeral, meaning a communication might not be handled by any receiver if none are currently subscribing.</span></span> <span data-ttu-id="9ff20-141">メッセージは、分散アプリケーションで、通信の処理を保証する必要がある場合に使用される可能性が高くなります。</span><span class="sxs-lookup"><span data-stu-id="9ff20-141">Messages are more likely to be used where the distributed application requires a guarantee that the communication will be processed.</span></span>

<span data-ttu-id="9ff20-142">各通信について、送信側コンポーネントは通信が宛先コンポーネントによって特定の方法で処理されることを想定しているか、ということを問いかけてみてください。</span><span class="sxs-lookup"><span data-stu-id="9ff20-142">For each communication consider the question: Does the sending component expect the communication to be processed in a particular way by the destination component?</span></span>

<span data-ttu-id="9ff20-143">答えが "はい" の場合は、メッセージを使用することを選択します。</span><span class="sxs-lookup"><span data-stu-id="9ff20-143">If the answer is yes, choose to use a message.</span></span> <span data-ttu-id="9ff20-144">答えが "いいえ" の場合は、イベントを使用できる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="9ff20-144">If the answer is no, you may be able to use events.</span></span>

## <a name="summary"></a><span data-ttu-id="9ff20-145">まとめ</span><span class="sxs-lookup"><span data-stu-id="9ff20-145">Summary</span></span>

<span data-ttu-id="9ff20-146">分散アプリケーションのコンポーネントは、さまざまな目的で相互に通信します。</span><span class="sxs-lookup"><span data-stu-id="9ff20-146">The components of a distributed application communicate with each other for many different purposes.</span></span> <span data-ttu-id="9ff20-147">これらの個々の目的について、その目的に合わせて設計された Azure テクノロジを選択するために、イベントとメッセージのどちらを使用するかを選択する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9ff20-147">For each of these purposes, you must choose whether to use events or messages so that you can choose an Azure technology that is designed for that purpose.</span></span> 

<span data-ttu-id="9ff20-148">コンポーネントが通信する理由、およびイベントとメッセージのどちらを使用するかを理解しておくと、情報を交換するために Azure Storage キュー、Event Hubs、Event Grid、または Service Bus から選択する手順に進むことができます。</span><span class="sxs-lookup"><span data-stu-id="9ff20-148">Having understood why your components communicate and whether they use events or messages, you can proceed to choose from Azure Storage queues, Event Hubs, Event Grids, or Service Bus to exchange the information.</span></span>