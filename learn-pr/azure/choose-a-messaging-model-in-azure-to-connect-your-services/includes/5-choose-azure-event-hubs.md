<span data-ttu-id="e561f-101">ほぼ同数のソースから膨大な数のイベントを生成する特定のアプリケーションがあります。</span><span class="sxs-lookup"><span data-stu-id="e561f-101">There are certain applications that produce a massive number of events from almost as many sources.</span></span> <span data-ttu-id="e561f-102">このような状況に適用される "ビッグ データ" という語をよく耳にしますが、こうしたデータを処理するには独自のインフラストラクチャが必要です。</span><span class="sxs-lookup"><span data-stu-id="e561f-102">We often hear the term "Big Data" applied to these situations, and they require unique infrastructure to handle them.</span></span>

<span data-ttu-id="e561f-103">あなたは Contoso Aircraft Engines に勤務しているとします。</span><span class="sxs-lookup"><span data-stu-id="e561f-103">Imagine you work for Contoso Aircraft Engines.</span></span> <span data-ttu-id="e561f-104">雇用主が製造するエンジンは何百ものセンサーを備えています。</span><span class="sxs-lookup"><span data-stu-id="e561f-104">The engines your employer manufactures have hundreds of sensors.</span></span> <span data-ttu-id="e561f-105">毎朝航空機が飛行する前に、そのエンジンがテスト ハーネスに接続され、性能が試されます。</span><span class="sxs-lookup"><span data-stu-id="e561f-105">Before an aircraft can be flown each morning, its engines are connected to a test harness and put through their paces.</span></span> <span data-ttu-id="e561f-106">さらに、航空機が地上器材に接続されているときに、キャッシュされた飛行中のデータがストリーミングされます。</span><span class="sxs-lookup"><span data-stu-id="e561f-106">Additionally, cached in-flight data is streamed when the aircraft is connected to ground equipment.</span></span>

<span data-ttu-id="e561f-107">あなたは、センサーの履歴データを使用して、エンジンの故障がまもなく発生する可能性が高いことを示すセンサー測定値のパターンを見つけようとしています。</span><span class="sxs-lookup"><span data-stu-id="e561f-107">You want to use historic sensor data to find patterns in the sensor readings that indicate engine failure is likely to happen soon.</span></span> <span data-ttu-id="e561f-108">リアルタイムのセンサー測定値を、これらの故障パターンと比較します。</span><span class="sxs-lookup"><span data-stu-id="e561f-108">You want the real-time sensor readings to be compared against these failure patterns.</span></span> <span data-ttu-id="e561f-109">これにより、エンジンが疑わしい測定値を示す場合に、ほぼリアルタイムでユーザーに警告することができます。</span><span class="sxs-lookup"><span data-stu-id="e561f-109">You can then warn users in near real time if an engine is showing worrisome readings.</span></span>

## <a name="what-is-azure-event-hubs"></a><span data-ttu-id="e561f-110">Azure Event Hubs とは</span><span class="sxs-lookup"><span data-stu-id="e561f-110">What is Azure Event Hubs?</span></span>
<span data-ttu-id="e561f-111">Event Hubs は、発行/サブスクライブ通信パターンの仲介役です。</span><span class="sxs-lookup"><span data-stu-id="e561f-111">Event Hubs is an intermediary for the publish-subscribe communication pattern.</span></span> <span data-ttu-id="e561f-112">しかし、Event Grid とは異なり、非常に高いスループット、多数の発行元、セキュリティ、および回復性に対して最適化されています。</span><span class="sxs-lookup"><span data-stu-id="e561f-112">Unlike Event Grid, however, it is optimized for extremely high throughput, a large number of publishers, security, and resiliency.</span></span>

#### <a name="what-is-an-event-hub"></a><span data-ttu-id="e561f-113">Event Hubs とは</span><span class="sxs-lookup"><span data-stu-id="e561f-113">What is an Event Hub?</span></span>

> [!VIDEO https://www.microsoft.com/videoplayer/embed/RE2yuat]

<span data-ttu-id="e561f-114">Event Grid は、サブスクリプションを単純に管理し、これらのサブスクライバーに通信をルーティングする点で、発行/サブスクライブ通信パターンと完全に合致します。これに対して Event Hubs では、かなり多くの追加サービスを実行します。</span><span class="sxs-lookup"><span data-stu-id="e561f-114">Whereas Event Grid fits perfectly into the publish-subscribe pattern in that it simply manages subscriptions and routes communications to those subscribers, Event Hubs performs quite a few additional services.</span></span> <span data-ttu-id="e561f-115">これらのサービスのため、Event Hubs は、単純なイベント ブロードキャスターよりもサービス バスやメッセージ キューに似ています。</span><span class="sxs-lookup"><span data-stu-id="e561f-115">These additional services make it look more like a service bus or message queue, than a simple event broadcaster.</span></span>

#### <a name="partitions"></a><span data-ttu-id="e561f-116">パーティション</span><span class="sxs-lookup"><span data-stu-id="e561f-116">Partitions</span></span>
<span data-ttu-id="e561f-117">Event Hubs は通信を受信すると、その通信をパーティションに分割します。</span><span class="sxs-lookup"><span data-stu-id="e561f-117">As Event Hubs receives communications, it divides them into partitions.</span></span> <span data-ttu-id="e561f-118">パーティションは、通信が保存されるバッファーです。</span><span class="sxs-lookup"><span data-stu-id="e561f-118">Partitions are buffers into which the communications are saved.</span></span> <span data-ttu-id="e561f-119">イベント バッファーのため、イベントは完全に一時的なものではなく、サブスクライバーがビジー状態またはオフラインであってもイベントが見落とされることはありません。</span><span class="sxs-lookup"><span data-stu-id="e561f-119">Because of the event buffers, events are not completely ephemeral, and an event isn't missed just because a subscriber is busy or even offline.</span></span> <span data-ttu-id="e561f-120">サブスクライバーでは、常にバッファーを使用して "キャッチアップ" することができます。</span><span class="sxs-lookup"><span data-stu-id="e561f-120">The subscriber can always use the buffer to "catch up."</span></span> <span data-ttu-id="e561f-121">既定では、イベントはバッファー内に 24 時間留まった後、自動的に期限切れとなります。</span><span class="sxs-lookup"><span data-stu-id="e561f-121">By default, events stay in the buffer for 24 hours before they automatically expire.</span></span>

<span data-ttu-id="e561f-122">バッファーは、それらの間でデータが分割されるため、パーティションと呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="e561f-122">The buffers are called partitions because the data is divided amongst them.</span></span> <span data-ttu-id="e561f-123">すべてのイベント ハブには少なくとも 2 つのパーティションが含まれ、各パーティションにはサブスクライバーの別個のセットが含まれます。</span><span class="sxs-lookup"><span data-stu-id="e561f-123">Every event hub has at least two partitions, and each partition has a separate set of subscribers.</span></span>

#### <a name="capture"></a><span data-ttu-id="e561f-124">キャプチャ</span><span class="sxs-lookup"><span data-stu-id="e561f-124">Capture</span></span>
<span data-ttu-id="e561f-125">Event Hubs は、Azure Data Lake または Azure Blob Storage にすべてのイベントを瞬時に送信して、永続性を低コストで実現することができます。</span><span class="sxs-lookup"><span data-stu-id="e561f-125">Event Hubs can send all your events immediately to Azure Data Lake or Azure Blob storage for inexpensive, permanent persistence.</span></span>

#### <a name="authentication"></a><span data-ttu-id="e561f-126">認証</span><span class="sxs-lookup"><span data-stu-id="e561f-126">Authentication</span></span>
<span data-ttu-id="e561f-127">すべての発行元が認証され、トークンが発行されます。</span><span class="sxs-lookup"><span data-stu-id="e561f-127">All publishers are authenticated and issued a token.</span></span> <span data-ttu-id="e561f-128">つまり、Event Hubs では、いたずらにより不正なデータが分析に支障をきたすことを心配せずに、外部デバイスおよびモバイル アプリからのイベントを受け取ることができます。</span><span class="sxs-lookup"><span data-stu-id="e561f-128">This means Event Hubs can accept events from external devices and mobile apps, without worrying that fraudulent data from pranksters could ruin our analysis.</span></span> 

## <a name="using-event-hubs"></a><span data-ttu-id="e561f-129">Event Hubs の使用</span><span class="sxs-lookup"><span data-stu-id="e561f-129">Using Event Hubs</span></span>
<span data-ttu-id="e561f-130">Event Hubs では、イベント ストリームと他の Azure サービスの間のパイプライン設定がサポートされています。</span><span class="sxs-lookup"><span data-stu-id="e561f-130">Event Hubs has support for pipelining event streams to other Azure services.</span></span> <span data-ttu-id="e561f-131">たとえば、Azure Stream Analytics とともに使用すると、複数のイベントを関連付けてパターンを見つける機能により、ほぼリアルタイムでデータの複雑な分析を行うことができます。</span><span class="sxs-lookup"><span data-stu-id="e561f-131">Using it with Azure Stream Analytics, for instance, allows complex analysis of data in near real time, with the ability to correlate multiple events and look for patterns.</span></span> <span data-ttu-id="e561f-132">この場合、Stream Analytics はサブスクライバーと見なされます。</span><span class="sxs-lookup"><span data-stu-id="e561f-132">In this case, Stream Analytics would be considered a subscriber.</span></span>

<span data-ttu-id="e561f-133">ここでは、航空機エンジンに対して、Event Hubs がエンジンからの通信を認証できるようにアーキテクチャを設定します。</span><span class="sxs-lookup"><span data-stu-id="e561f-133">For our aircraft engines, we'll set up our architecture so that Event Hubs will authenticate the communications from our engines.</span></span> <span data-ttu-id="e561f-134">その後、キャプチャを使用してすべてのデータを Data Lake に保存するようにします。</span><span class="sxs-lookup"><span data-stu-id="e561f-134">We will then have it use capture to save all the data to Data Lake.</span></span> <span data-ttu-id="e561f-135">これらのデータはすべて、機械学習モデルを保持および向上させるために後で使用できます。</span><span class="sxs-lookup"><span data-stu-id="e561f-135">Later, we can use all that data to retrain and improve our machine learning models.</span></span> <span data-ttu-id="e561f-136">最後に、Stream Analytics のサブスクライバーによってイベント ストリームが取得されます。</span><span class="sxs-lookup"><span data-stu-id="e561f-136">Finally, our event streams will be picked up by Stream Analytics subscribers.</span></span> <span data-ttu-id="e561f-137">Stream Analytics は、機械学習モデルを使用して、問題を示す可能性のあるセンサー データのパターンを見つけます。</span><span class="sxs-lookup"><span data-stu-id="e561f-137">Stream Analytics will use our machine learning model to look for patterns in the sensor data that might indicate problems.</span></span>

<span data-ttu-id="e561f-138">複数のパーティションがあり、各エンジンではそのすべてのデータを 1 つのパーティションだけに送信するので、Stream Analytics サブスクライバーの各インスタンスでは、データ全体のサブセットを扱うだけで済みます。</span><span class="sxs-lookup"><span data-stu-id="e561f-138">Because we have several partitions, and each engine sends all its data to only one partition, each instance of our Stream Analytics subscriber only need deal with a subset of our overall data.</span></span> <span data-ttu-id="e561f-139">すべてのデータに対してフィルター処理および関連付けを行う必要はありません。</span><span class="sxs-lookup"><span data-stu-id="e561f-139">It does not have to filter and correlate over all of it.</span></span>

## <a name="which-service-should-i-choose"></a><span data-ttu-id="e561f-140">どのサービスを選択すべきか</span><span class="sxs-lookup"><span data-stu-id="e561f-140">Which service should I choose?</span></span>
<span data-ttu-id="e561f-141">キューの選択と同様に、最初は、これらの 2 つのイベント配信サービスの間で選択を行うことは困難に思われます。</span><span class="sxs-lookup"><span data-stu-id="e561f-141">Just like our queue choice, selecting between these two event delivery services can seem tricky at first.</span></span> <span data-ttu-id="e561f-142">両者とも *At Least Once* セマンティクスをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="e561f-142">Both support *At Least Once* semantics.</span></span>

#### <a name="choose-event-hubs-if"></a><span data-ttu-id="e561f-143">次の場合には、Event Hubs を選択します。</span><span class="sxs-lookup"><span data-stu-id="e561f-143">Choose Event Hubs if:</span></span>  

- <span data-ttu-id="e561f-144">多数の発行元の認証をサポートする必要がある。</span><span class="sxs-lookup"><span data-stu-id="e561f-144">You need to support authenticating a large number of publishers.</span></span>
- <span data-ttu-id="e561f-145">Data Lake または BLOB ストレージにイベントのストリームを保存する必要がある。</span><span class="sxs-lookup"><span data-stu-id="e561f-145">You need to save a stream of events to Data Lake or Blob storage.</span></span>
- <span data-ttu-id="e561f-146">イベント ストリームの集計または分析が必要である。</span><span class="sxs-lookup"><span data-stu-id="e561f-146">You need aggregation or analytics on your event stream.</span></span>
- <span data-ttu-id="e561f-147">信頼できるメッセージングまたは回復性が必要である。</span><span class="sxs-lookup"><span data-stu-id="e561f-147">You need reliable messaging or resiliency.</span></span>  

<span data-ttu-id="e561f-148">一方、信頼された発行元 (たとえば、自身の Web サーバー) とのシンプルなイベント発行/サブスクライブ インフラストラクチャが必要な場合は、Event Grid を選択する必要があります。</span><span class="sxs-lookup"><span data-stu-id="e561f-148">Otherwise, if you need a simple event publish-subscribe infrastructure, with trusted publishers (for instance, your own web server), you should choose Event Grid.</span></span>

<span data-ttu-id="e561f-149">Event Hubs を使用すると、毎秒数百万のイベントを短い待機時間で処理できる、ビッグ データ パイプラインを構築できます。</span><span class="sxs-lookup"><span data-stu-id="e561f-149">Event Hubs lets you build a big data pipeline capable of processing millions of events per second with low latency.</span></span> <span data-ttu-id="e561f-150">同時ソースからのデータを処理し、さまざまなストリーム処理インフラストラクチャや分析サービスにルーティングすることができます。</span><span class="sxs-lookup"><span data-stu-id="e561f-150">It can handle data from concurrent sources and route it to a variety of stream-processing infrastructures and analytics services.</span></span> <span data-ttu-id="e561f-151">リアルタイム処理が可能になり、格納された生データの繰り返し再生がサポートされます。</span><span class="sxs-lookup"><span data-stu-id="e561f-151">It enables real-time processing and supports repeated replay of stored raw data.</span></span> 