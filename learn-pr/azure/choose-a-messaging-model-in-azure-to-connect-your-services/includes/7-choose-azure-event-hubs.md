<span data-ttu-id="672c0-101">ほぼ同数のソースから膨大な数のイベントを生成する特定のアプリケーションがあります。</span><span class="sxs-lookup"><span data-stu-id="672c0-101">There are certain applications that produce a massive number of events from almost as many sources.</span></span> <span data-ttu-id="672c0-102">このような状況に適用される "ビッグ データ" という語をよく耳にしますが、こうしたデータを処理するには独自のインフラストラクチャが必要です。</span><span class="sxs-lookup"><span data-stu-id="672c0-102">We often hear the term "Big Data" applied to these situations and they require unique infrastructure to handle them.</span></span>

<span data-ttu-id="672c0-103">あなたが Contoso Aircraft Engines に勤務しているとします。</span><span class="sxs-lookup"><span data-stu-id="672c0-103">Imagine you work for Contoso Aircraft Engines.</span></span> <span data-ttu-id="672c0-104">雇用主が製造するエンジンは何百ものセンサーを備えています。</span><span class="sxs-lookup"><span data-stu-id="672c0-104">The engines your employer manufactures have hundreds of sensors.</span></span> <span data-ttu-id="672c0-105">毎朝航空機が飛行する前に、そのエンジンがテスト ハーネスに接続され、性能が試されます。</span><span class="sxs-lookup"><span data-stu-id="672c0-105">Before an aircraft can be flown each morning, its engines are connected to a test harness and put through their paces.</span></span> <span data-ttu-id="672c0-106">さらに、航空機が地上器材に接続されているときに、キャッシュされた飛行中のデータがストリーミングされます。</span><span class="sxs-lookup"><span data-stu-id="672c0-106">Additionally, cached in-flight data is streamed when the aircraft is connected to ground equipment.</span></span>

<span data-ttu-id="672c0-107">あなたは、センサーの履歴データを使用して、エンジンの故障がまもなく発生する可能性が高いことを示すセンサー測定値のパターンを見つけようとしています。</span><span class="sxs-lookup"><span data-stu-id="672c0-107">You want to use historic sensor data to find patterns in the sensor readings that indicate engine failure is likely to happen soon.</span></span> <span data-ttu-id="672c0-108">リアルタイムのセンサー測定値を、これらの故障パターンと比較します。</span><span class="sxs-lookup"><span data-stu-id="672c0-108">You want the real-time sensor readings to be compared against these failure patterns.</span></span> <span data-ttu-id="672c0-109">これにより、エンジンが疑わしい測定値を示す場合に、ほぼリアルタイムでユーザーに警告することができます。</span><span class="sxs-lookup"><span data-stu-id="672c0-109">You can then warn users in near real time if an engine is showing worrisome readings.</span></span>

## <a name="what-is-azure-event-hubs"></a><span data-ttu-id="672c0-110">Azure Event Hubs とは</span><span class="sxs-lookup"><span data-stu-id="672c0-110">What is Azure Event Hubs</span></span>

<span data-ttu-id="672c0-111">Azure Event Hubs は、発行/サブスクライブ通信パターンの仲介役ですが、Event Grid とは異なり、非常に高いスループット、多数の発行元、セキュリティ、および回復性に対して最適化されています。</span><span class="sxs-lookup"><span data-stu-id="672c0-111">Azure Event Hub is an intermediary for the publish-subscribe communication pattern, but unlike Event Grid it is optimized for extremely high throughput, a large number of publishers, security, and resiliency.</span></span>

<span data-ttu-id="672c0-112">Event Grid は、サブスクリプションを単純に管理し、これらのサブスクライバーに通信をルーティングする点で、発行/サブスクライブ通信パターンとほぼ完全に合致します。これに対して Event Hubs は、かなり多くの追加サービスを実行するので、ある意味、単純なイベント ブロードキャスターよりもサービス バスやメッセージ キューに似ています。</span><span class="sxs-lookup"><span data-stu-id="672c0-112">Whereas Event Grid fits more or less perfectly into the publish-subscribe pattern in that it simply manages subscriptions and routes communications to those subscribers, Event Hub performs quite a few additional services that in some ways make it resemble a service bus or message queue more than a simple event broadcaster.</span></span>

#### <a name="partitions"></a><span data-ttu-id="672c0-113">パーティション</span><span class="sxs-lookup"><span data-stu-id="672c0-113">Partitions</span></span> ####
<span data-ttu-id="672c0-114">イベント ハブは通信を受信すると、その通信をパーティションに分割します。</span><span class="sxs-lookup"><span data-stu-id="672c0-114">As Event Hub receives communications it divides them into partitions.</span></span> <span data-ttu-id="672c0-115">パーティションは、通信が保存されるバッファーです。</span><span class="sxs-lookup"><span data-stu-id="672c0-115">Partitions are buffers into which the communications are saved.</span></span> <span data-ttu-id="672c0-116">イベント バッファーのため、イベントは完全に一時的なものではなく、サブスクライバーがビジー状態またはオフラインであってもイベントが見落とされることはありません。</span><span class="sxs-lookup"><span data-stu-id="672c0-116">Because of the event buffers, events are not completely ephemeral and an event isn't missed just because a subscriber is busy or even offline.</span></span> <span data-ttu-id="672c0-117">サブスクライバーは、常にバッファーを使用して "キャッチアップ" することができます。</span><span class="sxs-lookup"><span data-stu-id="672c0-117">The subscriber can always use the buffer to "catch up".</span></span> <span data-ttu-id="672c0-118">既定では、イベントはバッファー内に 24 時間留まった後、自動的に期限切れとなります。</span><span class="sxs-lookup"><span data-stu-id="672c0-118">By default events stay in the buffer for 24 hours then automatically expire.</span></span>

<span data-ttu-id="672c0-119">バッファーは、それらの間でデータが分割されるため、パーティションと呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="672c0-119">The buffers are called partitions because the data is divided amongst them.</span></span> <span data-ttu-id="672c0-120">すべてのイベント ハブには少なくとも 2 つのパーティションが含まれ、各パーティションにはサブスクライバーの別個のセットが含まれます。</span><span class="sxs-lookup"><span data-stu-id="672c0-120">Every Event Hub has at least two partitions, and each partition has a separate set of subscribers.</span></span>

#### <a name="capture"></a><span data-ttu-id="672c0-121">キャプチャ</span><span class="sxs-lookup"><span data-stu-id="672c0-121">Capture</span></span> ####
<span data-ttu-id="672c0-122">イベント ハブは、Azure Data Lake または BLOB ストレージにすべてのイベントを瞬時に送信して、永続性を低コストで実現することができます。</span><span class="sxs-lookup"><span data-stu-id="672c0-122">Event Hub can send all your events immediately to Azure Data Lake or Blob Storage for inexpensive permanent persistence.</span></span>

#### <a name="authentication"></a><span data-ttu-id="672c0-123">Authentication</span><span class="sxs-lookup"><span data-stu-id="672c0-123">Authentication</span></span> ####
<span data-ttu-id="672c0-124">すべての発行元が認証され、トークンが発行されます。</span><span class="sxs-lookup"><span data-stu-id="672c0-124">All publishers are authenticated and issued a token.</span></span> <span data-ttu-id="672c0-125">つまり、イベント ハブは、いたずらにより不正なデータが分析に支障をきたすことを心配せずに、外部デバイスおよびモバイル アプリからのイベントを受け取ることができます。</span><span class="sxs-lookup"><span data-stu-id="672c0-125">This means Event Hub can accept events from external devices and mobile apps without worrying that fraudulent data from pranksters could ruin our analysis.</span></span> 

## <a name="using-azure-event-hub"></a><span data-ttu-id="672c0-126">Azure Event Hubs を使用する</span><span class="sxs-lookup"><span data-stu-id="672c0-126">Using Azure Event Hub</span></span>

<span data-ttu-id="672c0-127">Event Hubs では、イベント ストリームと他の Azure サービスの間のパイプライン設定がサポートされています。</span><span class="sxs-lookup"><span data-stu-id="672c0-127">Event Hubs has support for pipelining event streams to other Azure services.</span></span> <span data-ttu-id="672c0-128">たとえば、Stream Analytics とともに使用すると、複数のイベントを関連付けてパターンを見つける機能により、ほぼリアルタイムでデータの複雑な分析を行うことができます。</span><span class="sxs-lookup"><span data-stu-id="672c0-128">Using it with Stream Analytics for instance allows complex analysis of data in near real time with the ability to correlate multiple events and look for patterns.</span></span> <span data-ttu-id="672c0-129">この場合、Stream Analytics はサブスクライバーと見なされます。</span><span class="sxs-lookup"><span data-stu-id="672c0-129">In this case, Stream Analytics would be considered a subscriber.</span></span>

<span data-ttu-id="672c0-130">ここでは、航空機エンジンに対して、Event Hubs がエンジンからの通信を認証できるようにアーキテクチャを設定します。</span><span class="sxs-lookup"><span data-stu-id="672c0-130">For our aircraft engines, we'll set up our architecture so that Event Hubs will authenticate the communications from our engines.</span></span> <span data-ttu-id="672c0-131">その後、キャプチャを使用してすべてデータを Azure Data Lake に保存するように、アーキテクチャを設定します。これらのデータはすべて、機械学習モデルを保持および向上させるために後で使用できます。</span><span class="sxs-lookup"><span data-stu-id="672c0-131">We will then have it use Capture to save all the data to Azure Data Lake, later we can use all that data to retrain and improve our machine learning models.</span></span> <span data-ttu-id="672c0-132">最後に、Azure Stream Analytics のサブスクライバーによってイベント ストリームが取得されます。</span><span class="sxs-lookup"><span data-stu-id="672c0-132">Finally, our event streams will be picked up by Azure Stream Analytics subscribers.</span></span> <span data-ttu-id="672c0-133">Stream Analytics は、機械学習モデルを使用して、問題を示す可能性のあるセンサー データのパターンを見つけます。</span><span class="sxs-lookup"><span data-stu-id="672c0-133">Stream Analytics will use our machine learning model to look for patterns in the sensor data that might indicate problems.</span></span>

<span data-ttu-id="672c0-134">複数のパーティションがあり、各エンジンはそのすべてのデータを 1 つのパーティションだけに送信するので、Stream Analytics サブスクライバーの各インスタンスは、すべてのデータに対してフィルター処理および関連付けを行う代わりに、データ全体のサブセットを扱うだけで済みます。</span><span class="sxs-lookup"><span data-stu-id="672c0-134">Because we have several partitions, and each engine sends all its data to only one partition each instance of our Stream Analytics subscriber only need deal with a subset of our overall data instead of filtering and correlating over all of it.</span></span>

## <a name="choose-event-grid-or-event-hub"></a><span data-ttu-id="672c0-135">Event Grid または Event Hubs を選択する</span><span class="sxs-lookup"><span data-stu-id="672c0-135">Choose Event Grid or Event Hub</span></span>

<span data-ttu-id="672c0-136">両者とも *At Least Once* セマンティクスをサポートしています。</span><span class="sxs-lookup"><span data-stu-id="672c0-136">Both support *At Least Once* semantics.</span></span>

<span data-ttu-id="672c0-137">信頼された発行元 (たとえば、自身の Web サーバー) との単純なイベント発行/サブスクライブ インフラストラクチャが必要な場合は、Azure Event Grid を選択する必要があります。</span><span class="sxs-lookup"><span data-stu-id="672c0-137">If you need a simple event publish-subscribe infrastructure with trusted publishers (for instance your own web server), you should choose Azure Event Grid.</span></span>

### <a name="consider-event-hub-if"></a><span data-ttu-id="672c0-138">Azure Event Hubs を検討する場合:</span><span class="sxs-lookup"><span data-stu-id="672c0-138">Consider Event Hub if</span></span>
* <span data-ttu-id="672c0-139">多数の発行元の認証をサポートする必要がある</span><span class="sxs-lookup"><span data-stu-id="672c0-139">You need to support authenticating a large number of publishers</span></span>
* <span data-ttu-id="672c0-140">Azure Data Lake または BLOB ストレージにイベントのストリームを保存する必要がある</span><span class="sxs-lookup"><span data-stu-id="672c0-140">You need to save a stream of events to Azure Data Lake or Blob Storage</span></span>
* <span data-ttu-id="672c0-141">イベント ストリームの集計または分析が必要である</span><span class="sxs-lookup"><span data-stu-id="672c0-141">You need aggregation or analytics on your event stream</span></span>
* <span data-ttu-id="672c0-142">信頼できるメッセージングまたは回復性が必要である</span><span class="sxs-lookup"><span data-stu-id="672c0-142">You need reliable messaging or resiliency</span></span> 