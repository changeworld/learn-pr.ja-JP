<span data-ttu-id="aadfd-101">実際のソリューションで Text Analytics に関する私たちの知識が活用するようにしましょう。</span><span class="sxs-lookup"><span data-stu-id="aadfd-101">Let's put our knowledge of Text Analytics to work in a practical solution.</span></span> <span data-ttu-id="aadfd-102">私たちのソリューションは、テキスト ドキュメントの感情分析に着目します。</span><span class="sxs-lookup"><span data-stu-id="aadfd-102">Our solution will focus on Sentiment Analysis of text documents.</span></span> <span data-ttu-id="aadfd-103">取り組みたい問題を記述して、コンテキストを設定しましょう。</span><span class="sxs-lookup"><span data-stu-id="aadfd-103">Let's set the context by describing the problem we want to tackle.</span></span>

## <a name="manage-customer-feedback-more-efficiently"></a><span data-ttu-id="aadfd-104">お客様からのフィードバックをより効率的に管理します。</span><span class="sxs-lookup"><span data-stu-id="aadfd-104">Manage customer feedback more efficiently</span></span>

<span data-ttu-id="aadfd-105">会社の製品の話題にはソーシャル メディアが有効です｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-105">Social media is active with talk of your company's product.</span></span> <span data-ttu-id="aadfd-106">お客様が会社の製品に関する意見を共有したがっている場合は､フィードバック電子メール エイリアスも有効です｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-106">Your feedback email alias is also active with customers eager to share their opinion of your product.</span></span>

<span data-ttu-id="aadfd-107">新規参入者がそうであるように､お客様の声に耳を傾けるというマントラに従っています｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-107">As is the case with any new startup, you live by the mantra of listening to your customers.</span></span> <span data-ttu-id="aadfd-108">しかしながら、会社の製品の成功によって､この約束は言うは易く行うは難しになっています｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-108">However, the success of your product has made keeping this promise easier said than done.</span></span> <span data-ttu-id="aadfd-109">大切な問題ですが､それでも問題です｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-109">It's a good problem but a problem all the same.</span></span>

<span data-ttu-id="aadfd-110">チームはフィードバックの量に対応できなくなっています｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-110">The team can't keep up with the volume of feedback anymore.</span></span> <span data-ttu-id="aadfd-111">できる限り効率的に管理できるよう、フィードバックの仕分けに何らかの助けが必要です｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-111">They need help sorting the feedback so that issues can be managed as efficiently as possible.</span></span> <span data-ttu-id="aadfd-112">組織の開発責任者として、あなたはソリューションを構築するよう依頼されました。</span><span class="sxs-lookup"><span data-stu-id="aadfd-112">As the lead developer in the organization, you have been asked to build a solution.</span></span>

<span data-ttu-id="aadfd-113">いくつかの高次の要件を見ててみましょう。</span><span class="sxs-lookup"><span data-stu-id="aadfd-113">Let's look at some high-level requirements:</span></span>

|<span data-ttu-id="aadfd-114">要件</span><span class="sxs-lookup"><span data-stu-id="aadfd-114">Requirement</span></span>  | <span data-ttu-id="aadfd-115">詳細</span><span class="sxs-lookup"><span data-stu-id="aadfd-115">Details</span></span>  |
|---------|---------|
|<span data-ttu-id="aadfd-116">フィードバックに対応できるよう分類する。</span><span class="sxs-lookup"><span data-stu-id="aadfd-116">Categorize feedback so we can react to it.</span></span>     |   <span data-ttu-id="aadfd-117">すべてのフィードバックが等価値であるわけではありません｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-117">Not all feedback is equal.</span></span> <span data-ttu-id="aadfd-118">生き生きとした証言のこともあれば､</span><span class="sxs-lookup"><span data-stu-id="aadfd-118">Some is glowing testimony.</span></span> <span data-ttu-id="aadfd-119">欲求不満のお客様からの痛烈な批判のことあります｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-119">Other feedback is scathing criticism from a frustrated customer.</span></span> <span data-ttu-id="aadfd-120">お客様が何を望んでいるのか､判断できないケースもあります｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-120">Perhaps you can't tell what the customer wants in other cases.</span></span> <br/><br/><span data-ttu-id="aadfd-121">少なくとも、フィードバックの感情あるいは調子の指標があれば､フィードバックを分類するのに役立ちます｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-121">At a minimum, having an indication of the sentiment, or tone, of feedback would help us categorize it.</span></span>     |
|<span data-ttu-id="aadfd-122">ソリューションは要求に応じてスケールアップしたり､スケールダウンしたりします｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-122">The solution should scale up or down to meet demand.</span></span>    |   <span data-ttu-id="aadfd-123">私たちはスタートアップ企業です。</span><span class="sxs-lookup"><span data-stu-id="aadfd-123">We're a startup.</span></span> <span data-ttu-id="aadfd-124">固定費として計上することは難しく、フィードバック トラフィックのパターンを正確には把握していません。</span><span class="sxs-lookup"><span data-stu-id="aadfd-124">Fixed costs are difficult to justify, and we haven't figured out the exact pattern of feedback traffic.</span></span> <span data-ttu-id="aadfd-125">アクティビティのバーストに対処しつつ、アクティビティが少ない時にはできるかぎりコストを抑えられるソリューションが必要です。</span><span class="sxs-lookup"><span data-stu-id="aadfd-125">We'll need a solution that can tackle bursts of activity, but cost as little as possible during quiet times.</span></span> <br/><br/> <span data-ttu-id="aadfd-126">この場合は､従量課金制のサーバーレス アーキテクチャが選択肢になります｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-126">A serverless architecture billed on a consumption plan is a good candidate in this case.</span></span>     |
| <span data-ttu-id="aadfd-127">MVP (Minimal Viable Product) でありながら、柔軟性に優れたソリューションになります。</span><span class="sxs-lookup"><span data-stu-id="aadfd-127">Produce a Minimal Viable Product (MVP), but make the solution adaptable.</span></span>    | <span data-ttu-id="aadfd-128">現在、私たちは限られたリソースを重要なフィードバックに適用できるよう、フィードバックを分類したいと考えています。</span><span class="sxs-lookup"><span data-stu-id="aadfd-128">Today, we want to categorize feedback so we can apply our limited resources to the feedback that matters.</span></span> <span data-ttu-id="aadfd-129">不満をお持ちのお客様を、すぐに把握し、チャットしたいと考えています。</span><span class="sxs-lookup"><span data-stu-id="aadfd-129">If a customer is frustrated, we want to know immediately and start chatting with them.</span></span> <span data-ttu-id="aadfd-130">将来はこのソリューションを強化して、もっと多くのことをできるようにするつもりです。</span><span class="sxs-lookup"><span data-stu-id="aadfd-130">In the future, we'll enhance this solution to do more.</span></span> <span data-ttu-id="aadfd-131">新機能として､フィードバック内の鍵となる語句を調べて､お客様が限界点に達する前に問題点を発見するというアイデアがあります｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-131">One idea for a new feature is to examine key phrases in feedback to detect pain points before they reach critical mass with our customers.</span></span> <span data-ttu-id="aadfd-132">別のアイデアは、肯定的か中立的なお客様への応答を自動化することです｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-132">Another idea is to automate responses back to customers who are either positive or neutral.</span></span> <span data-ttu-id="aadfd-133">お客様が会社を気に入ってくれているとしても､私たちがお客様のフィードバックに耳を傾けていることを知っておいていただきたいのです｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-133">Even though they love us, we want them to know we are still listening to their feedback.</span></span> <br/><br/><span data-ttu-id="aadfd-134">ここでは､プラグ アンド プレイ式のアーキテクチャを提供するソリューションがピッタリです｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-134">A solution that offers a plug-and-play architecture is a good fit here.</span></span> <span data-ttu-id="aadfd-135">例えば､工場の製造ラインの一形態として､私たちはキュー方式を採用できます｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-135">We could, for example, use queues as a form of factory line.</span></span> <span data-ttu-id="aadfd-136">1 つのタスクを実行したら、キューにその結果を入れることで､システムの次の工程でその結果を受け取って処理できるようにします｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-136">You perform one task, then place the result into a queue for the next part of the system to pick it up and process.</span></span>   |
|<span data-ttu-id="aadfd-137">配送は迅速です｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-137">Deliver quickly.</span></span>     |   <span data-ttu-id="aadfd-138">これは前にも聞いています。</span><span class="sxs-lookup"><span data-stu-id="aadfd-138">We've all heard this one before!</span></span> <span data-ttu-id="aadfd-139">ただし、このソリューションは MVP であることを思い出してください。私たちのシナリオですぐにテストをしたいと思っています。</span><span class="sxs-lookup"><span data-stu-id="aadfd-139">Remember, this solution is an MVP, and we want to test it with our scenario quickly.</span></span> <span data-ttu-id="aadfd-140">高品質のものを迅速に実現するということは、コードを少なくすることを意味します。</span><span class="sxs-lookup"><span data-stu-id="aadfd-140">To deliver at speed and with quality will mean writing less code.</span></span> <br/><br/> <span data-ttu-id="aadfd-141">Text Analytics API を利用するいうことは、感情を検出するための訓練をモデルに施す必要がないことを意味します｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-141">Taking advantage of the Text Analytics API means we don't have to train a model to detect sentiment.</span></span> <span data-ttu-id="aadfd-142">Azure Functions を利用し､キューにバインドすることによって､記述しなければならないコードの量が少なくなることは明らかです｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-142">Using Azure Functions and binding to queues declaratively reduces the amount of code we have to write.</span></span> <span data-ttu-id="aadfd-143">また､サーバーレスであることは、サーバーの管理の心配もいらないことを意味します。</span><span class="sxs-lookup"><span data-stu-id="aadfd-143">A serverless solution also means we don't have to worry about server management.</span></span>   |

<span data-ttu-id="aadfd-144">上記表の各要件に対した私たちが提案するソリューションは、要件をソリューションに対応付ける方法の一端にすぎません。</span><span class="sxs-lookup"><span data-stu-id="aadfd-144">Our proposed solution for each requirement in the preceding table offers a glimpse into how to map requirements to solutions.</span></span> <span data-ttu-id="aadfd-145">Azure に基づくソリューションがどのようになるのか見てみましょう。</span><span class="sxs-lookup"><span data-stu-id="aadfd-145">Let's now see what a solution might look like based on Azure.</span></span>

## <a name="a-solution-based-on-azure-functions-azure-queue-storage-and-text-analytics-api"></a><span data-ttu-id="aadfd-146">Azure Functions、Azure Queue Storage、Text Analytics API に基づくソリューション</span><span class="sxs-lookup"><span data-stu-id="aadfd-146">A solution based on Azure Functions, Azure Queue Storage, and Text Analytics API</span></span>

<span data-ttu-id="aadfd-147">次の図は、ソリューションの設計案です。</span><span class="sxs-lookup"><span data-stu-id="aadfd-147">The following diagram is a design proposal for a solution.</span></span> <span data-ttu-id="aadfd-148">Azure の 3 つのコア コンポーネント、Azure Queue Storage と Azure Functions、Azure Cognitive Services を利用しています。</span><span class="sxs-lookup"><span data-stu-id="aadfd-148">It uses three core components of Azure: Azure Queue Storage, Azure Functions, and Azure Cognitive Services.</span></span>

![フィードバックの分類アーキテクチャの概念図。](../media/proposed-solution.PNG)

<span data-ttu-id="aadfd-150">考え方としては、ユーザーからのフィードバックを含むテキスト ドキュメントがキューに送られます。このキューは、前の図で *new-feedback-q* と名付けました。</span><span class="sxs-lookup"><span data-stu-id="aadfd-150">The idea is that text documents containing user feedback are placed into a queue that we've named *new-feedback-q* in the preceding diagram.</span></span> <span data-ttu-id="aadfd-151">キューにテキスト ドキュメントを含むメッセージが到着すると、関数の実行がトリガーされるか開始されます。</span><span class="sxs-lookup"><span data-stu-id="aadfd-151">The arrival of a message containing the text document into the queue will trigger, or start, function execution.</span></span> <span data-ttu-id="aadfd-152">この関数は、入力キューから新しいドキュメントを含むメッセージを読み取り、分析のために Text Analytics API に送信します。</span><span class="sxs-lookup"><span data-stu-id="aadfd-152">The function reads messages containing new documents from the input queue and sends them for analysis to the Text Analytics API.</span></span> <span data-ttu-id="aadfd-153">この API が返す結果に基づいて、そのドキュメントを含む新しいメッセージが出力キューに入れられて、さらに処理されます。</span><span class="sxs-lookup"><span data-stu-id="aadfd-153">Based on the results that the API returns, a new message containing the document is placed into an output queue for further processing.</span></span>

<span data-ttu-id="aadfd-154">各ドキュメントで私たちが受け取る結果は、センチメント スコアです。</span><span class="sxs-lookup"><span data-stu-id="aadfd-154">The result we get back for each document is a sentiment score.</span></span> <span data-ttu-id="aadfd-155">各出力キューはフィードバックの格納に使用され、肯定的、中立的、否定的に仕分けされます。</span><span class="sxs-lookup"><span data-stu-id="aadfd-155">The output queues are used to store feedback sorted into positive, neutral, and negative.</span></span> <span data-ttu-id="aadfd-156">望ましいのは、否定的のキューがいつでも空であることです。</span><span class="sxs-lookup"><span data-stu-id="aadfd-156">Hopefully, the negative queue will always be empty!</span></span> <span data-ttu-id="aadfd-157">受信した各フィードバックを、センチメントに基づいて出力キューに入れたとしましょう。各キュー内のメッセージに対して適切な処理をするロジックを追加したいと思うに違いありません。</span><span class="sxs-lookup"><span data-stu-id="aadfd-157">:-) Once we've bucketed each incoming piece of feedback into an output queue based on sentiment, you can imagine adding logic to take action on the messages in each queue.</span></span>

<span data-ttu-id="aadfd-158">隣のフローチャートを見てみましょう。関数のロジックが行う必要があることを確認できます。</span><span class="sxs-lookup"><span data-stu-id="aadfd-158">Let's look at a flowchart next to see what the function logic needs to do.</span></span>

![感情別にテキスト ドキュメントを出力キューに仕分ける Azure 関数の内部ロジックフローチャート。](../media/flow.PNG)

<span data-ttu-id="aadfd-160">このロジックは、ルーターに似ています。</span><span class="sxs-lookup"><span data-stu-id="aadfd-160">Our logic is like a router.</span></span> <span data-ttu-id="aadfd-161">テキスト入力を受け取り、テキストの感情点数に基づいて出力キューにルーティングします。</span><span class="sxs-lookup"><span data-stu-id="aadfd-161">It takes text input and routes it to an output queue based on the sentiment score of the text.</span></span> <span data-ttu-id="aadfd-162">私たちは Text Analytics API に依存しています｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-162">We have a dependency on Text Analytics API.</span></span> <span data-ttu-id="aadfd-163">ロジックは平凡に見えますが､この関数によって、チームのメンバーがフィードバックを手作業で分析する作業が不要になります｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-163">While the logic seems trivial, this function will remove the need for people on the team to analyze feedback manually.</span></span>

## <a name="steps-to-implement-our-solution"></a><span data-ttu-id="aadfd-164">ソリューションの実現手順</span><span class="sxs-lookup"><span data-stu-id="aadfd-164">Steps to implement our solution</span></span>

<span data-ttu-id="aadfd-165">このユニットで説明したソリューションを実現するには､次の手順に従う必要になります。</span><span class="sxs-lookup"><span data-stu-id="aadfd-165">To implement the solution described in this unit, we'll need to complete the following steps.</span></span>

1. <span data-ttu-id="aadfd-166">ソリューションをホストするための関数アプリを作成します。</span><span class="sxs-lookup"><span data-stu-id="aadfd-166">Create a function app to host our solution.</span></span>

1. <span data-ttu-id="aadfd-167">Text Analytics API を使用して､受信するフィードバック メッセージの感情を求めます｡</span><span class="sxs-lookup"><span data-stu-id="aadfd-167">Look for sentiment in incoming feedback messages using the Text Analytics API.</span></span> <span data-ttu-id="aadfd-168">前の課題のアクセス キーを使用して､リクエストを送信するコードを記述します。</span><span class="sxs-lookup"><span data-stu-id="aadfd-168">We'll use our access key from the preceding exercise and write some code to send the requests.</span></span>

1. <span data-ttu-id="aadfd-169">センチメントに基づく処理キューにフィードバックを移します。</span><span class="sxs-lookup"><span data-stu-id="aadfd-169">Post feedback to processing queues based on sentiment.</span></span>

<span data-ttu-id="aadfd-170">関数アプリの作成に進みましょう。</span><span class="sxs-lookup"><span data-stu-id="aadfd-170">Let's move on to creating our function app.</span></span>