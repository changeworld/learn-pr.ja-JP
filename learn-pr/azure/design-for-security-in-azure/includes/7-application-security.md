クラウド プラットフォーム上でアプリケーションをホストすることで、従来のオンプレミス デプロイと比べて、多くの利点が得られます。 クラウドの共有が責任を負うモデルでは、物理ネットワーク、構築、およびクラウド プロバイダーの管理下にあるホスト レベルでセキュリティを移動します。 このレベルでプラットフォームを侵害しようとする攻撃者は、収穫逓減と、プロバイダーによるインフラストラクチャの保護と監視に関する多額の投資と分析情報を比較します。

したがって、クラウド プラットフォームのお客様が発生させたアプリケーション レベルでの脆弱性を追求する攻撃者にとってははるかに効率的です。 さらに、アプリケーションをホストするサービスとしてのプラットフォーム (PaaS) を導入することで、お客様はオペレーティング システム セキュリティの管理からリソースを解放し、リソースをデプロイしてアプリケーション コードを強化し、アプリケーションの周囲の ID 境界を監視できます。 このユニットでは、設計によりアプリケーション セキュリティを強化できる方法をいくつか説明します。

## <a name="scenario"></a>シナリオ

Lamna Healthcare のお客様は、オンライン Web ポータルから個人の医療記録にアクセスする必要があります。 正常性の保険の携行性と責任に関する法律 (HIPAA) への準拠は必須であり、個人データのセキュリティ侵害が発生した場合に、罰金の重大な危険にさらさにより、企業そのため、アプリケーションとやり取りする個人データをセキュリティで保護することは非常に重要です。

お客様のアプリケーションに関連する主な領域は次のとおりです。

- セキュリティで保護されたアプリケーションの設計
- データのセキュリティ
- ID 管理とアクセス管理
- エンドポイントのセキュリティ

## <a name="security-development-lifecycle"></a>セキュリティ開発ライフサイクル

Microsoft の[セキュリティ開発ライフサイクル](https://www.microsoft.com/sdl) (SDL) プロセスをアプリケーションの設計段階で使用することで、確実にソフトウェア開発ライフサイクルにセキュリティに関する懸念事項を組み込むことができます。 セキュリティとコンプライアンスの問題は、アプリケーションの設計時に対処するほうがはるかに簡単であり、最終製品のセキュリティの欠陥につながる可能性のある多くの一般的なエラーを減らすことができます。 ソフトウェア開発の早い段階で問題を解決することで、コストははるかに低くなります。 ソフトウェア プロジェクトで使用できる SDL の一般的な一連の手順は次のとおりです。

1. トレーニング

    - コア セキュリティのトレーニング

1. 要件

    - 要件と品質ゲートを定義する
    - セキュリティとプライバシーのリスクを分析します。
 
1. 設計

    - 攻撃対象領域の分析
    - 脅威のモデル化
 
1. 実装

    - コードの品質を測定できることを確認するためのツールを指定する
    - 禁止されている Api と関数を適用します。
    - 静的コード分析を実行します。
    - リポジトリをスキャンして格納されたシークレットを調べる
 
1. 検証

    - 動的/ファジー テスト
    - 脅威モデル/攻撃対象領域を検証する
 
1. 解放

    - セキュリティ対応計画を立てる
    - 最終的なセキュリティ レビューを行う
    - アーカイブの解放
 
1. 対応 

    - 脅威に対応する

![セキュリティ開発ライフサイクル](../media/sdl.png)

SDL は、ツールのセットやプロセスであると同時に文化的側面でもあります。 セキュリティに重点を置きましたあり、アプリケーション開発の要件と組織のセキュリティ機能の進化における進歩、カルチャを構築します。

<!-- Bear in mind that the migration of un-modified applications (especially COTS procured software systems) will not be able to perform many of the steps listed above.
 -->

## <a name="operational-security-assessment"></a>運用上のセキュリティの評価

アプリケーションがデプロイされているとは、継続的に、セキュリティに対する姿勢を評価、検出、およびソフトウェアの開発サイクルにナレッジをフィードのある問題を軽減する方法を決定するために不可欠です。 これが実行される深さは、データのプライバシー要件と、ソフトウェア開発および運用チームの成熟度レベルの要因となります。

セキュリティの脆弱性をスキャンするソフトウェア サービスは、このプロセスを自動化し、侵入テストなど、コストのかかる手動プロセスでチームに負担をかけることなく、一定のリズムでセキュリティに関する懸念事項を評価するのに役立ちます。

Azure Security Center は無料のサービスであり、すべての Azure サブスクリプションに対して既定で有効になるようになりました。Azure Application Gateway や Azure Web アプリケーション ファイアウォールなどの他の Azure アプリケーション レベルのサービスと緊密に統合されています。 これらのサービスからのログを分析することでは ASC がリアルタイムでの既知の脆弱性をレポートできますをそれらを軽減するために応答をお勧めします、でも、攻撃への応答でプレイブックを自動的に実行するように構成します。

<!-- SDL culture
Key Vault / MSI
CSE = App  -> DB & App Storage
Mention approach of code scanning & SDL
Scanning for passwords - Git
 -->

## <a name="identity-as-the-perimeter"></a>境界としての ID

ID 検証は、アプリケーションに関する防御の最前線になりつつあります。 セッションを認証して承認し、Web アプリケーションへのアクセスを制限することで、攻撃対象領域を大幅に減らすことができます。 Azure AD と Azure AD B2C では、ID の責任を軽減し、フル マネージドのサービスにアクセスする効果的な方法が提供されます。 Azure AD 条件付きアクセス ポリシー、privileged identity management、および Identity Protection のコントロールをさらに、未承認のアクセスを防止し、変更を監査する顧客の機能を強化します。

## <a name="data-protection"></a>データ保護

顧客データは、Web アプリケーションに対するほぼすべての攻撃の対象となります。 アプリケーションとそのデータ ストレージ層の間のデータの保管と転送をセキュリティで保護することが重要です。

Lamna Healthcare では、特に機密性の高い患者の医療記録データを格納し、このデータにアクセスしています。 特に、1996 年に米国議会で制定された HIPAA では、医療機関や雇用主による電子医療記録のトランザクションに関する国家規格が定義されています。 Lamna は、患者となど、医師にとっては、承認されたパーティの医療データに安全にアクセスがあることを確認する必要があります。

これらの要件の遵守、Lamna 医療機関が保存時と転送中のすべての患者データを暗号化するためにアプリケーションを変更します。 たとえば、Web アプリケーションとバックエンドの SQL データベースの間で交換されるデータを暗号化するためにトランスポート層セキュリティ (TLS) が使用されます。 データは、SQL Server の Transparent Data Encryption (TDE) を使用して、環境が侵害された場合でもデータが、適切な復号化キーを持たないすべてのユーザーを効果的に役に立たないことを確認の残りの部分でも暗号化されます。

Blob ストレージに格納されたデータを暗号化するには、ストレージ サービスに書き込まれる前に、メモリ内のデータを暗号化するクライアント側の暗号化を使用できます。 この暗号化がサポートされているライブラリを .NET、Java、および Python で利用でき、データの暗号化をアプリケーションに直接統合してデータの整合性を高めることができます。

### <a name="secure-key-and-secret-storage"></a>キーとシークレットのストレージをセキュリティで保護する

アプリケーション シークレット (接続文字列やパスワードなど) と暗号化キーを、データにアクセスするために使用するアプリケーションから分離させることが重要です。 暗号化キーとアプリケーション シークレットを構成ファイルのアプリケーション コードに格納しないでください。 代わりに、Azure Key Vault などの安全なストアを使用してください。 この機密データへのアクセスがサービス Id の管理をアプリケーション id に制限できますしとを定期的に暗号化キーの漏えいの場合の公開を制限するキーを回転することができます。 顧客にもオンプレミス ハードウェア セキュリティ モジュール (HSM) によって生成された独自の暗号化キーを使用して、必須で、シングル テナントとして Azure Key Vault インスタンスを実装することもできます不連続 Hsm します。

<!-- ### Secure and immutable file storage

All Azure storage accounts are encrypted by default using Microsoft managed keys. Azure customers also have the ability to use their own encryption keys (BYOK) to encrypt blob, file and queue data so that even the hosting provider has no access to unencrypted data. Data immutability is often required for auditing purposes or when legal disputes call for data to be effectively frozen for a determined amount of time. Azure has recently introduced an [immutable data storage](https://docs.microsoft.com/azure/storage/blobs/storage-blob-immutable-storage) option known as Write-Once, Read many (WORM) for this scenario. -->
