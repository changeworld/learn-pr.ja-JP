ネットワーク境界とそのファイアウォール、および物理アクセス制御は、企業データの基本的保護手段でした。 しかし、Bring Your Own Devices (BYOD)、モバイル アプリ、クラウド アプリケーションの急激な増加に伴い、ネットワーク境界はますます穴だらけになっています。 

そこで、ID が新しい基本的セキュリティ境界になりました。 適切な認証と特権の割り当ては、データの管理を保持するうえで非常に重要です。

Contoso では、これらの問題にすぐに対応しています。 同社の新しいハイブリッド クラウド ソリューションでは、認証されたユーザーがサインインしたときにシークレット データにアクセスできるモバイル アプリを考慮する必要があります。 さらに、同社では、ビジネスを最適化するのに不可欠なテレメトリ データのストリームを持続的に送信する手段も有しています。

## <a name="single-sign-on"></a>シングル サインオン

ユーザーが管理する必要がある ID が多くなればなるほど、資格情報に関するセキュリティ インシデントのリスクが高まります。 ID が多くなると、覚えておく必要があり、また変更する必要があるパスワードが増えることになります。 パスワード ポリシーはアプリケーションによって異なる場合があり、複雑さの要件が増えるほど、ユーザーはパスワードを覚えておくことがより困難になります。

その一方で、それらすべての ID を管理する必要があります。 ヘルプ デスクにはさらに負担がかかります。アカウントのロックアウトやパスワードのリセット要求に対応する必要があるためです。 ユーザーが退職した場合、その ID をすべて追跡し、無効になっていることを確認することが困難である可能性があります。 ID を見落とした場合、除外しておくべきアクセスが許可される可能性があります。

シングル サインオンの場合、ユーザーは 1 つの ID と 1 つのパスワードを覚えておくだけで済みます。 アプリケーション間でのアクセスはユーザーに関連付けられている単一の ID に許可され、セキュリティ モデルが簡素化されます。 ユーザーがロールを変更したか、退職したときに、アクセス変更が単一の ID に関連付けられ、アカウントを変更したり、無効にするために必要な労力が大幅に減少します。 アカウントにシングル サインオンを利用することで、ユーザーは自分の ID を管理しやすくなり、ご利用の環境内でのセキュリティ機能が強化されます。

### <a name="sso-with-azure-active-directory"></a>Azure Active Directory での SSO

Azure Active Directory (AD) はクラウド ベースの ID サービスです。 既存のオンプレミスの Active Directory と同期するためのサポートが組み込まれています。スタンドアロンとして使用することもできます。

つまり、アプリケーションがオンプレミスであるか、クラウド (Office 365 を含む) にあるか、さらにはモバイルであるかに関係なく、すべてのアプリケーションで同じ資格情報を共有することができます。 

管理者と開発者は、Azure AD で構成され、一元管理されたルールとポリシーを使用して、データやアプリケーションへのアクセスを制御できます。

さらに、Microsoft では独自に複数のデータ ソースをインテリジェント セキュリティ グラフにまとめているため、Azure Active Directory のすべてのアカウント (お使いのオンプレミス AD から同期されているアカウントであっても) に対する脅威分析とリアルタイムの ID 保護を提供できます。

Contoso は既存の Active Directory と Azure AD を統合しているため、組織全体でアクセスを一貫して制御できます。 また、ユーザーは、再認証することなく、メールと Office 365 ドキュメントに簡単にアクセスできます。

## <a name="multi-factor-authentication"></a>多要素認証

多要素認証 (MFA) では、完全な認証のために 2 つ以上の要素を必須とすることで、ID のセキュリティが強化されます。 これらの要素は、次の 3 つのカテゴリに分類されます。

- *ユーザーが知っているもの*
- *ユーザーが持っているもの*
- *ユーザー自身*

**ユーザーが知っているもの**は、パスワード、あるいはセキュリティの質問に対する答えです。 **ユーザーが持っているもの**は、通知を受け取るモバイル アプリまたはトークンを生成するデバイスです。 **ユーザー自身**は通常、多くのモバイル デバイスで使用される指紋や顔スキャンなどの、ある種の生体認証です。

多要素認証を使用して、資格情報の露出の影響を限定することで、ID のセキュリティが強化されます。 ユーザーのパスワードを持つ攻撃者も、完全に認証するためには自分の電話や顔が必要になります。 確認された単一要素のみの認証では十分ではなく、攻撃者は資格情報を使用して認証できなくなります。 セキュリティにもたらされるこの利点は大きく、可能な限り、MFA を有効にするために十分に繰り返すことはできません。

Azure AD には MFA 機能が組み込まれており、他のサード パーティの MFA プロバイダーと統合されます。 これらは機密性の高いアカウントであるため、Azure AD の全体管理者ロールを持つすべてのユーザーに無料で提供されます。 その他のすべてのアカウントでは MFA を有効にすることができます。その場合、この機能を持つライセンスを購入し、ライセンスをアカウントに割り当てます。

Contoso Shipping では、ドメインに接続されていないコンピューターからユーザーがサインインしているときはいつでも MFA を有効にすることにします。 それにはモバイル アプリも含まれます。

## <a name="providing-identities-to-services"></a>サービスへの ID の提供

サービスに ID があると役立つことが多々あります。 ベスト プラクティスには反しますが、資格情報はしばしば構成ファイルに埋め込まれています。 これらの構成ファイルはセキュリティで保護されていないので、システムやリポジトリにアクセスできるすべてのユーザーがこれらの資格情報にアクセスし、公開されてしまうリスクがあります。

Azure AD では、サービス プリンシパルとマネージド サービス ID の 2 つの方法でこの問題を解決しています。

### <a name="service-principals"></a>サービス プリンシパル

サービス プリンシパルを理解するには、まず、ID 管理の世界で使用される **ID** と**プリンシパル**という用語を理解する必要があります。

**ID** とは、単に認証できるものです。 これには、当然ユーザー名とパスワードを持つユーザーが含まれますが、シークレット キーや証明書で認証される場合のあるアプリケーションやその他のサーバーも含まれます。 ついでながら、**アカウント**とは、ID と関連付けられているデータのことです。

**プリンシパル**とは、特定のロールや要求と動作する ID です。 多くの場合、ID とプリンシパルを別に考えるのは便利ではありませんが、bash プロンプトで "sudo" を使用する場合や、"管理者として実行" を Windows で使用する場合を考えてみてください。 その場合はいずれも、ユーザーは前と同じ ID でログインしていますが、実行しているロールが変更されています。 権限を割り当てることができるため、多くの場合、グループもプリンシパルと見なされます。

したがって、**サービス プリンシパル**は、文字どおり命名されます。 これは、サービスまたはアプリケーションが使用する ID です。 他の ID 同様、ロールを割り当てることもできます。 

### <a name="managed-service-identities"></a>マネージド サービス ID

サービス プリンシパルを作成するプロセスは退屈であり、それらの維持を困難にする可能性がある接点が多数あります。 Manage Service Identities (MSI) ははるかに簡単であり、作業のほとんどがユーザーに代わって実行されます。 

MSI は、MSI をサポートするすべての Azure サービス (そのようなサービスは増え続けています) で即座に作成することができます。 ユーザーがサービス用に MSI を作成する場合、アカウントは Azure Active Directory テナントに作成することになります。 Azure インフラストラクチャは、サービスの認証とアカウントの管理を自動で行ってくれます。 そのアカウントは、他のすべての AD アカウントと同様に使用できます。これには、認証されているサービスが安全にその他の Azure リソースにアクセスできるようにすることも含まれます。

## <a name="role-based-access-control"></a>ロールベースのアクセス制御

ロールとは、"読み取り専用" や "共同作成者" などのアクセス許可のセットです。これは Azure のサービス インスタンスにアクセスするためにユーザーに付与されます。 

ID は、ロールに直接マップするか、グループ メンバーシップを介してマップします。 セキュリティ プリンシパル、アクセス許可、およびリソースを分離すると、アクセスの管理が単純になり、きめ細やかな制御を行うことができるようになります。 管理者は、必要最小限のアクセス許可が付与されていることを確認できます。

ロールは、サービス インスタンス レベルで個々に付与することもできますが、Azure Resource Manager の階層で下位にも伝送されます。 サブスクリプション全体など、より高いスコープに割り当てられているロールは、サービス インスタンスなどの子スコープへ継承されます。 

<!--TODO: replace with final media which was submitted for Design-for-security-in-azure -->
![管理グループ](../media-draft/3-role-assignment-scope.png)

### <a name="privileged-identity-management"></a>Privileged Identity Management

インフラストラクチャを包括的に管理する場合、Azure のリソースへのアクセスを RBAC を使用して管理することに加え、組織の変化や発展に伴い、ロールのメンバーを継続的に監査することも行われる必要があります。 追加の有料のオファリングに、Azure AD Privileged Identity Management (PIM) があります。これを使用して、ロールの割り当て、セルフサービスやジャストインタイムでのロールのアクティブ化、および Azure AD と Azure のリソースへのアクセス確認を監視できます。

<!--TODO: replace with final media which was submitted for Design-for-security-in-azure -->
![Privileged identity management](../media-COPIED-FROM-DESIGNFORSECURITY/PIM_Dashboard.PNG)

ID により、ユーザーの物理的コントロール外でもセキュリティ境界を維持することができます。 SSO と適切なロールベースのアクセス構成を使用することで、データとインフラストラクチャを表示および操作できるユーザーを常に把握することができます。