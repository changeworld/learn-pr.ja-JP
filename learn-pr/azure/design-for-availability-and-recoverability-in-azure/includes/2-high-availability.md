<span data-ttu-id="37710-101">高可用性 (HA) により、アーキテクチャによって障害に確実に対処することができます。</span><span class="sxs-lookup"><span data-stu-id="37710-101">High availability (HA) ensures your architecture can handle failures.</span></span> <span data-ttu-id="37710-102">常に完全な動作状態になければならないシステムを担当しているとします。</span><span class="sxs-lookup"><span data-stu-id="37710-102">Imagine you're responsible for a system that must be always fully operational.</span></span> <span data-ttu-id="37710-103">障害はいつか発生する可能性があります。したがって、何か問題が発生しても、システムが確実にオンライン状態に維持されるようにするにはどうすればよいでしょうか。</span><span class="sxs-lookup"><span data-stu-id="37710-103">Failures can and will happen, so how do you ensure that your system can remain online when something goes wrong?</span></span> <span data-ttu-id="37710-104">サービスを中断せずにメンテナンスを実行するにはどうすればよいでしょうか。</span><span class="sxs-lookup"><span data-stu-id="37710-104">How do you perform maintenance without service interruption?</span></span> 

<span data-ttu-id="37710-105">ここでは、高可用性の必要性を学習し、アプリケーションの高可用性の要件を評価し、可用性の目標を達成するために Azure プラットフォームがどのように役立つかを確認します。</span><span class="sxs-lookup"><span data-stu-id="37710-105">Here, you'll learn the need for high availability, evaluate application high-availability requirements, and see how the Azure platform helps you meet your availability goals.</span></span>

## <a name="what-is-high-availability"></a><span data-ttu-id="37710-106">高可用性とは</span><span class="sxs-lookup"><span data-stu-id="37710-106">What is high availability?</span></span>

> [!VIDEO https://www.microsoft.com/videoplayer/embed/RE2yEvc]

<span data-ttu-id="37710-107">高可用性サービスは、依存型のサービスおよびハードウェアでの可用性および負荷の変動と、一時的な障害を緩和するサービスです。</span><span class="sxs-lookup"><span data-stu-id="37710-107">A highly-available service is a service that absorbs fluctuations in availability, load, and temporary failures in dependent services and hardware.</span></span> <span data-ttu-id="37710-108">アプリケーションは良好なパフォーマンスで動作しながら、オンラインのまま利用可能な状態 (またはその外観) が維持されます。</span><span class="sxs-lookup"><span data-stu-id="37710-108">The application remains online and available (or maintains the appearance of it) while performing acceptably.</span></span> <span data-ttu-id="37710-109">この可用性は、多くの場合、ビジネス要件、サービス レベル目標、またはサービス レベル アグリーメントによって定義されます。</span><span class="sxs-lookup"><span data-stu-id="37710-109">This availability is often defined by business requirements, service-level objectives, or service-level agreements.</span></span>

<span data-ttu-id="37710-110">高可用性は、最終的には、システムのコンポーネントの損失または大幅なパフォーマンス低下に対処する機能に関するものです。</span><span class="sxs-lookup"><span data-stu-id="37710-110">High availability is ultimately about the ability to handle the loss or severe degradation of a component of a system.</span></span> <span data-ttu-id="37710-111">このような状況になる原因としては、ホストで障害が発生したためにアプリケーションをホストしている仮想マシンがオフラインになることが考えられます。</span><span class="sxs-lookup"><span data-stu-id="37710-111">This might be due to a virtual machine that's hosting an application going offline because the host failed.</span></span> <span data-ttu-id="37710-112">システム アップグレードのための計画メンテナンスが原因となる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="37710-112">It could be due to planned maintenance for a system upgrade.</span></span> <span data-ttu-id="37710-113">クラウド内でのサービスの障害によって発生する場合もあります。</span><span class="sxs-lookup"><span data-stu-id="37710-113">It could even be caused by the failure of a service in the cloud.</span></span> <span data-ttu-id="37710-114">システムで障害が発生していると考えられる場所を特定し、それらの障害に対処する機能を組み込むことで、顧客に提供しているサービスが確実にオンラインに維持されるようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="37710-114">Identifying the places where your system can fail, and building in the capabilities to handle those failures, will ensure that the services you offer to your customers can stay online.</span></span>

<span data-ttu-id="37710-115">通常、サービスの高可用性を実現するには、サービスを構成するコンポーネントの高可用性が必要です。</span><span class="sxs-lookup"><span data-stu-id="37710-115">High availability of a service typically requires high availability of the components that make up the service.</span></span> <span data-ttu-id="37710-116">アイテムを購入するためのオンライン マーケットプレースを提供する Web サイトについて考えてみましょう。</span><span class="sxs-lookup"><span data-stu-id="37710-116">Think of a website that offers an online marketplace to purchase items.</span></span> <span data-ttu-id="37710-117">顧客に提供しているサービスには、アイテムをオンラインで一覧表示、購入、および販売する機能が用意されています。</span><span class="sxs-lookup"><span data-stu-id="37710-117">The service that's offered to your customers is the ability to list, buy, and sell items online.</span></span> <span data-ttu-id="37710-118">このサービスを提供するために、データベース、Web サーバー、アプリケーション サーバーなど複数のコンポーネントを備えることになります。</span><span class="sxs-lookup"><span data-stu-id="37710-118">To provide this service, you'll have multiple components: a database, web servers, application servers, and so on.</span></span> <span data-ttu-id="37710-119">このような各コンポーネントでは障害が発生する可能性があるため、障害点がどこにどのように存在するかを識別し、アーキテクチャ内でそれらの障害点に対処する方法を決める必要があります。</span><span class="sxs-lookup"><span data-stu-id="37710-119">Each of these components could fail, so you have to identify how and where  your failure points are, and determine how to address these failure points in your architecture.</span></span>

## <a name="evaluate-high-availability-for-your-architecture"></a><span data-ttu-id="37710-120">自分のアーキテクチャの高可用性を評価する</span><span class="sxs-lookup"><span data-stu-id="37710-120">Evaluate high availability for your architecture</span></span>

<span data-ttu-id="37710-121">アプリケーションの高可用性を評価するには 3 つの手順があります。</span><span class="sxs-lookup"><span data-stu-id="37710-121">There are three steps to evaluate an application for high availability:</span></span>

1. <span data-ttu-id="37710-122">ご利用のアプリケーションのサービス レベル アグリーメントを特定する</span><span class="sxs-lookup"><span data-stu-id="37710-122">Determine the service-level agreement of your application</span></span>
1. <span data-ttu-id="37710-123">アプリケーションの HA 機能を評価する</span><span class="sxs-lookup"><span data-stu-id="37710-123">Evaluate the HA capabilities of the application</span></span>
1. <span data-ttu-id="37710-124">依存するアプリケーションの HA 機能を評価する</span><span class="sxs-lookup"><span data-stu-id="37710-124">Evaluate the HA capabilities of dependent applications</span></span>

<span data-ttu-id="37710-125">これらの手順を詳しく見ていきましょう。</span><span class="sxs-lookup"><span data-stu-id="37710-125">Let's explore these steps in detail.</span></span>

### <a name="determine-the-service-level-agreement-of-your-application"></a><span data-ttu-id="37710-126">ご利用のアプリケーションのサービス レベル アグリーメントを特定する</span><span class="sxs-lookup"><span data-stu-id="37710-126">Determine the service-level agreement of your application</span></span>

<span data-ttu-id="37710-127">サービス レベル アグリーメント (SLA) は、サービス プロバイダーとサービス コンシューマーとの間で結ばれる契約であり、その中でサービス プロバイダーは、測定可能なメトリックと定義された責任に基づいてサービスの標準をコミットします。</span><span class="sxs-lookup"><span data-stu-id="37710-127">A service-level agreement (SLA) is an agreement between a service provider and a service consumer in which the service provider commits to a standard of service based on measurable metrics and defined responsibilities.</span></span> <span data-ttu-id="37710-128">SLA は、法律に従った厳密な契約上の合意であり、顧客による可用性の期待とみなすことができます。</span><span class="sxs-lookup"><span data-stu-id="37710-128">SLAs can be strict, legally bound, contractual agreements, or assumed expectations of availability by customers.</span></span> <span data-ttu-id="37710-129">サービスのメトリックでは、通常、サービスのスループット、容量、および可用性に重点が置かれ、そのすべてをさまざまな方法で測定することができます。</span><span class="sxs-lookup"><span data-stu-id="37710-129">Service metrics typically focus on service throughput, capacity, and availability, all of which can be measured in various ways.</span></span> <span data-ttu-id="37710-130">SLA を構成する特定のメトリックに関係なく、SLA を達成する過程で発生する障害は、サービス プロバイダーに対して財務的に深刻な影響を与えます。</span><span class="sxs-lookup"><span data-stu-id="37710-130">Regardless of the specific metrics that make up the SLA, failure to meet the SLA can have serious financial ramifications for the service provider.</span></span> <span data-ttu-id="37710-131">サービス契約の一般的なコンポーネントでは、SLA が達成されなかった場合、財務的な払戻しが保証されます。</span><span class="sxs-lookup"><span data-stu-id="37710-131">A common component of service agreements is guaranteed financial reimbursement for missed SLAs.</span></span>

<span data-ttu-id="37710-132">サービス レベル目標 (SLO) は、パフォーマンス、信頼性、または可用性の測定に使用されるターゲット メトリックの値です。</span><span class="sxs-lookup"><span data-stu-id="37710-132">Service-level objectives (SLO) are the values of target metrics that are used to measure performance, reliability, or availability.</span></span> <span data-ttu-id="37710-133">これらは、要求処理のパフォーマンス (ミリ秒)、1 月あたりのサービスの可用性 (分)、または処理された 1 時間あたりの要求の数を定義するメトリックの場合もあります。</span><span class="sxs-lookup"><span data-stu-id="37710-133">These could be metrics defining the performance of request processing in milliseconds, the availability of services in minutes per month, or the number of requests processed per hour.</span></span> <span data-ttu-id="37710-134">アプリケーションによって公開されたメトリックを評価し、顧客が品質の指標として使用しているものを理解することで、これらの SLO の許容できる範囲と許容できない範囲を定義できます。</span><span class="sxs-lookup"><span data-stu-id="37710-134">By evaluating the metrics exposed by your application and understanding what customers use as a measure of quality, you can define the acceptable and unacceptable ranges for these SLOs.</span></span> <span data-ttu-id="37710-135">これらの目標を定義することで、サービスをサポートするチームと、これらのサービスを利用する顧客の両方に対して、目標と期待を明確に設定します。</span><span class="sxs-lookup"><span data-stu-id="37710-135">By defining these objectives, you clearly set goals and expectations with both the teams supporting the services and customers who are consuming these services.</span></span> <span data-ttu-id="37710-136">これらの SLO は、SLA 全体が満たされているかどうかを判断するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="37710-136">These SLOs will be used to determine if your overall SLA is being met.</span></span>

<span data-ttu-id="37710-137">次の表は、さまざまな SLA レベルで考えられる累積的なダウンタイムの一覧です。</span><span class="sxs-lookup"><span data-stu-id="37710-137">The following table shows the potential cumulative downtime for various SLA levels.</span></span> 

| <span data-ttu-id="37710-138">SLA</span><span class="sxs-lookup"><span data-stu-id="37710-138">SLA</span></span> | <span data-ttu-id="37710-139">週あたりのダウンタイム</span><span class="sxs-lookup"><span data-stu-id="37710-139">Downtime per week</span></span> | <span data-ttu-id="37710-140">月あたりのダウンタイム</span><span class="sxs-lookup"><span data-stu-id="37710-140">Downtime per month</span></span> | <span data-ttu-id="37710-141">年あたりのダウンタイム</span><span class="sxs-lookup"><span data-stu-id="37710-141">Downtime per year</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="37710-142">99%</span><span class="sxs-lookup"><span data-stu-id="37710-142">99%</span></span> |<span data-ttu-id="37710-143">1.68 時間</span><span class="sxs-lookup"><span data-stu-id="37710-143">1.68 hours</span></span> |<span data-ttu-id="37710-144">7.2 時間</span><span class="sxs-lookup"><span data-stu-id="37710-144">7.2 hours</span></span> |<span data-ttu-id="37710-145">3.65 日</span><span class="sxs-lookup"><span data-stu-id="37710-145">3.65 days</span></span> |
| <span data-ttu-id="37710-146">99.9%</span><span class="sxs-lookup"><span data-stu-id="37710-146">99.9%</span></span> |<span data-ttu-id="37710-147">10.1 分</span><span class="sxs-lookup"><span data-stu-id="37710-147">10.1 minutes</span></span> |<span data-ttu-id="37710-148">43.2 分</span><span class="sxs-lookup"><span data-stu-id="37710-148">43.2 minutes</span></span> |<span data-ttu-id="37710-149">8.76 時間</span><span class="sxs-lookup"><span data-stu-id="37710-149">8.76 hours</span></span> |
| <span data-ttu-id="37710-150">99.95%</span><span class="sxs-lookup"><span data-stu-id="37710-150">99.95%</span></span> |<span data-ttu-id="37710-151">5 分</span><span class="sxs-lookup"><span data-stu-id="37710-151">5 minutes</span></span> |<span data-ttu-id="37710-152">21.6 分</span><span class="sxs-lookup"><span data-stu-id="37710-152">21.6 minutes</span></span> |<span data-ttu-id="37710-153">4.38 時間</span><span class="sxs-lookup"><span data-stu-id="37710-153">4.38 hours</span></span> |
| <span data-ttu-id="37710-154">99.99%</span><span class="sxs-lookup"><span data-stu-id="37710-154">99.99%</span></span> |<span data-ttu-id="37710-155">1.01 分</span><span class="sxs-lookup"><span data-stu-id="37710-155">1.01 minutes</span></span> |<span data-ttu-id="37710-156">4.32 分</span><span class="sxs-lookup"><span data-stu-id="37710-156">4.32 minutes</span></span> |<span data-ttu-id="37710-157">52.56 分</span><span class="sxs-lookup"><span data-stu-id="37710-157">52.56 minutes</span></span> |
| <span data-ttu-id="37710-158">99.999%</span><span class="sxs-lookup"><span data-stu-id="37710-158">99.999%</span></span> |<span data-ttu-id="37710-159">6 秒</span><span class="sxs-lookup"><span data-stu-id="37710-159">6 seconds</span></span> |<span data-ttu-id="37710-160">25.9 秒</span><span class="sxs-lookup"><span data-stu-id="37710-160">25.9 seconds</span></span> |<span data-ttu-id="37710-161">5.26 分</span><span class="sxs-lookup"><span data-stu-id="37710-161">5.26 minutes</span></span> |

<span data-ttu-id="37710-162">当然ながら高可用性が望ましく、他の項目は同じくらいです。</span><span class="sxs-lookup"><span data-stu-id="37710-162">Of course, higher availability is better, everything else being equal.</span></span> <span data-ttu-id="37710-163">ただし、99.99...% の 9 の桁数を増やすにつれて、そのレベルの可用性を実現するためのコストと複雑さは増大します。</span><span class="sxs-lookup"><span data-stu-id="37710-163">But as you strive for more 9s, the cost and complexity to achieve that level of availability grows.</span></span> <span data-ttu-id="37710-164">99.99% のアップタイムは、月あたりの合計ダウンタイムの約 5 分に換算されます。</span><span class="sxs-lookup"><span data-stu-id="37710-164">An uptime of 99.99% translates to about 5 minutes of total downtime per month.</span></span> <span data-ttu-id="37710-165">5 つの 9 (99.999%) を実現するために、複雑さとコストが増大する価値はありますか。</span><span class="sxs-lookup"><span data-stu-id="37710-165">Is it worth the additional complexity and cost to reach five 9s?</span></span> <span data-ttu-id="37710-166">その答えはビジネス要件によって変わります。</span><span class="sxs-lookup"><span data-stu-id="37710-166">The answer depends on the business requirements.</span></span> 

<span data-ttu-id="37710-167">SLA を定義する場合の他の考慮事項を次に示します。</span><span class="sxs-lookup"><span data-stu-id="37710-167">Here are some other considerations when defining an SLA:</span></span>

* <span data-ttu-id="37710-168">4 つの 9 (99.99%) を実現するには、手動操作による障害からの復旧には依存できません。</span><span class="sxs-lookup"><span data-stu-id="37710-168">To achieve four 9's (99.99%), you probably can't rely on manual intervention to recover from failures.</span></span> <span data-ttu-id="37710-169">アプリケーションには自己診断機能と自己復旧機能が必要です。</span><span class="sxs-lookup"><span data-stu-id="37710-169">The application must be self-diagnosing and self-healing.</span></span> 
* <span data-ttu-id="37710-170">4 つの 9 を超えると、SLA を満たすことができるほど迅速に障害を検出することは困難です。</span><span class="sxs-lookup"><span data-stu-id="37710-170">Beyond four 9's, it is challenging to detect outages quickly enough to meet the SLA.</span></span>
* <span data-ttu-id="37710-171">SLA を測定する時間枠について考慮します。</span><span class="sxs-lookup"><span data-stu-id="37710-171">Think about the time window that your SLA is measured against.</span></span> <span data-ttu-id="37710-172">この時間枠を短くするほど、許容度は厳格になります。</span><span class="sxs-lookup"><span data-stu-id="37710-172">The smaller the window, the tighter the tolerances.</span></span> <span data-ttu-id="37710-173">時間単位または日単位のアップタイムという観点で SLA を定義することはおそらく意味がありません。</span><span class="sxs-lookup"><span data-stu-id="37710-173">It probably doesn't make sense to define your SLA in terms of hourly or daily uptime.</span></span> 

<span data-ttu-id="37710-174">ご自分のアーキテクチャで必要となる高可用性機能を決める場合は、SLA を明らかにすることが重要な第一ステップとなります。</span><span class="sxs-lookup"><span data-stu-id="37710-174">Identifying SLAs is an important first step when determining the high availability capabilities that your architecture will require.</span></span> <span data-ttu-id="37710-175">これらの機能は、ご利用のアプリケーションを高可用性にするために使用する手法を形成するのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="37710-175">These will help shape the methods you'll use to make your application highly available.</span></span>

### <a name="evaluate-the-ha-capabilities-of-the-application"></a><span data-ttu-id="37710-176">アプリケーションの HA 機能を評価する</span><span class="sxs-lookup"><span data-stu-id="37710-176">Evaluate the HA capabilities of the application</span></span>

<span data-ttu-id="37710-177">使用するアプリケーションの HA 機能を評価するには、障害解析を実行します。</span><span class="sxs-lookup"><span data-stu-id="37710-177">To evaluate the HA capabilities of your application, perform a failure analysis.</span></span> <span data-ttu-id="37710-178">重点を置くのは、単一障害と重要なコンポーネント (これらに到達不可能な場合、構成が正しくない場合、または予期しない動作を開始した場合にアプリケーションに大きな影響を与える) です。</span><span class="sxs-lookup"><span data-stu-id="37710-178">Focus on single points of failure and critical components that would have a large impact on the application if they were unreachable, misconfigured, or started behaving unexpectedly.</span></span> <span data-ttu-id="37710-179">冗長性がある領域については、アプリケーションがエラー状態を検出して、自己復旧できるかどうかを判断します。</span><span class="sxs-lookup"><span data-stu-id="37710-179">For areas that do have redundancy, determine whether the application is capable of detecting error conditions and self-healing.</span></span>

<span data-ttu-id="37710-180">ご利用のアプリケーションのすべてのコンポーネントについて、慎重に評価する必要があります。たとえば、ロード バランサーなどの HA 機能を提供するように設計されている部分があります。</span><span class="sxs-lookup"><span data-stu-id="37710-180">You'll need to carefully evaluate all components of your application, including the pieces designed to provide HA functionality, such as load balancers.</span></span> <span data-ttu-id="37710-181">単一障害点は、HA 機能を統合するように変更するか、または HA 機能を提供できるサービスに置換する必要があります。</span><span class="sxs-lookup"><span data-stu-id="37710-181">Single points of failure will either need to be modified to have HA capabilities integrated, or will need to be replaced with services that can provide HA capabilities.</span></span>

### <a name="evaluate-the-ha-capabilities-of-dependent-applications"></a><span data-ttu-id="37710-182">依存するアプリケーションの HA 機能を評価する</span><span class="sxs-lookup"><span data-stu-id="37710-182">Evaluate the HA capabilities of dependent applications</span></span>

<span data-ttu-id="37710-183">コンシューマーに対するご利用のアプリケーションの SLA 要件だけでなく、ご利用のアプリケーションが依存する場合がある任意のリソースの指定された SLA も理解する必要があります。</span><span class="sxs-lookup"><span data-stu-id="37710-183">You'll need to understand not only your application's SLA requirements to your consumer, but also the provided SLAs of any resource that your application may depend on.</span></span> <span data-ttu-id="37710-184">顧客に対して 99.9% のアップタイムをコミットしているが、ご利用のアプリケーションが依存しているサービスのアップタイム コミットメントが 99% しかない場合、顧客に対して SLA を満足できないリスクが発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="37710-184">If you are committing an uptime to your customers of 99.9%, but a service your application depends on only has an uptime commitment of 99%, this could put you at risk of not meeting your SLA to your customers.</span></span> <span data-ttu-id="37710-185">依存サービスによって十分な SLA を提供することができない場合は、独自の SLA を変更するか、依存関係を別のものに置換するか、または依存関係が利用できない間に SLA を満たす方法を見つけることが必要な場合があります。</span><span class="sxs-lookup"><span data-stu-id="37710-185">If a dependent service is unable to provide a sufficient SLA, you may need to modify your own SLA, replace the dependency with an alternative, or find ways to meet your SLA while the dependency is unavailable.</span></span> <span data-ttu-id="37710-186">シナリオとの依存関係の性質によっては、キャッシュや作業キューなどのソリューションを使用して、失敗した依存関係を一時的に回避することができます。</span><span class="sxs-lookup"><span data-stu-id="37710-186">Depending on the scenario and the nature of the dependency, failing dependencies can be temporarily worked around with solutions like caches and work queues.</span></span>

## <a name="azures-highly-available-platform"></a><span data-ttu-id="37710-187">Azure の可用性の高いプラットフォーム</span><span class="sxs-lookup"><span data-stu-id="37710-187">Azure's highly available platform</span></span>

<span data-ttu-id="37710-188">Azure クラウド プラットフォームは、そのすべてのサービスを通して高可用性を実現できるように設計されています。</span><span class="sxs-lookup"><span data-stu-id="37710-188">The Azure cloud platform has been designed to provide high availability throughout all its services.</span></span> <span data-ttu-id="37710-189">システムの場合と同様に、アプリケーションもハードウェアとソフトウェアの両方のプラットフォーム イベントの影響を受ける場合があります。</span><span class="sxs-lookup"><span data-stu-id="37710-189">Like any system, applications may be affected by both hardware and software platform events.</span></span> <span data-ttu-id="37710-190">障害に対処できるようにアプリケーション アーキテクチャを設計することの必要性は重要です。Azure クラウド プラットフォームには、アプリケーションの可用性を高めるためのツールおよび機能が用意されています。</span><span class="sxs-lookup"><span data-stu-id="37710-190">The need to design your application architecture to handle failures is critical, and the Azure cloud platform provides you with the tools and capabilities to make your application highly available.</span></span> <span data-ttu-id="37710-191">Azure 上でご利用のアーキテクチャに HA を検討する場合は、いくつかの主要な概念を把握しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="37710-191">There are several core concepts when considering HA for your architecture on Azure:</span></span>

* <span data-ttu-id="37710-192">可用性セット</span><span class="sxs-lookup"><span data-stu-id="37710-192">Availability sets</span></span>
* <span data-ttu-id="37710-193">可用性ゾーン</span><span class="sxs-lookup"><span data-stu-id="37710-193">Availability zones</span></span>
* <span data-ttu-id="37710-194">負荷分散</span><span class="sxs-lookup"><span data-stu-id="37710-194">Load balancing</span></span>
* <span data-ttu-id="37710-195">サービスとしてのプラットフォーム (PaaS) HA 機能</span><span class="sxs-lookup"><span data-stu-id="37710-195">Platform as a service (PaaS) HA capabilities</span></span>

### <a name="availability-sets"></a><span data-ttu-id="37710-196">可用性セット</span><span class="sxs-lookup"><span data-stu-id="37710-196">Availability sets</span></span>

<span data-ttu-id="37710-197">可用性セットは、同じアプリケーション ワークロードに属する VM を分散することでハードウェア障害および予定メンテナンスから同時に影響を受けるのを防ぐ必要があることを Azure に通知する方法です。</span><span class="sxs-lookup"><span data-stu-id="37710-197">Availability sets are a way for you to inform Azure that VMs that belong to the same application workload should be distributed to prevent simultaneous impact from hardware failure and scheduled maintenance.</span></span> <span data-ttu-id="37710-198">可用性セットは、*更新ドメイン*と*障害ドメイン*で構成されています。</span><span class="sxs-lookup"><span data-stu-id="37710-198">Availability sets are made up of *update domains* and *fault domains*.</span></span>

![3 つの可用性セットを示す図。](../media/AzAvailSets.png)

<span data-ttu-id="37710-201">Azure データ センター内の仮想マシン ホストがメンテナンスのためにダウンタイムを必要とする場合でも、更新ドメインにより、ご利用のアプリケーションのサブセットは常に実行状態を確実に維持します。</span><span class="sxs-lookup"><span data-stu-id="37710-201">Update domains ensure that a subset of your application's servers always remain running when the virtual machine hosts in an Azure datacenter require downtime for maintenance.</span></span> <span data-ttu-id="37710-202">ほとんどの更新プログラムは、それらに対して稼働している VM に影響を及ぼさずに実行することができますが、このことが不可能な場合があります。</span><span class="sxs-lookup"><span data-stu-id="37710-202">Most updates can be performed with no impact to the VMs running on them, but there are times when this isn't possible.</span></span> <span data-ttu-id="37710-203">更新プログラムがデータ センターに対して一度に実行されないようにするために、Azure データ センターは論理的に更新ドメイン (UD) に区分されています。</span><span class="sxs-lookup"><span data-stu-id="37710-203">To ensure that updates don't happen to a whole datacenter at once, the Azure datacenter is logically sectioned into update domains (UD).</span></span> <span data-ttu-id="37710-204">パフォーマンス更新プログラムやホストに適用する必要がある重要なセキュリティ パッチなどのメンテナンス イベントが発生した場合、更新プログラムは更新ドメインを経由してシーケンス処理されます。</span><span class="sxs-lookup"><span data-stu-id="37710-204">When a maintenance event, such as a performance update and critical security patch that needs to be applied to the host, the update is sequenced through update domains.</span></span> <span data-ttu-id="37710-205">更新ドメインを使用して更新プログラムをシーケンス処理することにより、プラットフォームの更新中およびパッチ適用中もデータセンター全体が利用不可能になることはありません。</span><span class="sxs-lookup"><span data-stu-id="37710-205">The use of sequencing updates using update domains ensures that the whole datacenter isn't unavailable during platform updates and patching.</span></span>

<span data-ttu-id="37710-206">更新ドメインがデータ センターの論理セクションを表す一方で、障害ドメイン (FD) はデータ センターの物理的なセクションを表し、これにより可用性セット内でのサーバーのラック多様性が確保されます。</span><span class="sxs-lookup"><span data-stu-id="37710-206">While update domains represent a logical section of the datacenter, fault domains (FD) represent physical sections of the datacenter and ensure rack diversity of servers in an availability set.</span></span> <span data-ttu-id="37710-207">障害ドメインは、データ センター内の共有ハードウェアの物理的な分離に合わせて整列されます。</span><span class="sxs-lookup"><span data-stu-id="37710-207">Fault domains align to the physical separation of shared hardware in the datacenter.</span></span> <span data-ttu-id="37710-208">これには、サーバー ラック内に設置された物理サーバーをサポートする電源、冷却装置、およびネットワーク ハードウェアが含まれます。</span><span class="sxs-lookup"><span data-stu-id="37710-208">This includes power, cooling, and network hardware that supports the physical servers located in server racks.</span></span> <span data-ttu-id="37710-209">サーバー ラックをサポートするハードウェアが利用できなくなった場合は、そのサーバー ラックのみが障害の影響を受けます。</span><span class="sxs-lookup"><span data-stu-id="37710-209">In the event the hardware that supports a server rack has become unavailable, only that rack of servers would be affected by the outage.</span></span> <span data-ttu-id="37710-210">VM を可用性セット内に配置することで、ハードウェア障害が発生した場合に、一部の VM しか影響を受けないように、VM が複数の FD に自動的に分散されます。</span><span class="sxs-lookup"><span data-stu-id="37710-210">By placing your VMs in an availability set, your VMs will be automatically spread across multiple FDs so that in the event of a hardware failure only part of your VMs will be impacted.</span></span>

<span data-ttu-id="37710-211">可用性セットを使用すると、影響の大きいメンテナンス イベントが必要とされる場合やハードウェア障害が発生した場合でも、ご利用のアプリケーションがオンライン状態で確実に維持されるようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="37710-211">With availability sets, you can ensure your application remains online if a high-impact maintenance event is required or hardware failures occur.</span></span>

### <a name="availability-zones"></a><span data-ttu-id="37710-212">可用性ゾーン</span><span class="sxs-lookup"><span data-stu-id="37710-212">Availability zones</span></span>

<span data-ttu-id="37710-213">可用性ゾーンは、独自の電源、冷却装置、およびネットワークを備えた、リージョン内にある独立した物理的なデータ センターの場所です。</span><span class="sxs-lookup"><span data-stu-id="37710-213">Availability zones are independent physical datacenter locations within a region that include their own power, cooling, and networking.</span></span> <span data-ttu-id="37710-214">リソースをデプロイする際に可用性ゾーンを考慮に入れることにより、特定のリージョンでのプレゼンスを維持しながら、データ センターの障害からワークロードを保護することができます。</span><span class="sxs-lookup"><span data-stu-id="37710-214">By taking availability zones into account when deploying resources, you can protect workloads from datacenter outages while retaining presence in a particular region.</span></span> <span data-ttu-id="37710-215">仮想マシンのようなサービスは、*ゾーン サービス*です。これらは、リージョン内の特定のゾーンにデプロイすることができます。</span><span class="sxs-lookup"><span data-stu-id="37710-215">Services like virtual machines are *zonal services* and allow you to deploy them to specific zones within a region.</span></span> <span data-ttu-id="37710-216">他のサービスは*ゾーン冗長サービス*であり、特定の Azure リージョン内の複数の可用性ゾーンにわたってレプリケートされます。</span><span class="sxs-lookup"><span data-stu-id="37710-216">Other services are *zone-redundant services* and will replicate across the availability zones in the specific Azure region.</span></span> <span data-ttu-id="37710-217">両方の種類のサービスにより、Azure リージョン内では単一障害点が発生することはありません。</span><span class="sxs-lookup"><span data-stu-id="37710-217">Both types ensure that within an Azure region there are no single points of failure.</span></span>

![Azure リージョン内の 3 つの可用性ゾーンを示す図。](../media/AzAvailZones.png)

<span data-ttu-id="37710-220">サポートされているリージョンには、最低でも 3 つの可用性ゾーンが含まれています。</span><span class="sxs-lookup"><span data-stu-id="37710-220">Supported regions contain a minimum of three availability zones.</span></span> <span data-ttu-id="37710-221">それらのリージョン内にゾーン サービス リソースを作成する場合は、リソースを作成する必要があるゾーンを選択することができます。</span><span class="sxs-lookup"><span data-stu-id="37710-221">When creating zonal service resources in those regions, you'll have the ability to select the zone in which the resource should be created.</span></span> <span data-ttu-id="37710-222">これにより、アプリケーションを別の Azure リージョンに退避させなくても済むように、ゾーンの障害に耐え、Azure リージョン内で引き続き動作可能なようにアプリケーションを設計することができます。</span><span class="sxs-lookup"><span data-stu-id="37710-222">This will allow you to design your application to withstand a zonal outage and continue to operate in an Azure region before having to evacuate your application to another Azure region.</span></span>

<span data-ttu-id="37710-223">可用性ゾーンは、Azure リージョン向けのより新しい高可用性構成サービスであり、現時点では特定のリージョンで使用することができます。</span><span class="sxs-lookup"><span data-stu-id="37710-223">Availability zones are a newer high availability configuration service for Azure regions and are currently available for certain regions.</span></span> <span data-ttu-id="37710-224">この機能を検討する場合は、アプリケーションのデプロイ先に予定しているリージョン内で、このサービスの可用性を確認することが重要です。</span><span class="sxs-lookup"><span data-stu-id="37710-224">It's important to check the availability of this service in the region that you're planning to deploy your application if you want to consider this functionality.</span></span> <span data-ttu-id="37710-225">可用性ゾーンは、仮想マシンを使用する場合のほか、いくつかの PaaS サービスを使用する場合もサポートされます。</span><span class="sxs-lookup"><span data-stu-id="37710-225">Availability zones are supported when using virtual machines, as well as several PaaS services.</span></span> <span data-ttu-id="37710-226">可用性ゾーンは、可用性セットと相互に排他的です。</span><span class="sxs-lookup"><span data-stu-id="37710-226">Availability zones are mutually exclusive with availability sets.</span></span> <span data-ttu-id="37710-227">可用性ゾーンを使用する場合は、システムに可用性セットを定義する必要がなくなります。</span><span class="sxs-lookup"><span data-stu-id="37710-227">When using availability zones you no longer need to define an availability set for your systems.</span></span> <span data-ttu-id="37710-228">データ センター レベルで多様性がもたらされ、複数の可用性ゾーンに対して更新プログラムが同時に実行されることがなくなります。</span><span class="sxs-lookup"><span data-stu-id="37710-228">You'll have diversity at the data center level, and updates will never be performed to multiple availability zones at the same time.</span></span>

### <a name="load-balancing"></a><span data-ttu-id="37710-229">負荷分散</span><span class="sxs-lookup"><span data-stu-id="37710-229">Load balancing</span></span>

<span data-ttu-id="37710-230">ロード バランサーでは、ネットワーク トラフィックをアプリケーション全体に分散する方法が管理されます。</span><span class="sxs-lookup"><span data-stu-id="37710-230">Load balancers manage how network traffic is distributed across an application.</span></span> <span data-ttu-id="37710-231">ロード バランサーは、個々のコンポーネントでの障害に対するご利用のアプリケーションの回復力を維持する上で、また要求の処理でご利用のアプリケーションを確実に使用できるようにする上で不可欠です。</span><span class="sxs-lookup"><span data-stu-id="37710-231">Load balancers are essential in keeping your application resilient to individual component failures and to ensure your application is available to process requests.</span></span> <span data-ttu-id="37710-232">サービス検出が組み込まれていないアプリケーションの場合は、可用性セットと可用性ゾーンの両方に対して負荷分散が必要です。</span><span class="sxs-lookup"><span data-stu-id="37710-232">For applications that don't have service discovery built in, load balancing is required for both availability sets and availability zones.</span></span>

<span data-ttu-id="37710-233">Azure には 3 つの負荷分散テクノロジ サービスがあります。これらは、ネットワーク トラフィックをルーティングする機能で区別されます。</span><span class="sxs-lookup"><span data-stu-id="37710-233">Azure possesses three load balancing technology services that are distinct in their abilities to route network traffic:</span></span>

* <span data-ttu-id="37710-234">**Azure Traffic Manager** は、グローバルな DNS 負荷分散機能を備えています。</span><span class="sxs-lookup"><span data-stu-id="37710-234">**Azure Traffic Manager** provides global DNS load balancing.</span></span> <span data-ttu-id="37710-235">Traffic Manager を使用して Azure リージョン内または Azure リージョン間での DNS エンドポイントの負荷分散を行うことを検討します。</span><span class="sxs-lookup"><span data-stu-id="37710-235">You would consider using Traffic Manager to provide load balancing of DNS endpoints within or across Azure regions.</span></span> <span data-ttu-id="37710-236">Traffic Manager は、使用可能なエンドポイントに要求を分散し、エンドポイントの監視を使用して障害を起こしているエンドポイントを検出し、負荷から削除します。</span><span class="sxs-lookup"><span data-stu-id="37710-236">Traffic manager will distribute requests to available endpoints, and use endpoint monitoring to detect and remove failed endpoints from load.</span></span>
* <span data-ttu-id="37710-237">**Azure Application Gateway** では、着信トラフィックのラウンド ロビン分散、Cookie ベースのセッション アフィニティ、URL パス ベースのルーティング、および単一のアプリケーション ゲートウェイの背後で複数の Web サイトをホストする機能など、レイヤー 7 の負荷分散機能が用意されています。</span><span class="sxs-lookup"><span data-stu-id="37710-237">**Azure Application Gateway** provides Layer 7 load-balancing capabilities, such as round-robin distribution of incoming traffic, cookie-based session affinity, URL path-based routing, and the ability to host multiple websites behind a single application gateway.</span></span> <span data-ttu-id="37710-238">既定では、Application Gateway はバック エンド プールにあるすべてのリソースの状態を監視して、異常とみなしたリソースをプールから自動的に削除します。</span><span class="sxs-lookup"><span data-stu-id="37710-238">Application Gateway by default monitors the health of all resources in its back-end pool and automatically removes any resource considered unhealthy from the pool.</span></span> <span data-ttu-id="37710-239">Application Gateway は異常なインスタンスを継続的に監視し、このインスタンスが利用可能になり正常性プローブに応答するようになると、正常バック エンド プールに戻します。</span><span class="sxs-lookup"><span data-stu-id="37710-239">Application Gateway continues to monitor the unhealthy instances and adds them back to the healthy back-end pool once they become available and respond to health probes.</span></span>
* <span data-ttu-id="37710-240">**Azure Load Balancer** は、レイヤー 4 のロード バランサーです。</span><span class="sxs-lookup"><span data-stu-id="37710-240">**Azure Load Balancer** is a layer 4 load balancer.</span></span> <span data-ttu-id="37710-241">負荷分散されるパブリックおよび内部のエンドポイントを構成したり、TCP を使用して受信接続をバックエンド プールの送信先にマッピングする規則や、サービスの可用性を管理するための HTTP の正常性プローブ オプションを定義したりできます。</span><span class="sxs-lookup"><span data-stu-id="37710-241">You can configure public and internal load-balanced endpoints and define rules to map inbound connections to back-end pool destinations by using TCP and HTTP health-probing options to manage service availability.</span></span>

<span data-ttu-id="37710-242">この 3 つの Azure 負荷分散テクノロジのいずれか 1 つまたは 3 つすべての組み合わせにより、ご利用のアプリケーションを介してネットワーク トラフィックをルーティングする高可用性のソリューションを構築する場合に必要なオプションを確実に利用できるようにすることができます。</span><span class="sxs-lookup"><span data-stu-id="37710-242">One or a combination of all three Azure load-balancing technologies can ensure you have the necessary options available to architect a highly available solution to route network traffic through your application.</span></span>

![Azure 負荷分散オプション。Azureのさまざまな負荷分散テクノロジを示す図。](../media/AzLBOptions.png)

### <a name="paas-ha-capabilities"></a><span data-ttu-id="37710-248">PaaS HA 機能</span><span class="sxs-lookup"><span data-stu-id="37710-248">PaaS HA capabilities</span></span>

<span data-ttu-id="37710-249">高可用性が組み込まれた PaaS サービス。</span><span class="sxs-lookup"><span data-stu-id="37710-249">PaaS services come with high availability built in.</span></span> <span data-ttu-id="37710-250">Azure SQL Database、Azure App Service、および Azure Service Bus などのサービスには、高可用性機能が含まれています。これにより、サービスの個々のコンポーネントの障害は、アプリケーションに対して確実にシームレスになります。</span><span class="sxs-lookup"><span data-stu-id="37710-250">Services such as Azure SQL Database, Azure App Service, and Azure Service Bus include high availability features and ensure that failures of an individual component of the service will be seamless to your application.</span></span> <span data-ttu-id="37710-251">PaaS サービスを使用することは、ご利用のアーキテクチャが確実に高可用性になるようにするための最善の方法の 1 つです。</span><span class="sxs-lookup"><span data-stu-id="37710-251">Using PaaS services is one of the best ways to ensure that your architecture is highly available.</span></span>

<span data-ttu-id="37710-252">高可用性のための設計を行う場合は、顧客にコミットする SLA を理解することが必要です。</span><span class="sxs-lookup"><span data-stu-id="37710-252">When architecting for high availability, you'll want to understand the SLA that you're committing to your customers.</span></span> <span data-ttu-id="37710-253">ご利用のアプリケーションで用意されている HA 機能と、依存システムの HA 機能および SLA をいずれも評価します。</span><span class="sxs-lookup"><span data-stu-id="37710-253">Then evaluate both the HA capabilities that your application has, and the HA capabilities and SLAs of dependent systems.</span></span> <span data-ttu-id="37710-254">それらが確定されたら、可用性セット、可用性ゾーン、およびさまざまな負荷分散テクノロジを使用して、ご利用のアプリケーションに HA 機能を追加します。</span><span class="sxs-lookup"><span data-stu-id="37710-254">After those have been established, use Azure features, such as availability sets, availability zones, and various load-balancing technologies, to add HA capabilities to your application.</span></span> <span data-ttu-id="37710-255">任意の PaaS サービスを使用するように選択すると、HA 機能が組み込まれます。</span><span class="sxs-lookup"><span data-stu-id="37710-255">Any PaaS services you should choose to use will have HA capabilities built in.</span></span>
