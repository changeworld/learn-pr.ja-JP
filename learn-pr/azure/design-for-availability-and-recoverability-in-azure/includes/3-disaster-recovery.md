<span data-ttu-id="a4582-101">高可用性を考慮した設計は、好ましくないイベントや悪条件にもかかわらずアプリケーションまたはプロセスの稼働を継続するのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="a4582-101">Designing for high availability helps keep an application or process running despite unfavorable events and adverse conditions.</span></span> <span data-ttu-id="a4582-102">しかし、何らかの重大なイベントが発生してデータが失われ、アプリやプロセスがダウンすることを回避できない場合はどうしますか。</span><span class="sxs-lookup"><span data-stu-id="a4582-102">But what do you do when something so significant happens that you've lost data and it's impossible to keep your apps and processes from going down?</span></span> <span data-ttu-id="a4582-103">災害が発生した場合に備えて、サービスを再び稼働させるために必要なプランを策定しておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="a4582-103">When disaster strikes, you need to have a plan to get your services running again.</span></span> <span data-ttu-id="a4582-104">復旧の目標と期待、プランのコストと制限、およびプランの実行方法を知っておく必要があります。</span><span class="sxs-lookup"><span data-stu-id="a4582-104">You should know what your goals and expectations are for recovering, what are the costs and limitations of your plan, and how to execute on it.</span></span>

## <a name="what-is-disaster-recovery"></a><span data-ttu-id="a4582-105">ディザスター リカバリーとは</span><span class="sxs-lookup"><span data-stu-id="a4582-105">What is disaster recovery?</span></span>

<span data-ttu-id="a4582-106">ディザスター リカバリーは、ダウンタイムやデータ損失につながる*影響の大きいイベントからの復旧*に関連するものです。</span><span class="sxs-lookup"><span data-stu-id="a4582-106">Disaster recovery is about *recovering from high-impact events* that result in downtime and data loss.</span></span> <span data-ttu-id="a4582-107">災害は、高可用性のためのアプリケーション設計によって軽減できる範囲をはるかに超えた長期的な影響を生じさせる単一の大きなイベントです。</span><span class="sxs-lookup"><span data-stu-id="a4582-107">A disaster is a single, major event with an impact much larger and long-lasting than the application can mitigate through the high-availability portion of its design.</span></span>

<span data-ttu-id="a4582-108">多くの場合、"災害" という言葉は、(地震、洪水、台風などの) *自然*災害や外的イベントを連想させますが、他にも多くの種類の災害が存在します。</span><span class="sxs-lookup"><span data-stu-id="a4582-108">The word "disaster" often evokes thoughts of *natural* disasters and external events (earthquakes, floods, tropical storms, and so on) but many other kinds of disasters exist as well.</span></span> <span data-ttu-id="a4582-109">デプロイやアップグレードの失敗によって、アプリが認識不能な状態になる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="a4582-109">A failed deployment or upgrade can leave an app in an unrecognizable state.</span></span> <span data-ttu-id="a4582-110">悪意のあるハッカーによってデータが暗号化または削除され、その他の種類の損害が与えられることで、アプリがオフラインになったり、一部の機能が除去される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="a4582-110">Malicious hackers can encrypt or delete data and inflict other kinds of damage that take an app offline or eliminate some of its functionality.</span></span>

<span data-ttu-id="a4582-111">その原因にかかわらず、いったん発生した災害に対する最善の対処法は、明確に定義されていてテスト済みのディザスター リカバリー プランと、その設計を通じてディザスター リカバリーの取り組みを積極的にサポートするアプリケーションです。</span><span class="sxs-lookup"><span data-stu-id="a4582-111">Regardless of its cause, the best remedy for a disaster once it has occurred is a well-defined, tested disaster recovery plan and an application that actively supports disaster recovery efforts through its design.</span></span>

## <a name="how-to-create-a-disaster-recovery-plan"></a><span data-ttu-id="a4582-112">ディザスター リカバリー プランの作成方法</span><span class="sxs-lookup"><span data-stu-id="a4582-112">How to create a disaster recovery plan</span></span>

<span data-ttu-id="a4582-113">ディザスター リカバリー プランは、災害によって発生したデータ損失やダウンタイムから復旧するために必要な手順を詳しく記述し、それらの手順を指揮する責任者を特定する単一のドキュメントです。</span><span class="sxs-lookup"><span data-stu-id="a4582-113">A disaster recovery plan is a single document that details the procedures that are required to recover from data loss and downtime caused by a disaster, and identifies who's in charge of directing those procedures.</span></span> <span data-ttu-id="a4582-114">オペレーターは、災害発生後にアプリケーションの接続を復元してデータを復旧するためのマニュアルとして、プランを使用できる必要があります。</span><span class="sxs-lookup"><span data-stu-id="a4582-114">Operators should be able to use the plan as a manual to restore application connectivity and recover data after a disaster occurs.</span></span> <span data-ttu-id="a4582-115">良好な結果を得るには、ディザスター リカバリー専用の詳細な書面のプランが重要です。</span><span class="sxs-lookup"><span data-stu-id="a4582-115">A detailed, written plan that's dedicated to disaster recovery is critical to ensuring a favorable outcome.</span></span> <span data-ttu-id="a4582-116">プランを作成するプロセスは、アプリケーションの全体像を把握するのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="a4582-116">The process of creating the plan will help to assemble a complete picture of the application.</span></span> <span data-ttu-id="a4582-117">作成された書面の手順は、適切な意思決定と、障害発生直後の混乱したパニック状態への適切な対応を促進します。</span><span class="sxs-lookup"><span data-stu-id="a4582-117">The resulting written steps will promote good decision-making and follow-through in the panicked, chaotic aftermath of a disaster event.</span></span>

<span data-ttu-id="a4582-118">ディザスター リカバリー プランの作成には、アプリケーションのワークフロー、データ、インフラストラクチャ、および依存関係に関する専門知識が必要です。</span><span class="sxs-lookup"><span data-stu-id="a4582-118">Creating a disaster recovery plan requires expert knowledge of the application's workflows, data, infrastructure, and dependencies.</span></span>

### <a name="risk-assessment-and-process-inventory"></a><span data-ttu-id="a4582-119">リスク評価とプロセス インベントリ</span><span class="sxs-lookup"><span data-stu-id="a4582-119">Risk assessment and process inventory</span></span>

<span data-ttu-id="a4582-120">ディザスター リカバリー プラン作成の最初のステップは、さまざまな種類の災害がアプリケーションに及ぼす影響を調べるリスク分析の実行です。</span><span class="sxs-lookup"><span data-stu-id="a4582-120">The first step in creating a disaster recovery plan is performing a risk analysis that examines the impact of different kinds of disasters on the application.</span></span> <span data-ttu-id="a4582-121">リスク分析では、災害の本質よりも、データ損失やアプリケーションのダウンタイムという形で現れる災害の潜在的な影響の方が重要です。</span><span class="sxs-lookup"><span data-stu-id="a4582-121">The exact nature of a disaster isn't as important to the risk analysis as its potential impact through data loss and application downtime.</span></span> <span data-ttu-id="a4582-122">さまざまな種類の災害を想定し、できるだけ具体的にそれらの影響を検討します。</span><span class="sxs-lookup"><span data-stu-id="a4582-122">Explore various kinds of hypothetical disasters and try to be specific when thinking about their effects.</span></span> <span data-ttu-id="a4582-123">たとえば、ターゲット型の悪質な攻撃によってコードまたはデータが改変された結果、地震によりネットワーク接続が中断されたり、データセンターを利用できなくなるというものとは異なる種類の影響が生じる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="a4582-123">For example, a targeted malicious attack may modify code or data that results in a different kind of impact than an earthquake that disrupts network connectivity and datacenter availability.</span></span>

<span data-ttu-id="a4582-124">リスク評価では、際限のないダウンタイムが許されない*すべての*プロセスと、際限のない損失が許されないすべてのデータ カテゴリを検討する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a4582-124">The risk assessment needs to consider *every* process that can't afford unlimited downtime, and every category of data that can't afford unlimited loss.</span></span> <span data-ttu-id="a4582-125">複数のアプリケーション コンポーネントに影響を及ぼす災害が発生したときに、プランの所有者がそのプランを使用して、注意が必要な項目と各項目の優先順位を決める方法に関する完全なインベントリを作成できることが重要です。</span><span class="sxs-lookup"><span data-stu-id="a4582-125">When a disaster that affects multiple application components occurs, it's critical that the plan owners can use the plan to take a complete inventory of what needs attention and how to prioritize each item.</span></span>

<span data-ttu-id="a4582-126">一部のアプリでは、データの単一のプロセスまたは分類のみが構成される場合があります。</span><span class="sxs-lookup"><span data-stu-id="a4582-126">Some apps may only constitute a single process or classification of data.</span></span> <span data-ttu-id="a4582-127">アプリケーションは、組織の複数のアプリケーションを含むより大規模なディザスター リカバリー プランの構成要素の 1 つになる可能性が高いため、これはやはり重要な注意点です。</span><span class="sxs-lookup"><span data-stu-id="a4582-127">This is still important to note, as the application will likely be one component of a larger disaster recovery plan that includes multiple applications with the organization.</span></span>

### <a name="recovery-objectives"></a><span data-ttu-id="a4582-128">復旧目標</span><span class="sxs-lookup"><span data-stu-id="a4582-128">Recovery objectives</span></span>

<span data-ttu-id="a4582-129">完全なプランでは、アプリケーションによって実装されるプロセスごとに、2 つの重要なビジネス要件を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a4582-129">A complete plan needs to specify two critical business requirements for each process implemented by the application:</span></span>

* <span data-ttu-id="a4582-130">**回復ポイントの目標 (RPO)**: 許容されるデータ損失の最大継続時間。</span><span class="sxs-lookup"><span data-stu-id="a4582-130">**Recovery Point Objective (RPO)**: The maximum duration of acceptable data loss.</span></span> <span data-ttu-id="a4582-131">RPO は "30 分のデータ"、"4 時間のデータ" のように、数量ではなく時間の単位で計測されます。</span><span class="sxs-lookup"><span data-stu-id="a4582-131">RPO is measured in units of time, not volume: "30 minutes of data", "four hours of data", and so on.</span></span> <span data-ttu-id="a4582-132">RPO はデータの*損失*の限定や復旧に関連するものであり、データの*盗難*には関連しません。</span><span class="sxs-lookup"><span data-stu-id="a4582-132">RPO is about limiting and recovering from data *loss*, not data *theft*.</span></span>
* <span data-ttu-id="a4582-133">**回復時刻の目標 (RTO)**: 許容されるダウンタイムの最大継続時間。"ダウンタイム" は指定内容に従って定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a4582-133">**Recovery Time Objective (RTO)**: The maximum duration of acceptable downtime, where "downtime" needs to be defined by your specification.</span></span> <span data-ttu-id="a4582-134">たとえば、障害のイベントで許容されるダウンタイムの継続時間が 8 時間の場合、RPO は 8 時間です。</span><span class="sxs-lookup"><span data-stu-id="a4582-134">For example, if the acceptable downtime duration is eight hours in the event of a disaster, then your RPO is eight hours.</span></span>

![災害発生時間からの回復ポイントの目標と回復時刻の目標を時間単位で示した図。](../media/rto-rpo.png)

<span data-ttu-id="a4582-136">アプリによって実装される主なプロセスまたはワークロードごとに、個別の RPO 値と RTO 値を定義する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a4582-136">Each major process or workload that's implemented by an app should have separate RPO and RTO values.</span></span> <span data-ttu-id="a4582-137">異なるプロセスに対して値が同じになったとしても、それぞれの値は、災害シナリオのリスクと潜在的な復旧戦略をプロセスごとに検討する個別の分析に基づいて生成されたものである必要があります。</span><span class="sxs-lookup"><span data-stu-id="a4582-137">Even if you arrive at the same values for different processes, each one should be generated through a separate analysis that examines disaster scenario risks and potential recovery strategies for each respective process.</span></span>

<span data-ttu-id="a4582-138">RPO と RTO を指定するプロセスによって、アプリケーションのディザスター リカバリー要件が実質的に作成されます。</span><span class="sxs-lookup"><span data-stu-id="a4582-138">The process of specifying an RPO and RTO is effectively the creation of disaster recovery requirements for your application.</span></span> <span data-ttu-id="a4582-139">データの各ワークロードとカテゴリの優先順位を確定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a4582-139">It requires establishing the priority of each workload and category of data and performing a cost-benefit analysis.</span></span> <span data-ttu-id="a4582-140">この分析には、実装とメンテナンスのコスト、運用費、プロセスのオーバーヘッド、パフォーマンスへの影響、ダウンタイムと失われたデータの影響などの懸案事項が含まれます。</span><span class="sxs-lookup"><span data-stu-id="a4582-140">The analysis includes concerns, such as implementation and maintenance cost, operational expense, process overhead, performance impact, and the impact of downtime and lost data.</span></span> <span data-ttu-id="a4582-141">アプリケーションにとっての "ダウンタイム" の意味を正確に定義する必要があります。場合によっては、異なる機能レベルに対して別個の RPO 値や RTO 値を確立します。</span><span class="sxs-lookup"><span data-stu-id="a4582-141">You'll need to define exactly what "downtime" means for your application, and in some cases, you may establish separate RPO and RTO values for different levels of functionality.</span></span> <span data-ttu-id="a4582-142">RPO と RTO の指定は、単に任意の値を選べばよいというものではありません。</span><span class="sxs-lookup"><span data-stu-id="a4582-142">Specifying RPO and RTO should be more than simply choosing arbitrary values.</span></span> <span data-ttu-id="a4582-143">ディザスター リカバリー プランに関する値の多くは、災害の潜在的な影響やリスク軽減のコストの算定にまで踏み入った調査と分析に基づくものです。</span><span class="sxs-lookup"><span data-stu-id="a4582-143">Much of the value of a disaster recovery plan comes from the research and analysis that goes into discovering the potential impact of a disaster and the cost of mitigating the risks.</span></span>

### <a name="detailing-recovery-steps"></a><span data-ttu-id="a4582-144">復旧手順の詳述</span><span class="sxs-lookup"><span data-stu-id="a4582-144">Detailing recovery steps</span></span>

<span data-ttu-id="a4582-145">最終的なプランでは、失われたデータやアプリケーションの接続性を復元するために行う必要がある正確な手順について詳しく記述する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a4582-145">The final plan should go into detail about exactly what steps should be taken to restore lost data and application connectivity.</span></span> <span data-ttu-id="a4582-146">手順には多くの場合、以下に関する情報が含まれます。</span><span class="sxs-lookup"><span data-stu-id="a4582-146">Steps often include information about:</span></span>

* <span data-ttu-id="a4582-147">**バックアップ**: 作成頻度、保存場所、バックアップからのデータ復元方法。</span><span class="sxs-lookup"><span data-stu-id="a4582-147">**Backups**: How often they're created, where they're located, and how to restore data from them.</span></span>
* <span data-ttu-id="a4582-148">**データ レプリカ**: レプリカの数と場所、レプリケートされたデータの性質および整合性の特性、別のレプリカへの切り替え方法。</span><span class="sxs-lookup"><span data-stu-id="a4582-148">**Data replicas**: The number and locations of replicas, the nature and consistency characteristics of the replicated data, and how to switch over to a different replica.</span></span>
* <span data-ttu-id="a4582-149">**デプロイ**: デプロイの実行方法、ロールバックの発生のしくみ、デプロイの失敗シナリオ。</span><span class="sxs-lookup"><span data-stu-id="a4582-149">**Deployments**: How deployments are executed, how rollbacks occur, and failure scenarios for deployments.</span></span>
* <span data-ttu-id="a4582-150">**インフラストラクチャ**: オンプレミスおよびクラウドのリソース、ネットワーク インフラストラクチャ、ハードウェア インベントリ。</span><span class="sxs-lookup"><span data-stu-id="a4582-150">**Infrastructure**: On-premises and cloud resources, network infrastructure, and hardware inventory.</span></span>
* <span data-ttu-id="a4582-151">**依存関係**: アプリケーションで使用される外部サービス (SLA や連絡先情報など)。</span><span class="sxs-lookup"><span data-stu-id="a4582-151">**Dependencies**: External services that are used by the application, including SLAs and contact information.</span></span>
* <span data-ttu-id="a4582-152">**構成と通知**: アプリケーションのグレースフル デグレーションのために設定可能なフラグまたはオプション、アプリケーションへの影響をユーザーに通知するために使用されるサービス。</span><span class="sxs-lookup"><span data-stu-id="a4582-152">**Configuration and notification**: Flags or options that can be set to gracefully degrade the application, and services that are used to notify users of application impact.</span></span>

<span data-ttu-id="a4582-153">具体的に必要な手順はアプリの実装の詳細によって大きく異なるため、プランを継続的に更新することが重要です。</span><span class="sxs-lookup"><span data-stu-id="a4582-153">The exact steps that are required will depend heavily on implementation details of the app, making it important to keep the plan updated.</span></span> <span data-ttu-id="a4582-154">プランの定期的なテストは、ギャップや古くなったセクションを特定するのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="a4582-154">Routinely testing the plan will help identify gaps and outdated sections.</span></span>

## <a name="designing-for-disaster-recovery"></a><span data-ttu-id="a4582-155">ディザスター リカバリーを考慮した設計</span><span class="sxs-lookup"><span data-stu-id="a4582-155">Designing for disaster recovery</span></span>

<span data-ttu-id="a4582-156">ディザスター リカバリーは自動的な機能ではありません。</span><span class="sxs-lookup"><span data-stu-id="a4582-156">Disaster recovery is not an automatic feature.</span></span> <span data-ttu-id="a4582-157">これは設計し、構築し、テストする必要があります。</span><span class="sxs-lookup"><span data-stu-id="a4582-157">It must be designed, built, and tested.</span></span> <span data-ttu-id="a4582-158">強固なディザスター リカバリー戦略をサポートする必要があるアプリは、ディザスター リカバリーを考慮して最初から構築する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a4582-158">An app that needs to support a solid disaster recovery strategy must be built from the ground up with disaster recovery in mind.</span></span> <span data-ttu-id="a4582-159">Azure では、ディザスター リカバリーをサポートするアプリの作成に役立つサービス、機能、およびガイダンスが提供されますが、それらを設計に組み込むことはユーザーの役割です。</span><span class="sxs-lookup"><span data-stu-id="a4582-159">Azure offers services, features, and guidance to help you create apps that support disaster recovery, but it's up to you to include them in your design.</span></span>

<span data-ttu-id="a4582-160">ディザスター リカバリーを考慮した設計には、次の 2 つの主な懸念事項があります。</span><span class="sxs-lookup"><span data-stu-id="a4582-160">Designing for disaster recovery has two main concerns:</span></span>

* <span data-ttu-id="a4582-161">**データの回復**: バックアップとレプリケーションを使用して失われたデータを復元する。</span><span class="sxs-lookup"><span data-stu-id="a4582-161">**Data recovery**: Using backups and replication to restore lost data.</span></span>
* <span data-ttu-id="a4582-162">**プロセスの回復**: サービスを復旧させ、コードをデプロイすることによって障害から復旧する。</span><span class="sxs-lookup"><span data-stu-id="a4582-162">**Process recovery**: Recovering services and deploying code to recover from outages.</span></span>

### <a name="data-recovery-and-replication"></a><span data-ttu-id="a4582-163">データの回復とレプリケーション</span><span class="sxs-lookup"><span data-stu-id="a4582-163">Data recovery and replication</span></span>

<span data-ttu-id="a4582-164">レプリケーションでは、複数のデータ ストア レプリカ間で格納されたデータを複製します。</span><span class="sxs-lookup"><span data-stu-id="a4582-164">Replication duplicates stored data between multiple data store replicas.</span></span> <span data-ttu-id="a4582-165">*バックアップ*では、復旧に使用するデータの読み取り専用スナップショットが作成され、長期間保持されますが、レプリケーションではそれとは異なり、ライブ データのリアルタイムまたはほぼリアルタイムのコピーが作成されます。</span><span class="sxs-lookup"><span data-stu-id="a4582-165">Unlike *backup*, which creates long-lived, read-only snapshots of data for use in recovery, replication creates real-time or near-real-time copies of live data.</span></span> <span data-ttu-id="a4582-166">レプリケーションの目標は、アプリケーションの応答性を維持しながら、できるだけ短い待機時間でレプリカを同期し続けることです。</span><span class="sxs-lookup"><span data-stu-id="a4582-166">The goal of replication is to keep replicas synchronized with as little latency as possible while maintaining application responsiveness.</span></span> <span data-ttu-id="a4582-167">レプリケーションは、高可用性とディザスター リカバリーを考慮して設計するための重要な要素であり、運用グレードのアプリケーションの一般的な機能です。</span><span class="sxs-lookup"><span data-stu-id="a4582-167">Replication is a key component of designing for high availability and disaster recovery, and is a common feature of production-grade applications.</span></span>

<span data-ttu-id="a4582-168">レプリケーションは、*フェールオーバー*を実行することによって、データ ストアの障害または到達不能の影響を緩和するために使用されます。フェールオーバーとは、アプリケーションの構成を変更して、稼働中のレプリカにデータ要求をルーティングすることです。</span><span class="sxs-lookup"><span data-stu-id="a4582-168">Replication is used to mitigate a failed or unreachable data store by executing a *failover*: changing application configuration to route data requests to a working replica.</span></span> <span data-ttu-id="a4582-169">多くの場合、フェールオーバーは自動化され、データ ストレージ製品に組み込まれたエラー検出、または独自の監視ソリューションを使用して独自に実装する検出によってトリガーされます。</span><span class="sxs-lookup"><span data-stu-id="a4582-169">Failover is often automated, triggered by error detection built into a data storage product, or detection that you implement through your monitoring solution.</span></span> <span data-ttu-id="a4582-170">実装およびシナリオによっては、システム オペレーターが手動でフェールオーバーを実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a4582-170">Depending on the implementation and the scenario, failover may need to be manually executed by system operators.</span></span>

<span data-ttu-id="a4582-171">レプリケーションはゼロから実装するものではありません。</span><span class="sxs-lookup"><span data-stu-id="a4582-171">Replication is not something you implement from scratch.</span></span> <span data-ttu-id="a4582-172">ほとんどのフル機能のデータベース システムやその他のデータ ストレージ製品およびサービスには、それらに求められる機能面およびパフォーマンス面の要件を満たすために、何らかの種類のレプリケーションが、緊密に統合された機能として含まれています。</span><span class="sxs-lookup"><span data-stu-id="a4582-172">Most fully featured database systems and other data storage products and services include some kind of replication as a tightly integrated feature due to its functional and performance requirements.</span></span> <span data-ttu-id="a4582-173">しかし、アプリケーションの設計にこれらの機能を組み込んで適切に利用することはユーザーの役割です。</span><span class="sxs-lookup"><span data-stu-id="a4582-173">However, it's up to you to include these features in your application design and make appropriate use of them.</span></span>

<span data-ttu-id="a4582-174">各種の Azure サービスで、さまざまなレベルおよび概念のレプリケーションがサポートされます。</span><span class="sxs-lookup"><span data-stu-id="a4582-174">Different Azure services support various levels and concepts of replication.</span></span> <span data-ttu-id="a4582-175">例:</span><span class="sxs-lookup"><span data-stu-id="a4582-175">For example:</span></span>

* <span data-ttu-id="a4582-176">**Azure Storage** のレプリケーション機能は、ストレージ アカウント用に選択されたレプリケーションの種類に依存します。</span><span class="sxs-lookup"><span data-stu-id="a4582-176">**Azure Storage** replication capabilities depend on the replication type of selected for the storage account.</span></span> <span data-ttu-id="a4582-177">このレプリケーションは、ローカル (データセンター内)、ゾーン (リージョン内のデータセンター間)、またはリージョン (リージョン間) で実行できます。</span><span class="sxs-lookup"><span data-stu-id="a4582-177">This replication can be local (within a datacenter), zonal (between data centers within a region), or regional (between regions).</span></span> <span data-ttu-id="a4582-178">アプリケーションやオペレーターによって、直接操作されることはありません。</span><span class="sxs-lookup"><span data-stu-id="a4582-178">Neither your application nor your operators interact with it directly.</span></span> <span data-ttu-id="a4582-179">フェールオーバーは自動的かつ透過的であり、必要なのは、コストとリスクのバランスが取れたレプリケーション レベルを選択することだけです。</span><span class="sxs-lookup"><span data-stu-id="a4582-179">Failovers are automatic and transparent, and you simply need to select a replication level that balances cost and risk.</span></span>
* <span data-ttu-id="a4582-180">**Azure SQL Database** レプリケーションは、小規模であれば自動ですが、Azure のデータセンターまたはリージョンの全面的な障害からの復旧には geo レプリケーションが必要です。</span><span class="sxs-lookup"><span data-stu-id="a4582-180">**Azure SQL Database** replication is automatic at a small scale, but recovery from a full Azure datacenter or regional outage requires geo-replication.</span></span> <span data-ttu-id="a4582-181">geo レプリケーションの設定は手動ですが、サービスの優れた機能であり、ドキュメントで十分にサポートされています。</span><span class="sxs-lookup"><span data-stu-id="a4582-181">Setting up geo-replication is manual, but it's a first-class feature of the service and well supported by documentation.</span></span>
* <span data-ttu-id="a4582-182">**Cosmos DB** はグローバル分散データベース システムであり、レプリケーションはその実装の中核となります。</span><span class="sxs-lookup"><span data-stu-id="a4582-182">**Cosmos DB** is a globally distributed database system, and replication is central to its implementation.</span></span> <span data-ttu-id="a4582-183">Azure Cosmos DB では、レプリケーションを直接構成するのではなく、パーティション分割とデータの整合性に関するオプションを構成します。</span><span class="sxs-lookup"><span data-stu-id="a4582-183">With Azure Cosmos DB, instead of configuring replication directly, you configure options related to partitioning and data consistency.</span></span>

<span data-ttu-id="a4582-184">データの整合性、パフォーマンス、およびコストに異なる優先順位を付ける、さまざまなレプリケーション設計が存在します。</span><span class="sxs-lookup"><span data-stu-id="a4582-184">Many different replication designs exist that place different priorities on data consistency, performance, and cost.</span></span> <span data-ttu-id="a4582-185">*アクティブ* レプリケーションでは、複数のレプリカで同時に更新を行う必要があり、スループットの代償として整合性が保証されます。</span><span class="sxs-lookup"><span data-stu-id="a4582-185">*Active* replication requires updates to take place on multiple replicas simultaneously, guaranteeing consistency at the cost of throughput.</span></span> <span data-ttu-id="a4582-186">一方、*パッシブ* レプリケーションではバックグラウンドで同期が行われるので、レプリケーションによってアプリケーションのパフォーマンスが制約されることはありませんが、RPO は増加します。</span><span class="sxs-lookup"><span data-stu-id="a4582-186">In contrast, *passive* replication performs synchronization in the background, removing replication as a constraint on application performance, but increasing RPO.</span></span> <span data-ttu-id="a4582-187">*アクティブ/アクティブ*または*マルチマスター* レプリケーションでは、複数のレプリカの同時使用を可能にすることで負荷分散を実現しますが、その代償としてデータ整合性が複雑になります。一方、*アクティブ/パッシブ* レプリケーションでは、フェールオーバー中のみのライブ使用のためにレプリカを予約します。</span><span class="sxs-lookup"><span data-stu-id="a4582-187">*Active-active* or *multi-master* replication enables multiple replicas to be used simultaneously, enabling load balancing at the cost of complicating data consistency, while *active-passive* replication reserves replicas for live use only during failover.</span></span>

![地理的レプリケーションの例を示す図。](../media/geo-replication.png)

> [!IMPORTANT]
> <span data-ttu-id="a4582-190">**レプリケーションもバックアップも、単独では完全なディザスター リカバリー ソリューションではありません**。</span><span class="sxs-lookup"><span data-stu-id="a4582-190">**Neither replication nor backup are complete disaster recovery solutions on their own**.</span></span> <span data-ttu-id="a4582-191">データの回復はディザスター リカバリーの一部でしかなく、レプリケーションは多くの種類のディザスター リカバリーのシナリオを完全に満たすものではありません。</span><span class="sxs-lookup"><span data-stu-id="a4582-191">Data recovery is only one component of disaster recovery, and replication will not fully satisfy many kinds of disaster recovery scenarios.</span></span> <span data-ttu-id="a4582-192">たとえば、データ破損のシナリオでは、破損の性質によっては、プライマリ データ ストアからレプリカに破損が広がり、すべてのレプリカが役に立たなくなって復旧用のバックアップが必要になる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="a4582-192">For example, in a data corruption scenario, the nature of the corruption may allow it to spread from the primary data store to the replicas, rendering all the replicas useless and requiring a backup for recovery.</span></span>

### <a name="process-recovery"></a><span data-ttu-id="a4582-193">プロセスの回復</span><span class="sxs-lookup"><span data-stu-id="a4582-193">Process recovery</span></span>

<span data-ttu-id="a4582-194">災害発生後、復旧が必要な資産はビジネス データだけではありません。</span><span class="sxs-lookup"><span data-stu-id="a4582-194">After a disaster, business data isn't the only asset that needs recovering.</span></span> <span data-ttu-id="a4582-195">災害のシナリオでは、ネットワーク接続の問題、データセンターの障害、VM インスタンスまたはソフトウェア デプロイに関する損害など、原因はさまざまですが、結果的にダウンタイムも発生するのが一般的です。</span><span class="sxs-lookup"><span data-stu-id="a4582-195">Disaster scenarios will also commonly result in downtime, whether it's due to network connectivity problems, datacenter outages, or damaged VM instances or software deployments.</span></span> <span data-ttu-id="a4582-196">稼働状態に復元できるようにアプリケーションを設計する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a4582-196">The design of your application needs to enable you to restore it to a working state.</span></span>

<span data-ttu-id="a4582-197">ほとんどの場合、プロセスの復元は、稼働している別のデプロイへのフェールオーバーを伴います。</span><span class="sxs-lookup"><span data-stu-id="a4582-197">In most cases, process restoration involves failover to a separate, working deployment.</span></span> <span data-ttu-id="a4582-198">シナリオによっては、地理的位置が重要な側面になる場合があります。</span><span class="sxs-lookup"><span data-stu-id="a4582-198">Depending on the scenario, geographic location may be a critical aspect.</span></span> <span data-ttu-id="a4582-199">たとえば、大規模自然災害によって Azure リージョン全体がオフラインになった場合、別のリージョンにサービスを復元する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a4582-199">For example, a large-scale natural disaster that brings an entire Azure region offline will necessitate restoring service in another region.</span></span> <span data-ttu-id="a4582-200">アプリケーションのディザスター リカバリー要件 (特に RTO) によって、設計の方向性が決まります。この要件は、レプリケート先の環境をいくつ用意するのか、どの地域に環境を置くのか、すぐに稼働できる状態で環境を維持するのか、それとも災害発生時にデプロイを受け入れる準備をしておく必要があるかを判断するのに役立ちます。</span><span class="sxs-lookup"><span data-stu-id="a4582-200">Your application's disaster recovery requirements, especially RTO, should drive your design and help you decide how many replicated environments you should have, where they should be located, and whether they should be maintained in a ready-to-run state or should be ready to accept a deployment in the event of disaster.</span></span>

<span data-ttu-id="a4582-201">アプリケーションの設計によっては、災害後のプロセスの回復に対するアプリのサポートを向上させるために利用できる、何種類かの戦略と Azure のサービスおよび機能が存在します。</span><span class="sxs-lookup"><span data-stu-id="a4582-201">Depending on the design of your application, there are a few different strategies and Azure services and features that you can take advantage of to improve your app's support for process recovery after a disaster.</span></span>

#### <a name="azure-site-recovery"></a><span data-ttu-id="a4582-202">Azure Site Recovery</span><span class="sxs-lookup"><span data-stu-id="a4582-202">Azure Site Recovery</span></span>

<span data-ttu-id="a4582-203">Azure Site Recovery は、Azure にデプロイされた VM 上で動作するワークロード、物理サーバー上で動作する VM、および物理サーバー上で直接動作するワークロードのプロセスの回復の管理に特化したサービスです。</span><span class="sxs-lookup"><span data-stu-id="a4582-203">Azure Site Recovery is a service that's dedicated to managing process recovery for workloads running on VMs deployed to Azure, VMs running on physical servers, and workloads running directly on physical servers.</span></span> <span data-ttu-id="a4582-204">Site Recovery ではワークロードが別の場所にレプリケートされ、障害発生時にフェールオーバーするのに役立ち、ディザスター リカバリー プランのテストがサポートされます。</span><span class="sxs-lookup"><span data-stu-id="a4582-204">Site Recovery replicates workloads to alternate locations and helps you to failover when an outage occurs and supports testing of a disaster recovery plan.</span></span>

![米国東部から米国西部に位置する 3 つの仮想マシンのワークロードをレプリケートする Azure Site Recovery の役割を示す図。](../media/asr.png)

<span data-ttu-id="a4582-206">Site Recovery では、個々の*ワークロード*だけでなく、VM および物理サーバー イメージ全体のレプリケーションがサポートされます。このワークロードは、個々のアプリケーションを指す場合もあれば、VM またはオペレーティング システムとそのアプリケーションの全体を指す場合もあります。</span><span class="sxs-lookup"><span data-stu-id="a4582-206">Site Recovery supports replicating whole VMs and physical server images as well as individual *workloads*, where a workload may be an individual application or an entire VM or operating system with its applications.</span></span> <span data-ttu-id="a4582-207">任意のアプリケーション ワークロードをレプリケートできますが、Site Recovery の優れた点は、SQL Server や SharePoint などの多くの Microsoft サーバー アプリケーション、および SAP のような一部のサード パーティ製アプリケーションの統合サポートが提供されることです。</span><span class="sxs-lookup"><span data-stu-id="a4582-207">Any application workload can be replicated, but Site Recovery has first-class integrated support for many Microsoft server applications, such as SQL Server and SharePoint, as well as a handful of third-party applications like SAP.</span></span>

<span data-ttu-id="a4582-208">VM または物理サーバー上で実行されるアプリについては、少なくとも Azure Site Recovery の使用を検討することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="a4582-208">Any app that runs on VMs or physical servers should at least investigate the use of Azure Site Recovery.</span></span> <span data-ttu-id="a4582-209">これは、プロセスの回復のシナリオと可能性を発見および追求するための優れた方法です。</span><span class="sxs-lookup"><span data-stu-id="a4582-209">It's a great way to discover and explore scenarios and possibilities for process recovery.</span></span>

#### <a name="service-specific-features"></a><span data-ttu-id="a4582-210">サービス固有の機能</span><span class="sxs-lookup"><span data-stu-id="a4582-210">Service-specific features</span></span>

<span data-ttu-id="a4582-211">App Service のような Azure PaaS 型サービスで実行されるアプリについては、ディザスター リカバリーをサポートするための機能およびガイダンスがほとんどのサービスで提供されます。</span><span class="sxs-lookup"><span data-stu-id="a4582-211">For apps that run on Azure PaaS offerings like App Service, most such services offer features and guidance for supporting disaster recovery.</span></span> <span data-ttu-id="a4582-212">特定のシナリオでは、サービス固有の機能を使用して高速回復がサポートされます。</span><span class="sxs-lookup"><span data-stu-id="a4582-212">For certain scenarios, you can use service-specific features to support fast recovery.</span></span> <span data-ttu-id="a4582-213">たとえば、Azure SQL Server では、別のリージョンにサービスを迅速に復元するための geo レプリケーションがサポートされます。</span><span class="sxs-lookup"><span data-stu-id="a4582-213">For example, Azure SQL Server supports geo-replication for quickly restoring service in another region.</span></span> <span data-ttu-id="a4582-214">Azure App Service にはバックアップと復元の機能があり、ドキュメントには、Azure Traffic Manager を使用してセカンダリ リージョンにトラフィックをルーティングするためのガイダンスが含まれています。</span><span class="sxs-lookup"><span data-stu-id="a4582-214">Azure App Service has a Backup and Restore feature, and the documentation includes guidance for using Azure Traffic Manager to support routing traffic to a secondary region.</span></span>

![個々のデータセンターからなる地理内のリージョン ペアを示す図。](../media/AzRegionPairs.png)

## <a name="testing-a-disaster-recovery-plan"></a><span data-ttu-id="a4582-216">ディザスター リカバリー プランのテスト</span><span class="sxs-lookup"><span data-stu-id="a4582-216">Testing a disaster recovery plan</span></span>

<span data-ttu-id="a4582-217">ディザスター リカバリーの計画は、プランを完成させたら終わりというわけではありません。</span><span class="sxs-lookup"><span data-stu-id="a4582-217">Disaster recovery planning doesn't end once you have a completed plan in hand.</span></span> <span data-ttu-id="a4582-218">プランをテストすることは、指示や説明が明確かつ最新であることを確認するためのディザスター リカバリーの重要な側面です。</span><span class="sxs-lookup"><span data-stu-id="a4582-218">Testing the plan is a crucial aspect of disaster recovery, to ensure that the directions and explanations are clear and up-to-date.</span></span>

<span data-ttu-id="a4582-219">バックアップおよびフェールオーバーのメカニズムの毎月のテストや、完全なディザスター リカバリー シミュレーションの 6 か月ごとの実行など、さまざまな種類と範囲のテストを実行する間隔を選択します。</span><span class="sxs-lookup"><span data-stu-id="a4582-219">Choose intervals to perform different types and scopes of tests, such as testing backups and failover mechanisms every month, and performing a full-scale disaster recovery simulation every six months.</span></span> <span data-ttu-id="a4582-220">常に、プランに記述されているとおりの手順および詳細に従ってください。また、プランにあまり詳しくない人には、内容をより明確にするための見方を示すことを検討してください。</span><span class="sxs-lookup"><span data-stu-id="a4582-220">Always follow the steps and details exactly as they're documented in the plan, and consider having someone unfamiliar with the plan give perspective on anything that could be made clearer.</span></span> <span data-ttu-id="a4582-221">テストの実行時に、食い違い、改善できる領域、および自動化できる場所を特定し、それらをプランに追加します。</span><span class="sxs-lookup"><span data-stu-id="a4582-221">As you execute the test, identify gaps, areas of improvement, and places to automate and add these enhancements to your plan.</span></span>

<span data-ttu-id="a4582-222">必ず、独自の監視システムもテストに含めてください。</span><span class="sxs-lookup"><span data-stu-id="a4582-222">Make sure to include your monitoring system in your testing as well.</span></span> <span data-ttu-id="a4582-223">たとえば、アプリケーションで自動フェールオーバーをサポートしている場合、依存関係またはその他の重要なコンポーネントで障害を発生させて、アプリケーションが完全に正しく動作することを確認します。たとえば、自動フェールオーバーの失敗やトリガーが検出されることを確認します。</span><span class="sxs-lookup"><span data-stu-id="a4582-223">For example, if your application supports automated failover, introduce failures in a dependency or other critical component to ensure that the application behaves correctly end-to-end, including detection of the failure and triggering of the automated failover.</span></span>

 <span data-ttu-id="a4582-224">慎重に要件を識別してプランを作成することによって、回復の目標を達成するためにはどのような種類のサービスを使用する必要があるかを判断できます。</span><span class="sxs-lookup"><span data-stu-id="a4582-224">By carefully identifying your requirements and laying out a plan, you'll be able to determine what types of services you'll need to use to meet your recovery objectives.</span></span> <span data-ttu-id="a4582-225">Azure では、これらの目標を達成するのに役立つ、さまざまなサービスや機能が提供されます。</span><span class="sxs-lookup"><span data-stu-id="a4582-225">Azure provides several services and features to help you meet these objectives.</span></span>
