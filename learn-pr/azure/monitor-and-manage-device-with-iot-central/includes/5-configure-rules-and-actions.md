ここまでで、コーヒー マシンを Azure IoT Central アプリケーションに接続し、コーヒー マシンを監視して管理できるようにするデータの交換を有効にしました。 このユニットでは、コーヒー マシンの水温が正常な範囲を超えたときにアクションをトリガーするルールを作成します。 

## <a name="create-rules-in-iot-central-with-email-as-the-action"></a>電子メールをアクションとして IoT Central でルールを作成する

Azure IoT Central には、通知を送信するネイティブなメール機能があります。 このシナリオでは、コーヒー マシンが最適温度の範囲外にあり、保証で保護されていない場合、IoT Central によってクライアントのメンテナンス部門にメールが送信されます。

1. このユニットの演習では **[ルール]** ページに移動し、右側の **[テンプレートの編集]** を選択して編集モードにします。 
1. **[+ 新しいルール]**、**[テレメトリ]** の順に選択します。 

1. 「`Coffee Maker Water Too Cold (Expired)`」という名前を入力します。

1. **[条件]** の右側にある正符号 (**+**) を選択してルールに次の条件を追加し、**[保存]** をクリックします。      
    - 水温がコーヒー メーカーの最低温度未満である
    - デバイスの保証期限切れは 1 に等しい

    ![ルールの使用](../media/5-flow-a.png)

1. **[Configure Telemetry Rule]\(テレメトリ ルールの構成\)** パネルで下にスクロールし、**[アクション]** の横にある **[+]** を選択してから **[メール]** を選びます。

1. IoT Central アプリケーションへのサインインに使用したメール アドレスを入力し、「`Coffee maker's water is too cold. Maintenance is required.  Warranty has expired.`」という注釈を追加します。

1. **[保存]** を選択します。 使用するルールが **[ルール]** ページにリストされます。

水が熱すぎる場合は、以下の手順を繰り返します。 

1. **[+ 新しいルール]**、**[テレメトリ]** の順に選択します。

1. 新しいルールを追加して、`Coffee Maker Water Too Hot (Expired)` という名前を付けます。

1. **[条件]** の右側にある正符号 (**+**) を選択してルールに次の条件を追加し、**[保存]** をクリックします。      
    - 水温がコーヒー メーカーの最高温度を超えている
    - デバイスの保証期限切れは 1 に等しい

1. **[Configure Telemetry Rule]\(テレメトリ ルールの構成\)** パネルで下にスクロールし、**[アクション]** の横にある **[+]** を選択してから **[メール]** を選びます。

1. IoT Central アプリケーションへのサインインに使用したメール アドレスを入力し、「`Coffee maker's water is too cold. Maintenance is required.  Warranty has expired.`」という注釈を追加します。

1. **[保存]** を選択します。 使用するルールが **[ルール]** ページに一覧表示されます。

ルールをトリガーするには、**[設定]** の最適温度を、**[プロパティ]** で指定した範囲から外れた値に設定します。 検証が終わったら、受信トレイがメールであふれないようにルールを無効にします。