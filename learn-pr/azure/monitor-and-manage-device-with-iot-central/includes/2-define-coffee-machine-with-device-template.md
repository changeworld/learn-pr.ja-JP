Azure IoT Central では、アプリケーションとデバイスを交換できるデータは動作と、デバイスの機能を定義するデバイス テンプレートで、またはこの場合、コーヒー マシンに指定されました。 デバイス テンプレートを作成すると、シミュレートされたデバイスがテンプレートから生成されます。 シミュレートされたデバイスには、テレメトリ、または real の物理デバイスを接続する前に、アプリケーションの動作をテストすることができますが生成されます。 

このユニットでは、次の機能と動作を指定するコーヒー マシン用のデバイス テンプレートを作成します。
* **測定**: デバイスから取得したデータ。 デバイスの機能と一致するように、複数の測定値をデバイス テンプレートに追加できます。
    * 遠隔測定: 数値データ ポイント、デバイスは、時間の経過と共に収集します。 連続するストリームとして表されます。 このシナリオで、テレメトリの測定値は空気湿度、水の温度 

    * 測定の状態: デバイスまたは時間の期間にわたってそのコンポーネントの状態。 このシナリオで Cup 検出/Cup が検出されない強み、Brewing かどうかを考えてとして状態を設定します。

* **設定**: 設定を使用して、アプリケーションからデバイスに構成データを送信します。 このシナリオでは、設定で最適な水の温度を調整し、コーヒー マシンに送信します。 保留中とマークされている設定が更新されたときに、デバイスが、設定の変更に応答したことを認識するまで、UI にします。

* **プロパティ**: デバイスに関連付けられているデバイスのメタデータ。 2 種類のプロパティがあります。
    * 使用する*アプリケーション プロパティ*アプリケーションで、デバイスに関する情報を記録します。 このシナリオでは、コーヒー マシンの理想的な水の温度の範囲を設定するのにアプリケーション プロパティを使用します。 アプリケーションのプロパティは、アプリケーションでは保存され、デバイスと同期されません。 

    * "*デバイス プロパティ*" は、デバイスがプロパティ値をアプリケーションに送信できるようにするために使用します。 これらのプロパティは、デバイスのみが変更できます。 このシナリオでは、IoT Central でデバイスの保証期間が切れたと呼ばれるデバイスのプロパティを構成します。 IoT Central にコーヒー マシンが接続されるまで、デバイスの保証期間が切れたフィールドは空のままです。 接続されると、コーヒー マシン保証の状況をアプリケーションに送信します。 

* **コマンド**: コマンドを使用して、アプリケーションからデバイスをリモートで管理します。 クラウドから直接デバイス上でコマンドを実行して、デバイスを制御できます。 このシナリオでは、メンテナンスを設定または準備コーヒー マシン上のコマンドを実行します。 

## <a name="create-a-device-template-for-the-coffee-maker"></a>コーヒー メーカーのデバイス テンプレートを作成する
デバイス テンプレートでは、動作、またはこの場合は、コーヒー メーカーで、デバイスの機能を定義します。

1. ホーム ページに移動し、選択**デバイス テンプレートの作成**です。

1. 入力*コーヒー メーカーの接続されている*カスタム デバイス テンプレートの。 
 
1. **[作成]** を選択します。 動作と、マシンの機能を定義する、コーヒー メーカーの空白のデバイス テンプレートを作成しました。 

## <a name="define-telemetry-measurement-temperature-and-humidity"></a>テレメトリ測定の温度と湿度を定義する
1.  **Connected Coffee Maker** デバイス テンプレートで、テレメトリを定義する **[測定]** ページを表示していることを確認します。 

1.  温度テレメトリを追加する **+ 新しい測定**します。 クリックして**テレメトリ**測定値の型として。

1.  デバイス テンプレートに対して定義するテレメトリの各種類には、次のような構成オプションがあります。
    * 表示オプション。
    * テレメトリの詳細。
    * シミュレーションのパラメーター。

    で、温度と湿度のテレメトリを構成するには、次の表に情報を使用します。 テレメトリ項目を作成するときに選択して新しい測定値を追加する必要があります。 **+ 新しい測定**テーブル内の各項目にします。
    
    |表示名|フィールド名|単位|最小|最大|小数点以下の桁数|
    |---|---|---|---|---|---|
    |水温|waterTemperature|摂氏|86|100|1|
    |湿度|airHumidity|%|20|100|0|
   
    テレメトリの表示色を選択することもできます。 製品利用統計情報の定義を保存する**保存**します。 残りの単位で測定値、設定、プロパティ、およびコマンドの詳細についての定義を作成するには、完了するたびを保存してください。  
    
    ![デバイス テンプレートを作成する](../images/2-device-template-a.png)

    デバイス テンプレートでの表に示すとおり、フィールド名を入力します。 フィールド名に対応するデバイス コードのプロパティ名が一致しない場合は、アプリケーションのテレメトリを表示できません。 設定およびプロパティ情報を入力するときに同じようにします。 

## <a name="define-state-measurement-for-brewingnot-brewing-cup-detectedcup-not-detected"></a>状態測定 (抽出している/抽出していない、カップあり/カップなし) を定義する
次の状態を追加、**測定**を選択してページ **+ 新しい測定**します。 次に、測定の種類として **[状態]** を選択します。
    
   |表示名|フィールド名|値 1|表示名 1|値 2|表示名 2|
   |---|---|---|---|---|---|
   |抽出している|stateBrewing|true|抽出している|false|抽出していない|
   |カップあり|stateCupDetected|true|カップあり|false|カップなし|


状態に > true として値を追加するページを抽出します。 クリックして、強みを考えていないとして false オプションの表示名としてその他の値を追加**+** 横に**値**します。

> [!NOTE]
> 製品利用統計情報と状態を定義した後、デバイスの画面上のデバイス テンプレートから生成された、シミュレートされたデータを参照してください。 シミュレートされたデータでは、IoT Central への物理デバイスを接続する前に、アプリケーションの動作をテストすることができます。 

## <a name="use-settings-to-set-the-optimal-temperature-of-the-coffee-machine"></a>[設定] を使用してコーヒー メーカーの適温を設定する
設定ページで、測定値の横にあるタブに移動します。 **[デザイン モード]** をオンにします。 次の追加**数**設定**ライブラリ**上、**設定**ページ。

|表示名|フィールド名|単位|小数点|最小|最大|初期|
|---|---|---|---|---|---|---|---|
|適温|setTemperature|摂氏|1|86|100|95|

## <a name="use-properties-to-store-warranty-info-and-water-temperature-range"></a>[プロパティ] を使用して保証情報と水温範囲を格納する

次の追加**数**プロパティを**プロパティ**を最初に有効にしてページ**デザイン モード**:

|表示名|フィールド名|単位|小数点以下の桁数|最小|最大|初期
|---|---|---|---|---|---|---|
|コーヒー メーカー最低温度|propertyMinTemperature|摂氏|1|88|92|90|
|コーヒー メーカー最高温度|propertyMaxTemperature|摂氏|1|96|99|98| 

**[プロパティ]** ページで次の**デバイス プロパティ**を追加します。

   |表示名|フィールド名|データ型|
   |---|---|---|
   |デバイスの保証期限切れ|propertyWarrantyExpired|number|

> [!NOTE]
> デバイス プロパティがデバイス (ここではコーヒー メーカー) によって送信されます。 いったんコーヒー メーカーを Azure IoT Central に接続すると、デバイスの保証期限プロパティがアプリケーションに送信され、[デバイスの保証期限切れ] フィールドに表示されます。 

## <a name="use-commands-to-set-maintenance-mode-and-start-brewing"></a>コマンドを使用してメンテナンス モードを設定し抽出を開始する

最初に **[デザイン モード]** を有効にして、**[コマンド]** ページで次のコマンドを追加します。

|表示名|フィールド名|[Default Timeout]\(既定のタイムアウト\)|データ型|
|---|---|---|---|---|---|---|
|メンテナンス モードを設定します。|cmdSetMaintenance|30|text| 
|抽出開始|cmdStartBrewing|30|text|

## <a name="summary"></a>まとめ

このユニットで、新しいデバイスの種類、コーヒー マシンでは、デバイスのテンプレートを使用して作成しました。 デバイス テンプレートで、アプリケーションでコーヒー マシンを交換するデータを指定します。 水温と湿度のようなテレメトリと、コーヒーを抽出中かどうかといった状態を定義しました。 設定、プロパティ、およびコマンドを構成することで、動作やコーヒー マシンの機能を定義さらにします。 

