オンプレミスの PostgreSQL データベースを使用するいると仮定します。 セキュリティのあらゆる面を管理しているし、標準的な PostgreSQL サーバー レベルのファイアウォール規則を使用して、サーバーにすべてのアクセスをロックしました。 Azure で同じサーバー レベルのファイアウォール規則を構成する方法の理解があるようになりました。

以前の Azure Database for PostgreSQL サーバーを使用して作成するのいずれかに接続する可能性があるようになりました`psql`します。

## <a name="allow-azure-service-access"></a>Azure サービスへのアクセスを許可します。

始める前に、PowerShell を使用する場合は、Azure サービスへのアクセスを許可する必要がありますと`psql`サーバーに接続します。 2 つの方法でアクセスを許可できることを思い出してください。

最初の選択肢が有効にするには**Azure サービスへのアクセスを許可する**します。 アクセスを許可する場合は、ルールが作成したカスタムの規則の一覧で入力されていない場合でも、ファイアウォール規則が作成されます。

2 番目のオプションでは、すべての IP アドレスへのアクセスを許可するファイアウォール ルールを作成します。 このルールには実行に使用する PowerShell を実行しているクライアントの IP アドレスが含まれます`psql`から。

無効にする必要も、**強制 SSL 接続**オプション。

始めましょう。

[Azure portal](https://portal.azure.com?azure-portal=true) にサインインします。 ファイアウォール規則を作成するサーバー リソースに移動します。

選択、**接続のセキュリティ**オプション、右側に接続のセキュリティ ブレードを開きます。

![PostgreSQL データベースのリソース ブレードの接続のセキュリティ セクションを示す Azure portal のスクリーン ショット](../media-draft/7-db-security-settings.png)

PowerShell を実行するクライアントへのアクセスを許可することを思い出してください`psql`します。

いずれかを選択できます。

- 設定**Azure サービスへのアクセスを許可する**に**ON**
- 設定**強制 SSL 接続**に**無効になっています。**
- をクリックして、**保存**変更を保存するボタンをクリックします。

または、ファイアウォール規則を追加することですべての IP アドレスへのアクセスを許可するファイアウォール ルールを追加することができます。 次の値を使用します。

- ルール名: `AllowAll`
- 開始 IP: `0.0.0.0`
- 終了 IP: `255.255.255.255`
- 設定**強制 SSL 接続**に**無効になっています。**
- をクリックして、**保存**変更を保存するボタンをクリックします。

> [!Warning]
> このファイアウォール規則を作成、サーバーに接続しようとしています。 インターネット経由で任意の IP アドレスを許可します。 場合でも、クライアントはアクセスできません、サーバー ユーザー名とパスワードを使わずにできません、慎重にこの規則を有効にし、セキュリティへの影響を理解するかどうかを確認します。 運用環境では、特定のクライアント IP アドレスへのアクセスのみ許可します。

Azure Cloud Shell で psql を次のコマンドを使用して、サーバーに接続します。

```bash
psql --host=<server-name>.postgres.database.azure.com --username=<admin-user>@<server-name> --dbname=postgres
```

リコール、 `server-name`、および`admin-user`は、サーバーの作成時に、管理者アカウントの選択した値になります。 `postgres` 既定の管理データベースは、すべての PostgreSQL でサーバーを作成します。 サーバーの作成時に指定したパスワードを求めるメッセージが表示されます。

正常に接続すると、実行、`\l`すべてのデータベースを一覧表示するコマンド。 このコマンドは、返される 2 つ以上の既定データベースになります。

サーバー上の psql の操作の実行が完了したら、コマンドを実行`\q`を終了する`psql`します。

最後に、Cloud Shell を終了するコマンドを実行`exit`します。
