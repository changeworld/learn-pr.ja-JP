<span data-ttu-id="4c792-101">＠eコマース シナリオで優れたユーザー エクスペリエンスを確保するには、高可用性と＠短い遅延時間が必要です。</span><span class="sxs-lookup"><span data-stu-id="4c792-101">Assuring a great user experience in an e-commerce scenario such as yours requires high availability and low latency.</span></span>

<span data-ttu-id="4c792-102">先ほど作成した Azure Cosmos DB アカウントでマルチマスター サポートを有効にすることで、これらのパフォーマンスの＠側面の両方で複数の利点が得られます。利点の多くは、Azure Cosmos DB で提供される財務的に裏付けされたサービス レベル アグリーメント (SLA) によって保証されます。</span><span class="sxs-lookup"><span data-stu-id="4c792-102">By enabling multi-master support on the Azure Cosmos DB account you just created, there are multiple benefits to both of these performance aspects, and all of the benefits are guaranteed by the financially backed service level agreements (SLAs) provided by Azure Cosmos DB.</span></span>

## <a name="what-is-multi-master-support"></a><span data-ttu-id="4c792-103">マルチマスター サポートとは</span><span class="sxs-lookup"><span data-stu-id="4c792-103">What is multi-master support?</span></span>

<span data-ttu-id="4c792-104">マルチ マスター サポートは、新しい Azure Cosmos DB アカウントで有効にできるオプションです。</span><span class="sxs-lookup"><span data-stu-id="4c792-104">Multi-master support is an option that can be enabled on new Azure Cosmos DB accounts.</span></span> <span data-ttu-id="4c792-105">アカウントが複数のリージョンでレプリケートされると、＠各リージョンがマスター リージョンとなり、write-anywhere モデル (アクティブ/アクティブ パターンともいう) に同等に関与します。</span><span class="sxs-lookup"><span data-stu-id="4c792-105">Once the account is replicated in multiple regions, each region is a master region that equally participates in a write-anywhere model, also known as an active-active pattern.</span></span>

<span data-ttu-id="4c792-106">マルチマスター構成でマスター リージョンとして稼働する Azure Cosmos DB リージョンは、すべてのレプリカに＠書き込まれているデータを集約し、グローバルな整合性とデータ整合性を確保するために自動的に動作します。</span><span class="sxs-lookup"><span data-stu-id="4c792-106">Azure Cosmos DB regions operating as master regions in a multi-master configuration automatically work to converge data written to all replicas and ensure global consistency and data integrity.</span></span>

<span data-ttu-id="4c792-107">Azure Cosmos DB のマルチマスター サポートを＠利用することで、世界中の ＠write-enabled リージョン内のコンテナーに対する書き込みを行うことができます。</span><span class="sxs-lookup"><span data-stu-id="4c792-107">With Azure Cosmos DB multi-master support, you can perform writes on any container in a write-enabled region world-wide.</span></span> <span data-ttu-id="4c792-108">書き込まれたデータはすぐにその他のすべてのリージョンに＠反映されます。</span><span class="sxs-lookup"><span data-stu-id="4c792-108">Written data is propagated to all other regions immediately.</span></span>  

## <a name="what-are-the-benefits-of-multi-master-support"></a><span data-ttu-id="4c792-109">マルチマスター サポートの利点とは</span><span class="sxs-lookup"><span data-stu-id="4c792-109">What are the benefits of multi-master support?</span></span>

<span data-ttu-id="4c792-110">マルチマスター サポートの利点は次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="4c792-110">The benefits of multi-master support are:</span></span>

* <span data-ttu-id="4c792-111">1 ＠桁の書き込み待機時間 – マルチ マスター アカウントでは書き込み待機時間が改善され、99 % の書き込みに対して 10 ミリ秒未満となりました。マルチ マスター以外のアカウントの場合は 15 ミリ秒未満です。</span><span class="sxs-lookup"><span data-stu-id="4c792-111">Single-digit write latency – Multi-master accounts have an improved write latency of <10 ms for 99% of writes, up from <15 ms for non-multi-master accounts.</span></span>
* <span data-ttu-id="4c792-112">99.999% の読み取り＠/書き込み可用性 - マルチマスター アカウントでは書き込み可用性が改善され、99.999% に改善されました。マルチ マスター以外のアカウントの場合は 99.99% です。</span><span class="sxs-lookup"><span data-stu-id="4c792-112">99.999% read-write availability - The write availability multi-master accounts increases to 99.999%, up from the 99.99% for non-multi-master accounts.</span></span>
* <span data-ttu-id="4c792-113">無制限の書き込みスケーラビリティとスループット – マルチ マスター アカウントではすべてのリージョンに書き込むことができ、＠数百万ものデバイスをサポートするために無制限の書き込みスケーラビリティとスループットが提供されます。</span><span class="sxs-lookup"><span data-stu-id="4c792-113">Unlimited write scalability and throughput – With multi-master accounts, you can write to every region, providing unlimited write scalability and throughput to support billions of devices.</span></span>
* <span data-ttu-id="4c792-114">組み込み競合解決 - マルチマスター アカウントには、＠グローバル データ統合と一貫性を確保するために競合解決用の 3 つの方法が用意されています。</span><span class="sxs-lookup"><span data-stu-id="4c792-114">Built-in conflict resolution – Multi-master accounts have three methods for resolving conflicts to ensure global data integrity and consistency.</span></span> 

## <a name="conflict-resolution"></a><span data-ttu-id="4c792-115">競合の解決</span><span class="sxs-lookup"><span data-stu-id="4c792-115">Conflict resolution</span></span>

<span data-ttu-id="4c792-116">マルチ マスター サポートでは、＠さまざまなリージョンへの書き込みに関する競合が発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="4c792-116">With the addition of multi-master support comes the possibility of encountering conflicts for writes to different regions.</span></span> <span data-ttu-id="4c792-117">競合は Azure Cosmos DB では非常にまれなことであり、リージョン間で＠反映される前に複数のリージョンでアイテムが同時に変更されたときにのみ発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="4c792-117">Conflicts are extremely rare in Azure Cosmos DB and can only occur when an item is simultaneously changed in multiple regions, before propagation between the regions has happened.</span></span> <span data-ttu-id="4c792-118">たとえば、レプリケーションがグローバルに発生する＠速度の場合、これはめったに発生しません。</span><span class="sxs-lookup"><span data-stu-id="4c792-118">Given the speed with which replication happens globally, you should not experience this often, if at all.</span></span> <span data-ttu-id="4c792-119">＠しかし、Azure Cosmos DB には競合解決モードが用意されており、ユーザーは、同じレコードが 2 つ以上のリージョンで異なる作成者によって同時に更新されるシナリオを処理する方法を決定することができます。</span><span class="sxs-lookup"><span data-stu-id="4c792-119">However, Azure Cosmos DB does provide conflict resolution modes that allows users to decide how to handle scenarios where the same record is updated simultaneously by different writers in two or more regions.</span></span>  

<span data-ttu-id="4c792-120">＠Azure Cosmos DB では、3 つの競合解決モードが提供されます。</span><span class="sxs-lookup"><span data-stu-id="4c792-120">There are three conflict resolution modes offered by Azure Cosmos DB.</span></span> 
* <span data-ttu-id="4c792-121">**＠Last-Writer-Wins (LWW)**: ドキュメント内のユーザー定義の整数プロパティの値に基づいて、競合が解決されます。</span><span class="sxs-lookup"><span data-stu-id="4c792-121">**Last-Writer-Wins (LWW)**, in which conflicts are resolved based on the value of a user-defined integer property in the document.</span></span> <span data-ttu-id="4c792-122">既定では、最後に書き込まれたドキュメントを判別するために _ts が使用されます。</span><span class="sxs-lookup"><span data-stu-id="4c792-122">By default _ts is used to determine the last written document.</span></span> <span data-ttu-id="4c792-123">Last-Writer-Wins は、既定の競合処理メカニズムです。</span><span class="sxs-lookup"><span data-stu-id="4c792-123">Last-Writer-Wins is the default conflict handling mechanism.</span></span>
* <span data-ttu-id="4c792-124">**カスタム - ユーザー定義＠プロシージャ**: コレクションにユーザー定義プロシージャを登録することで、競合解決を完全に制御できます。</span><span class="sxs-lookup"><span data-stu-id="4c792-124">**Custom - User Defined Procedure**, in which you can fully control conflict resolution by registering a User Defined Procedure to the collection.</span></span> <span data-ttu-id="4c792-125">ユーザー定義プロシージャは、＠非常に特殊な署名による特殊な種類のストアド プロシージャです。</span><span class="sxs-lookup"><span data-stu-id="4c792-125">A User Defined Procedure is a special type of stored procedure with a very specific signature.</span></span> <span data-ttu-id="4c792-126">ユーザー定義プロシージャが＠失敗したか、存在しない場合、Azure Cosmos DB によって、すべての競合が読み取り専用の競合フィードに追加され、非同期に処理することができます。</span><span class="sxs-lookup"><span data-stu-id="4c792-126">If the User Defined Procedure fails or does not exist, Azure Cosmos DB will add all conflicts into the read-only conflicts feed they can be processed asynchronously.</span></span>  
* <span data-ttu-id="4c792-127">**カスタム - 非同期**: Azure Cosmos DB によってすべての競合がコミット対象から除外され、ユーザーのアプリケーションによる＠遅延解決のために読み取り専用競合フィードに登録されます。</span><span class="sxs-lookup"><span data-stu-id="4c792-127">**Custom - Async**, in which Azure Cosmos DB excludes all conflicts from being committed and registers them in the read-only conflicts feed for deferred resolution by the user’s application.</span></span> <span data-ttu-id="4c792-128">アプリケーションでは非同期＠で競合解決を行い、任意のロジックを使用するか、任意の外グループソース、アプリケーションまたはサービスを参照して競合を解決することができます。</span><span class="sxs-lookup"><span data-stu-id="4c792-128">The application can perform conflict resolution asynchronously and use any logic or refer to any external source, application or service to resolve the conflict.</span></span>

## <a name="summary"></a><span data-ttu-id="4c792-129">まとめ</span><span class="sxs-lookup"><span data-stu-id="4c792-129">Summary</span></span>

<span data-ttu-id="4c792-130">このユニットでは、可用性とパフォーマンスを＠向上させるために複数のリージョンにデーアンセーフ コードを書き込むことができるマルチマスター アカウントについて学習しました。</span><span class="sxs-lookup"><span data-stu-id="4c792-130">In this unit, learned about multi-master accounts, which enable you to write data to multiple regions for improved availability and performance.</span></span>