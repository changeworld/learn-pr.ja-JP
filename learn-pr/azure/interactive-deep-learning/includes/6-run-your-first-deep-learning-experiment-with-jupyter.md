![PyTorch ロゴ](../media/5-image1.png) 

<span data-ttu-id="8062c-102">通常、ディープ ラーニングのエンジニアはマトリックス代数をすべて手動で実装することはありません。</span><span class="sxs-lookup"><span data-stu-id="8062c-102">Typically deep learning engineers don't implement the matrix algebra operations all by hand.</span></span> <span data-ttu-id="8062c-103">代わりに、PyTorch や TensorFlow などのフレームワークを使用します。</span><span class="sxs-lookup"><span data-stu-id="8062c-103">Instead, they use frameworks such as PyTorch or TensorFlow.</span></span>  

<span data-ttu-id="8062c-104">PyTorch は、ディープ ラーニングの開発プラットフォームとしての柔軟性を提供する Python ベースのフレームワークです。</span><span class="sxs-lookup"><span data-stu-id="8062c-104">PyTorch is a python-based framework that provides flexibility as a deep learning development platform.</span></span> <span data-ttu-id="8062c-105">それは、Python の科学技術コンピューティング ライブラリである NumPy 上に構築されています。</span><span class="sxs-lookup"><span data-stu-id="8062c-105">It's built on the Python scientific computing library, NumPy.</span></span> 

<span data-ttu-id="8062c-106">PyTorch をディープ ラーニング モデルの構築に使用するのはなぜでしょうか。</span><span class="sxs-lookup"><span data-stu-id="8062c-106">Now you might ask, why would we use PyTorch to build deep learning models?</span></span>  

- <span data-ttu-id="8062c-107">使いやすい API - Python の知識があれば、短時間で成果を得ることができます。</span><span class="sxs-lookup"><span data-stu-id="8062c-107">Easy to use API – If you know Python, you can ramp up quickly.</span></span>
- <span data-ttu-id="8062c-108">Python のサポート - PyTorch は、科学技術コンピューティング スタックとスムーズに統合されています。</span><span class="sxs-lookup"><span data-stu-id="8062c-108">Python support – PyTorch smoothly integrates with the scientific computing stack.</span></span>
- <span data-ttu-id="8062c-109">動的計算グラフ - 特定機能付きの事前に定義されたグラフではなく、PyTorch が実行時間内に変更可能な計算グラフを動的に作成します。</span><span class="sxs-lookup"><span data-stu-id="8062c-109">Dynamic computation graphs – Instead of predefined graphs with specific functionality, PyTorch builds computational graphs dynamically that can be modified during runtime.</span></span> <span data-ttu-id="8062c-110">動的計算グラフは、入れ子になったバッチ処理に有効で、特定のネットワークに必要とされるメモリの量が不明の場合に役立ちます。</span><span class="sxs-lookup"><span data-stu-id="8062c-110">Dynamic computation graphs are valuable for nested batching and when we do not know how much memory will be needed for creating a given network.</span></span>

<span data-ttu-id="8062c-111">PyTorch の詳細については、[PyTorch.org の公式ドキュメント](https://pytorch.org/about/)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="8062c-111">For more information about PyTorch, see [PyTorch.org official documentation](https://pytorch.org/about/).</span></span>

## <a name="run-your-first-pytorch-model"></a><span data-ttu-id="8062c-112">最初の PyTorch モデルを実行する</span><span class="sxs-lookup"><span data-stu-id="8062c-112">Run your first PyTorch model</span></span>

<span data-ttu-id="8062c-113">PyTorch イメージからプロビジョニングされた Docker コンテナーが用意できたので、実験を開始しましょう。</span><span class="sxs-lookup"><span data-stu-id="8062c-113">Now that you have a Docker container provisioned from a PyTorch image, it's time to experiment.</span></span> <span data-ttu-id="8062c-114">[python.org](https://python.org) から Notebook をダウンロードしたことを思い出してください。そのサンプル Notebook を使用して、イメージをさまざまなカテゴリに分類するネットワークのトレーニングについて説明します。</span><span class="sxs-lookup"><span data-stu-id="8062c-114">If you recall, we downloaded a notebook from [python.org](https://python.org). That sample notebook walks you through training a network to classify images  into different categories.</span></span> <span data-ttu-id="8062c-115">それは、ディープな畳み込みニューラル ネットワーク (CNN) を定義します。</span><span class="sxs-lookup"><span data-stu-id="8062c-115">It defines a deep Convolutional Neural Network (CNN).</span></span>

1. <span data-ttu-id="8062c-116">ローカル ブラウザーで、前回の演習で設定した Jupyter Notebook サーバーに移動します。</span><span class="sxs-lookup"><span data-stu-id="8062c-116">Navigate in your local browser to the Jupyter Notebook server that you set up in the last exercise.</span></span> <span data-ttu-id="8062c-117">URL は次の形式になります。</span><span class="sxs-lookup"><span data-stu-id="8062c-117">The URL will be of the form:</span></span>

    `<HOSTNAME>.<REGION>.cloudapp.azure.com:8888/?token={sometoken}`

1. <span data-ttu-id="8062c-118">ダッシュボードで、`first_pytorch_classifier.ipynb` Notebook を選択します。</span><span class="sxs-lookup"><span data-stu-id="8062c-118">Select the `first_pytorch_classifier.ipynb` notebook in the dashboard.</span></span>

    ![first_pytorch_classifier.ipynb を選択](../media/5-image2.PNG)

    <span data-ttu-id="8062c-120">Notebook の指示に従って、最初の PyTorch 分類子をトレーニングします。</span><span class="sxs-lookup"><span data-stu-id="8062c-120">Follow the instructions in the notebook to train your first PyTorch classifier.</span></span>

    !["分類子トレーニング Notebook" のスクリーンショット](../media/5-image3.PNG)

2. <span data-ttu-id="8062c-122">Notebook の先頭から開始し、各セルを順に実行します。</span><span class="sxs-lookup"><span data-stu-id="8062c-122">Start from the top of the notebook and run each cell in order.</span></span> <span data-ttu-id="8062c-123">以下の点に注意してください。</span><span class="sxs-lookup"><span data-stu-id="8062c-123">Note the following:</span></span>

    - <span data-ttu-id="8062c-124">一部のセルは、実行に時間がかかります。</span><span class="sxs-lookup"><span data-stu-id="8062c-124">Some of the cells take a long time to run.</span></span> <span data-ttu-id="8062c-125">Notebook の右上の "Python 3" という単語の横にある小さな点を観察します。</span><span class="sxs-lookup"><span data-stu-id="8062c-125">Observe the small dot in the top right of the notebook beside the words "Python 3".</span></span> <span data-ttu-id="8062c-126">カーネルが操作でビジー状態の場合、点は塗りつぶされた暗い円になります。</span><span class="sxs-lookup"><span data-stu-id="8062c-126">When the kernel is busy with an operation, the dot becomes a filled, darker, circle.</span></span> <span data-ttu-id="8062c-127">操作が完了するまで、その状態のままになります。</span><span class="sxs-lookup"><span data-stu-id="8062c-127">It remains that way until the operation is complete.</span></span> 
    - <span data-ttu-id="8062c-128">イメージを分類するように CNN をトレーニングしています。</span><span class="sxs-lookup"><span data-stu-id="8062c-128">You're training a CNN to classify images.</span></span> <span data-ttu-id="8062c-129">ネットワークのトレーニングが終わると、Notebook は、ラベル付けされた画像をモデルに対してテストします。</span><span class="sxs-lookup"><span data-stu-id="8062c-129">Once the network is trained, the notebook will test labeled images against the model.</span></span> <span data-ttu-id="8062c-130">イメージごとに行われた予測を記録し、モデルの精度を計算します。</span><span class="sxs-lookup"><span data-stu-id="8062c-130">It records the prediction made for each image and calculates the accuracy of the model.</span></span> <span data-ttu-id="8062c-131">次の形式で結果が表示されます。</span><span class="sxs-lookup"><span data-stu-id="8062c-131">You'll see results in the following format.</span></span>

    ![モデルの精度を示すトレーニングの結果](../media/accuracy.png)
    
    - <span data-ttu-id="8062c-133">[PyTorch チュートリアル ドキュメント](https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html) オンラインで、この Notebook の詳細を確認できます。</span><span class="sxs-lookup"><span data-stu-id="8062c-133">You can learn more about the notebook in the [PyTorch Tutorials documentation](https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html) online.</span></span>
    
    - <span data-ttu-id="8062c-134">Notebook の終わり近くに、GPU でのトレーニングに関する注意事項があります。</span><span class="sxs-lookup"><span data-stu-id="8062c-134">Towards the end of the notebook, the notes talk about training on a GPU.</span></span> <span data-ttu-id="8062c-135">このモジュールの演習をそのまま実行した場合は、CPU ベースの VM が設定されています。</span><span class="sxs-lookup"><span data-stu-id="8062c-135">If you followed the exercises in this module, you have set up a CPU-based VM.</span></span> <span data-ttu-id="8062c-136">それは、このサイズのモデルでは問題はありませんが、GPU を使用したトレーニング時間の大幅な改善は観察されない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="8062c-136">This is fine for a model this size and you may not see any significant improvements in training time with a GPU.</span></span> <span data-ttu-id="8062c-137">GPU 付きの仮想マシンを使用してモジュールを試す場合は、2 つの変更を行う必要があります。</span><span class="sxs-lookup"><span data-stu-id="8062c-137">If you do want to try the module using a  virtual machine with GPUs, then there are two changes you need to make:</span></span>
    - <span data-ttu-id="8062c-138">GPU 対応 N シリーズ VM のサイズで DSVM をプロビジョニングします。</span><span class="sxs-lookup"><span data-stu-id="8062c-138">Provision DSVM on a GPU enabled, N-series VM size.</span></span>
    - <span data-ttu-id="8062c-139">前の演習で `docker` の代わりに `nvidia-docker` を使用してコンテナーを作成します。</span><span class="sxs-lookup"><span data-stu-id="8062c-139">Create a container using `nvidia-docker` instead of `docker` in the previous exercise.</span></span>