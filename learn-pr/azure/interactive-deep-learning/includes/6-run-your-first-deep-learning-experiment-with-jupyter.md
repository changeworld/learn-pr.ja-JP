![PyTorch ロゴ](../media/5-image1.png) 

通常、ディープ ラーニングのエンジニアはマトリックス代数をすべて手動で実装することはありません。 代わりに、PyTorch や TensorFlow などのフレームワークを使用します。  

PyTorch は、ディープ ラーニングの開発プラットフォームとしての柔軟性を提供する Python ベースのフレームワークです。 それは、Python の科学技術コンピューティング ライブラリである NumPy 上に構築されています。 

PyTorch をディープ ラーニング モデルの構築に使用するのはなぜでしょうか。  

- 使いやすい API - Python の知識があれば、短時間で成果を得ることができます。
- Python のサポート - PyTorch は、科学技術コンピューティング スタックとスムーズに統合されています。
- 動的計算グラフ - 特定機能付きの事前に定義されたグラフではなく、PyTorch が実行時間内に変更可能な計算グラフを動的に作成します。 動的計算グラフは、入れ子になったバッチ処理に有効で、特定のネットワークに必要とされるメモリの量が不明の場合に役立ちます。

PyTorch の詳細については、[PyTorch.org の公式ドキュメント](https://pytorch.org/about/)を参照してください。

## <a name="run-your-first-pytorch-model"></a>最初の PyTorch モデルを実行する

PyTorch イメージからプロビジョニングされた Docker コンテナーが用意できたので、実験を開始しましょう。 [python.org](https://python.org) から Notebook をダウンロードしたことを思い出してください。そのサンプル Notebook を使用して、イメージをさまざまなカテゴリに分類するネットワークのトレーニングについて説明します。 それは、ディープな畳み込みニューラル ネットワーク (CNN) を定義します。

1. ローカル ブラウザーで、前回の演習で設定した Jupyter Notebook サーバーに移動します。 URL は次の形式になります。

    `<HOSTNAME>.<REGION>.cloudapp.azure.com:8888/?token={sometoken}`

1. ダッシュボードで、`first_pytorch_classifier.ipynb` Notebook を選択します。

    ![first_pytorch_classifier.ipynb を選択](../media/5-image2.PNG)

    Notebook の指示に従って、最初の PyTorch 分類子をトレーニングします。

    !["分類子トレーニング Notebook" のスクリーンショット](../media/5-image3.PNG)

2. Notebook の先頭から開始し、各セルを順に実行します。 以下の点に注意してください。

    - 一部のセルは、実行に時間がかかります。 Notebook の右上の "Python 3" という単語の横にある小さな点を観察します。 カーネルが操作でビジー状態の場合、点は塗りつぶされた暗い円になります。 操作が完了するまで、その状態のままになります。 
    - イメージを分類するように CNN をトレーニングしています。 ネットワークのトレーニングが終わると、Notebook は、ラベル付けされた画像をモデルに対してテストします。 イメージごとに行われた予測を記録し、モデルの精度を計算します。 次の形式で結果が表示されます。

    ![モデルの精度を示すトレーニングの結果](../media/accuracy.png)
    
    - [PyTorch チュートリアル ドキュメント](https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html) オンラインで、この Notebook の詳細を確認できます。
    
    - Notebook の終わり近くに、GPU でのトレーニングに関する注意事項があります。 このモジュールの演習をそのまま実行した場合は、CPU ベースの VM が設定されています。 それは、このサイズのモデルでは問題はありませんが、GPU を使用したトレーニング時間の大幅な改善は観察されない可能性があります。 GPU 付きの仮想マシンを使用してモジュールを試す場合は、2 つの変更を行う必要があります。
    - GPU 対応 N シリーズ VM のサイズで DSVM をプロビジョニングします。
    - 前の演習で `docker` の代わりに `nvidia-docker` を使用してコンテナーを作成します。