会社の取引先のセキュリティ ポリシーにより、取引データを強力な暗号化で保護することが求められているとします。 Windows サーバーで稼働する B2B アプリケーションを使用して、サーバーのデータ ディスクにデータを格納してます。 現在、クラウドへの移行にあたって、権限のないユーザー、デバイス、アプリケーションは Azure VM に格納されるデータにアクセスできないことを、取引先に説明する必要があります。 B2B データの暗号化を実装する戦略を決定する必要があります。

監査要件では、暗号化キーをサードパーティではなく社内で管理することが定められています。 また、Azure ベースのサーバーのパフォーマンスと管理性を維持することも重要です。 暗号化を実装する前に、パフォーマンスへの影響がないことを確認することをお勧めします。

## <a name="what-is-encryption"></a>暗号化とは

暗号化とは、意味がある情報を、文字や数字のランダムなシーケンスのような無意味に見えるものに変換することです。 暗号化のプロセスでは、暗号化されたデータを作成するアルゴリズムの一部として**キー**という形式を使用します。 キーは復号化を実行するためにも必要です。 キーには、暗号化と復号化に同じキーが使用される **_対称_** と、異なるキーが使用される **_非対称_** があります。 後者の例は、デジタル証明書で使用される**公開/秘密**キー ペアです。

### <a name="symmetric-encryption"></a>対称暗号化

Advanced Encryption Standard (AES) など、対称キーを使用するアルゴリズムは、通常は公開キー アルゴリズムよりも高速で、大容量データ ストアを保護するためによく使用されます。 キーが 1 つしかないため、キーが公開されないようにするための措置を取る必要があります。

### <a name="asymmetric-encryption"></a>非対称暗号化

非対称暗号化では、ペアの秘密キーのみを秘密にするように保護する必要があります。名前からわかるように、公開キーは誰に知らせても、暗号化されたデータが漏えいすることはありません。 ただし、公開キー アルゴリズムのデメリットは、対称アルゴリズムよりも速度がかなり遅いことです。大容量のデータを暗号化するためには使用できません。

## <a name="key-management"></a>キー管理

Azure では、暗号化キーの管理は Microsoft またはお客様が行うことができます。 ユーザーが管理するキーの需要があるのは、HIPAA または他の規制へのコンプライアンスを明示する必要がある組織です。 このようなコンプライアンスでは、キーへのアクセスのログを記録すること、定期的にキーを変更して記録することが求められる場合があります。

## <a name="azure-disk-encryption-technologies"></a>Azure ディスクの暗号化テクノロジ

Azure VM の暗号化ベースの主要なディスク保護テクノロジは次のとおりです。

- Storage Service Encryption (SSE)
- Azure Disk Encryption (ADE)

### <a name="storage-service-encryption"></a>Storage Service Encryption

Azure Storage Service Encryption (SSE) は、保存データを保護するために Azure に組み込まれている暗号化サービスです。 Azure ストレージ プラットフォームでは、データが自動的に暗号化されてから、Azure Managed Disks などいくつかのストレージ サービスに格納されます。 256 ビット AES 暗号化を使用する暗号化が既定で有効になっており、ストレージ アカウント管理者によって管理されます。

### <a name="azure-disk-encryption"></a>Azure Disk Encryption

Azure Disk Encryption (ADE) は、VM の所有者によって管理されます。 これは、Windows VM では **BitLocker** を使用し、Linux VM では **DM-Crypt** を使用して、Windows や Linux VM で制御されるディスクの暗号化を制御します。 BitLocker ドライブ暗号化は、オペレーティング システムに統合されたデータ保護機能です。コンピューターの紛失、盗難、不適切な廃棄による、データの窃盗や公表の脅威に対処します。 同様に、DM-Crypt は Linux 用に保存データを暗号化してから、ストレージに書き込みます。

ADE により、VM ディスク上のすべてのデータは Azure ストレージで保存時に暗号化されることが保証されます。ADE は Recovery コンテナーにバックアップされる VM では必須です。

ADE では、VM はユーザー管理のキーとポリシーを使用して起動されます。 ADE は、これらのディスク暗号化キーとシークレットを管理するために Azure Key Vault と統合されています。

> [!NOTE] 
> ADE では、Basic レベルの VM の暗号化はサポートされません。また、オンプレミスのキー管理サービス (KMS) を ADE で使用することはできません。

## <a name="when-to-use-encryption"></a>暗号化を使用するとき

コンピューターのデータが危険にさらされるのは、送信中 (インターネットまたは他のネットワークで送信されるとき) と保存時 (ストレージ デバイスに保存されるとき) です。 保存時のシナリオは、Azure VM ディスク上のデータを保護する際に最もよく考慮する必要があります。 たとえば、あるユーザーが Azure VM に関連付けられている仮想ハード ディスク (VHD) ファイルをダウンロードして、自分のノート PC に保存するとします。 VHD が暗号化されていない場合は、VHD を自分のコンピューターにマウントできれば、だれでも内容にはアクセスできるようになります。

オペレーティング システム (OS) ディスクの場合、パスワードなどのデータは自動的に暗号化されます。したがって、VHD そのものが暗号化されていない場合でも、そのような情報へのアクセスは容易ではありません。 アプリケーションでも、それぞれのデータが自動的に暗号化されることがあります。 ただし、そのような保護があっても、悪意のある人物がデータ ディスクにアクセスできたとき、ディスクそのものが暗号化されていない場合には、そのアプリケーションで明らかになっているデータ保護の弱点を悪用することができます。 ディスク暗号化を設定すれば、そのような悪用は不可能になります。

Storage Service Encryption (SSE) は Azure の一部であり、SSE を使用しても、VM ディスクの IO のパフォーマンスに大きな影響はありません。 現在、SSE を含むマネージド ディスクは既定となっており、変更する理由はありません。 Azure Disk Encryption (ADE) は VM オペレーティング システムのツール (BitLocker と DM-Crypt) を利用します。したがって、VM ディスクに対して暗号化または復号化が実行されているとき、VM そのものがなんらかの処理を行う必要があります。 特定の状況を除き、通常、VM CPU のこのような追加アクティビティの影響はごくわずかです。 たとえば、CPU 負荷の高いアプリケーションがある場合は、OS ディスクを暗号化せずにパフォーマンスを最適化するケースもあります。 そのような状況では、アプリケーション データを暗号化された別のデータ ディスクに格納すると、セキュリティを損なわずに必要なパフォーマンスを得ることができます。

Azure によって、2 つの補完的な暗号化テクノロジが提供され、Azure VM ディスクを保護するために使用されます。 これらのテクノロジ SSE および ADE は、異なるレイヤーで暗号化を行い、異なる目的を達成します。 いずれも AES 256 ビット暗号化が使用されます。 両方のテクノロジを使用すると、Azure ストレージや特定の VHD への不正アクセスに対して多重の保護が提供されます。
