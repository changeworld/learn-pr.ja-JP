<span data-ttu-id="2a243-101">単純なブックマーク参照サービスを作成するとします。</span><span class="sxs-lookup"><span data-stu-id="2a243-101">Imagine we want to create a simple bookmark lookup service.</span></span> <span data-ttu-id="2a243-102">最初の段階では、このサービスは読み取り専用とします。</span><span class="sxs-lookup"><span data-stu-id="2a243-102">Our service is readonly initially.</span></span> <span data-ttu-id="2a243-103">ユーザーはあるエントリを見つけるとき、そのエントリの ID を記した要求を送信します。すると、URL が返されます。</span><span class="sxs-lookup"><span data-stu-id="2a243-103">If a user wants to find an entry, they send a request with the ID of the entry and we return the URL.</span></span> <span data-ttu-id="2a243-104">この流れを説明したのが次の図です。</span><span class="sxs-lookup"><span data-stu-id="2a243-104">The following diagram explains the flow.</span></span>

![この Cosmos DB バックエンドでブックマークを見つけるプロセスを示すフロー図](../media-draft/find-bookmark-flow-small.png)

<span data-ttu-id="2a243-106">テキストを含む要求がユーザーから届くと、キーまたは ID としてそのテキストを含むバックエンド データベースでエントリを探します。そのエントリを見つけたかどうかを示す結果を返します。</span><span class="sxs-lookup"><span data-stu-id="2a243-106">When a user sends us a request with some text, we try to find an entry in our back-end database that contains this text as a key or Id. We return a result that indicates whether we found the entry or not.</span></span>

<span data-ttu-id="2a243-107">データはどこかに保存する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2a243-107">We need to store data somewhere.</span></span> <span data-ttu-id="2a243-108">このフローチャートでは、データ ストアは Azure Cosmos DB として表示されています。</span><span class="sxs-lookup"><span data-stu-id="2a243-108">In this flowchart, our data store is shown as an Azure Cosmos DB.</span></span> <span data-ttu-id="2a243-109">しかしながら、どのような方法で関数からそのデータベースに接続し、データを読み込むのでしょうか。</span><span class="sxs-lookup"><span data-stu-id="2a243-109">But, how do we connect to that database from a function and read data?</span></span> <span data-ttu-id="2a243-110">関数の世界では、そのジョブに対して*入力バインディング*を構成します。</span><span class="sxs-lookup"><span data-stu-id="2a243-110">In the world of functions, we configure an *input binding* for that job.</span></span>  <span data-ttu-id="2a243-111">Azure Portal では、バインディングを簡単に構成できます。</span><span class="sxs-lookup"><span data-stu-id="2a243-111">Configuring a binding through the Azure Portal is straightforward.</span></span> <span data-ttu-id="2a243-112">これから説明することですが、ストレージ接続を開くなどのタスクにコードを記述する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="2a243-112">As we'll see shortly, You don't have to write code for tasks such as opening a storage connection.</span></span> <span data-ttu-id="2a243-113">Azure Functions ランタイムとバインディングにより、ユーザーの代わりにこれらのタスクが処理されます。</span><span class="sxs-lookup"><span data-stu-id="2a243-113">The Azure Functions runtime and binding take care of those tasks for you.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="2a243-114">ここで作成するリソース (データベース、関数、バインディング、コード) の一部は次のラボで参照します。</span><span class="sxs-lookup"><span data-stu-id="2a243-114">We're going to refer to some resources (database, function, bindings, code) that we create here in our next lab.</span></span> <span data-ttu-id="2a243-115">少なくとも本コースを完了するまでは、これらのリソースを維持してください。</span><span class="sxs-lookup"><span data-stu-id="2a243-115">Please keep these resources around at least until you finish this course.</span></span>

<span data-ttu-id="2a243-116">前のモジュールの場合と同様に、すべて Azure portal で行います。</span><span class="sxs-lookup"><span data-stu-id="2a243-116">As was the case for the preceding module, we'll do everything in the Azure portal.</span></span>

## <a name="create-an-azure-cosmos-db"></a><span data-ttu-id="2a243-117">Azure Cosmos DB を作成する</span><span class="sxs-lookup"><span data-stu-id="2a243-117">Create an Azure Cosmos DB</span></span> 

<span data-ttu-id="2a243-118">Azure アカウントで Azure portal ([https://portal.azure.com](https://portal.azure.com?azure-portal=true)) にサインインします。</span><span class="sxs-lookup"><span data-stu-id="2a243-118">Sign in to the Azure portal at [https://portal.azure.com](https://portal.azure.com?azure-portal=true) with your Azure account.</span></span>

### <a name="create-a-database-account"></a><span data-ttu-id="2a243-119">データベース アカウントを作成する</span><span class="sxs-lookup"><span data-stu-id="2a243-119">Create a database account</span></span>

<span data-ttu-id="2a243-120">データベース アカウントは、たくさんあるデータベースの 1 つを管理するためのコンテナーです。</span><span class="sxs-lookup"><span data-stu-id="2a243-120">A database account is a container for managing one of more databases.</span></span> <span data-ttu-id="2a243-121">データベースを作成する前に、データベース アカウントを作成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2a243-121">Before we can create a database, we need to create a database account.</span></span>

1. <span data-ttu-id="2a243-122">Azure portal の左上隅にある **[リソースの作成]** ボタンを選択し、**[データベース]**、**[Azure Cosmos DB]** の順に選択します。</span><span class="sxs-lookup"><span data-stu-id="2a243-122">Select the **Create a resource** button found on the upper left-hand corner of the Azure portal, then select **Databases** > **Azure Cosmos DB**.</span></span>

2. <span data-ttu-id="2a243-123">**[新しいアカウント]** ページで、新しい Azure Cosmos DB アカウントの設定を入力します。</span><span class="sxs-lookup"><span data-stu-id="2a243-123">In the **New account** page, enter the settings for the new Azure Cosmos DB account.</span></span>
 
    <span data-ttu-id="2a243-124">設定</span><span class="sxs-lookup"><span data-stu-id="2a243-124">Setting</span></span>|<span data-ttu-id="2a243-125">値</span><span class="sxs-lookup"><span data-stu-id="2a243-125">Value</span></span>|<span data-ttu-id="2a243-126">説明</span><span class="sxs-lookup"><span data-stu-id="2a243-126">Description</span></span>
    ---|---|---
    <span data-ttu-id="2a243-127">ID</span><span class="sxs-lookup"><span data-stu-id="2a243-127">ID</span></span>|<span data-ttu-id="2a243-128"><*一意の名前を入力*></span><span class="sxs-lookup"><span data-stu-id="2a243-128">*Enter a unique name*</span></span>|<span data-ttu-id="2a243-129">この Azure Cosmos DB アカウントを識別するための一意の名前を入力します。</span><span class="sxs-lookup"><span data-stu-id="2a243-129">Enter a unique name to identify this Azure Cosmos DB account.</span></span> <span data-ttu-id="2a243-130">指定した ID に *documents.azure.com* が付加されて URI が作成されるので、ID は一意であっても識別可能なものを使用してください。</span><span class="sxs-lookup"><span data-stu-id="2a243-130">Because *documents.azure.com* is appended to the ID that you provide to create your URI, use a unique but identifiable ID.</span></span><br><br><span data-ttu-id="2a243-131">ID に含めることができるのは英小文字、数字、ハイフン (-) のみ、3 文字以上で 50 文字以内にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="2a243-131">The ID can contain only lowercase letters, numbers, and the hyphen (-) character, and it must contain 3 to 50 characters.</span></span>
    <span data-ttu-id="2a243-132">API</span><span class="sxs-lookup"><span data-stu-id="2a243-132">API</span></span>|<span data-ttu-id="2a243-133">SQL</span><span class="sxs-lookup"><span data-stu-id="2a243-133">SQL</span></span>|<span data-ttu-id="2a243-134">API によって、作成するアカウントの種類が決まります。</span><span class="sxs-lookup"><span data-stu-id="2a243-134">The API determines the type of account to create.</span></span> <span data-ttu-id="2a243-135">Azure Cosmos DB には、アプリケーションのニーズに応じて、SQL (ドキュメント データベース)、Gremlin (グラフ データベース)、MongoDB (ドキュメント データベース)、Azure Table、Cassandra の 5 つの API が用意されています。現時点では、それぞれ別個のアカウントが必要です。</span><span class="sxs-lookup"><span data-stu-id="2a243-135">Azure Cosmos DB provides five APIs to suit the needs of your application: SQL (document database), Gremlin (graph database), MongoDB (document database), Azure Table, and Cassandra, each which currently require a separate account.</span></span> <br><br><span data-ttu-id="2a243-136">**[SQL]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="2a243-136">Select **SQL**.</span></span> <span data-ttu-id="2a243-137">現時点では、Azure Cosmos DB トリガー、入力バインディング、出力バインディングは、SQL API アカウントと Graph API アカウントでのみ使用できます。</span><span class="sxs-lookup"><span data-stu-id="2a243-137">At this time, the Azure Cosmos DB trigger, input bindings, and output bindings only work with SQL API and Graph API accounts.</span></span> 
    <span data-ttu-id="2a243-138">サブスクリプション</span><span class="sxs-lookup"><span data-stu-id="2a243-138">Subscription</span></span>|<span data-ttu-id="2a243-139">*ご利用のサブスクリプション*</span><span class="sxs-lookup"><span data-stu-id="2a243-139">*Your subscription*</span></span>|<span data-ttu-id="2a243-140">この Azure Cosmos DB アカウントに使用する Azure サブスクリプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="2a243-140">Select Azure subscription that you want to use for this Azure Cosmos DB account.</span></span>
    <span data-ttu-id="2a243-141">リソース グループ</span><span class="sxs-lookup"><span data-stu-id="2a243-141">Resource Group</span></span>|<span data-ttu-id="2a243-142">既存のものを使用</span><span class="sxs-lookup"><span data-stu-id="2a243-142">Use existing</span></span><br><br><span data-ttu-id="2a243-143">*次に、[!INCLUDE [resource-group-name](./rg-name.md)] を入力します。これはこのモジュールのリソースに対して前のユニットで作成したリソース グループです。*</span><span class="sxs-lookup"><span data-stu-id="2a243-143">*Then enter [!INCLUDE [resource-group-name](./rg-name.md)], the resource group we created in an earlier unit for this module's resources.*</span></span>| <span data-ttu-id="2a243-144">**[既存のものを使用]** を選択しています。このモジュールに作成したすべてのリソースを同じリソース グループに入れるためです。</span><span class="sxs-lookup"><span data-stu-id="2a243-144">We're selecting **Use existing**, because we want to group all resources created for this module under the same resource group.</span></span>
    <span data-ttu-id="2a243-145">場所</span><span class="sxs-lookup"><span data-stu-id="2a243-145">Location</span></span>|<span data-ttu-id="2a243-146">**[既存のものを使用]** が設定されると自動的に入力されます。</span><span class="sxs-lookup"><span data-stu-id="2a243-146">Auto-filled once **Use existing** is set.</span></span> | <span data-ttu-id="2a243-147">Azure Cosmos DB アカウントをホストする地理的な場所を選択します。</span><span class="sxs-lookup"><span data-stu-id="2a243-147">Select the geographic location in which to host your Azure Cosmos DB account.</span></span> <span data-ttu-id="2a243-148">データに最も高速にアクセスできる、ユーザーに最も近い場所を使用します。</span><span class="sxs-lookup"><span data-stu-id="2a243-148">Use the location that's closest to your users to give them the fastest access to the data.</span></span> <span data-ttu-id="2a243-149">このラボでは、既存のリソース グループに設定されている場所として場所が自動的に自動設定されます。</span><span class="sxs-lookup"><span data-stu-id="2a243-149">In this lab,  the location is pre-determined for us as the location set for the existing resource group.</span></span>
    
<span data-ttu-id="2a243-150">**[新しいアカウント]** ブレードのその他の値はすべて既定値のままにします。このモジュールで使用するからです。</span><span class="sxs-lookup"><span data-stu-id="2a243-150">Leave all other fields in the **New account** blade at their default values because we're using them in this module.</span></span>  <span data-ttu-id="2a243-151">これには **[Geo 冗長の有効化]**、**[マルチ マスターを有効にする]**、**[仮想ネットワーク]** などがあります。</span><span class="sxs-lookup"><span data-stu-id="2a243-151">That includes **Enable geo-redundancy**, **Enable Multi Master**, **Virtual networks**.</span></span>

3. <span data-ttu-id="2a243-152">**[作成]** を選択し、データベース アカウントをプロビジョニングし、デプロイします。</span><span class="sxs-lookup"><span data-stu-id="2a243-152">Select **Create** to provision and deploy the database account.</span></span>

4. <span data-ttu-id="2a243-153">デプロイには時間がかかることがあります。</span><span class="sxs-lookup"><span data-stu-id="2a243-153">Deployment can take some time.</span></span> <span data-ttu-id="2a243-154">そこで、**デプロイ成功**メッセージが表示されるまで待ちます。次のようなメッセージが表示されたら続行してください。</span><span class="sxs-lookup"><span data-stu-id="2a243-154">So, wait for a **Deployment succeeded** message similar to the following message before proceeding.</span></span>

<!-- TODO figure out how to center these image -->

![データベース アカウント デプロイの完了通知](../media-draft/db-deploy-success.PNG)

5. <span data-ttu-id="2a243-156">お疲れさまでした。</span><span class="sxs-lookup"><span data-stu-id="2a243-156">Congratulations!</span></span> <span data-ttu-id="2a243-157">データベース アカウントが作成され、デプロイされました。</span><span class="sxs-lookup"><span data-stu-id="2a243-157">You've created and deployed your database account!</span></span>

6. <span data-ttu-id="2a243-158">ポータルで **[リソースに移動]** を選択し、データベース アカウントに移動します。</span><span class="sxs-lookup"><span data-stu-id="2a243-158">Select **Go to resource** to navigate to the database account in the portal.</span></span> <span data-ttu-id="2a243-159">次に、データベースにコレクションを追加します。</span><span class="sxs-lookup"><span data-stu-id="2a243-159">We'll add a collection to the database next.</span></span>

### <a name="add-a-collection"></a><span data-ttu-id="2a243-160">コレクションの追加</span><span class="sxs-lookup"><span data-stu-id="2a243-160">Add a collection</span></span>

<span data-ttu-id="2a243-161">Cosmos DB では、ユーザーが生成した任意のエンティティが*コンテナー*に保存されます。</span><span class="sxs-lookup"><span data-stu-id="2a243-161">In Cosmos DB, a *container* holds arbitrary user-generated entities.</span></span> <span data-ttu-id="2a243-162">ドキュメント指向の API である SQL API をサポートするデータベースの場合、*コレクション*がコンテナーになります。</span><span class="sxs-lookup"><span data-stu-id="2a243-162">In a database the supports SQL API, a document-oriented API, a container is a *collection*.</span></span> <span data-ttu-id="2a243-163">コレクションの中にドキュメントを保存します。</span><span class="sxs-lookup"><span data-stu-id="2a243-163">Inside a collection, we store documents.</span></span> <span data-ttu-id="2a243-164">コレクションを作成し、ドキュメントをいくつか追加したとき、全貌が明らかになります。</span><span class="sxs-lookup"><span data-stu-id="2a243-164">Hopefully all will be clearer once we create a collection and add some documents.</span></span>

<span data-ttu-id="2a243-165">それでは、Azure portal でデータ エクスプローラー ツールを使用し、データベースとコレクションを作成しましょう。</span><span class="sxs-lookup"><span data-stu-id="2a243-165">Let's use the Data Explorer tool in the Azure portal to create a database and collection.</span></span>

1. <span data-ttu-id="2a243-166">**[データ エクスプローラー]** > **[新しいコレクション]** の順にクリックします。</span><span class="sxs-lookup"><span data-stu-id="2a243-166">Click **Data Explorer** > **New Collection**.</span></span>

2. <span data-ttu-id="2a243-167">**[コレクションの追加]** で、新しいコレクションの設定を入力します。</span><span class="sxs-lookup"><span data-stu-id="2a243-167">In the **Add collection**, enter the settings for the new collection.</span></span>

    >[!TIP]
    ><span data-ttu-id="2a243-168">**[コレクションの追加]** 領域が右端に表示されます。表示されない場合、右にスクロールしてください。</span><span class="sxs-lookup"><span data-stu-id="2a243-168">The **Add Collection** area is displayed on the far right, you may need to scroll right to see it.</span></span>

    <span data-ttu-id="2a243-169">設定</span><span class="sxs-lookup"><span data-stu-id="2a243-169">Setting</span></span>|<span data-ttu-id="2a243-170">推奨値</span><span class="sxs-lookup"><span data-stu-id="2a243-170">Suggested value</span></span>|<span data-ttu-id="2a243-171">説明</span><span class="sxs-lookup"><span data-stu-id="2a243-171">Description</span></span>
    ---|---|---
    <span data-ttu-id="2a243-172">データベース ID</span><span class="sxs-lookup"><span data-stu-id="2a243-172">Database ID</span></span>|[!INCLUDE [cosmos-db-name](./cosmos-db-name.md)]| <span data-ttu-id="2a243-173">データベース名は 1 文字以上 255 文字以内にする必要があります。/、\\、#、? は使えず、末尾にスペースを入れることもできません。</span><span class="sxs-lookup"><span data-stu-id="2a243-173">Database names must contain from 1 through 255 characters, and they cannot contain /, \\, #, ?, or a trailing space.</span></span><br><br><span data-ttu-id="2a243-174">ここでは自由に入力できますが、新しいデータベースの名前には [!INCLUDE [cosmos-db-name](./cosmos-db-name.md)] を推奨します。このユニットではこれを参照することになります。</span><span class="sxs-lookup"><span data-stu-id="2a243-174">You are free to enter whatever you want here, but we suggest [!INCLUDE [cosmos-db-name](./cosmos-db-name.md)] as the name for the new database, and that's what we'll refer to in this unit.</span></span> |
    <span data-ttu-id="2a243-175">コレクション ID</span><span class="sxs-lookup"><span data-stu-id="2a243-175">Collection ID</span></span>|[!INCLUDE [cosmos-coll-name](./cosmos-coll-name.md)]|<span data-ttu-id="2a243-176">新しいコレクションの名前として [!INCLUDE [cosmos-coll-name](./cosmos-coll-name.md)] を入力します。</span><span class="sxs-lookup"><span data-stu-id="2a243-176">Enter [!INCLUDE [cosmos-coll-name](./cosmos-coll-name.md)] as the name for our new collection.</span></span> <span data-ttu-id="2a243-177">コレクション ID の文字要件はデータベース名と同じです。</span><span class="sxs-lookup"><span data-stu-id="2a243-177">Collection IDs have the same character requirements as database names.</span></span>
    <span data-ttu-id="2a243-178">ストレージの容量</span><span class="sxs-lookup"><span data-stu-id="2a243-178">Storage capacity</span></span>| <span data-ttu-id="2a243-179">固定 (10 GB)</span><span class="sxs-lookup"><span data-stu-id="2a243-179">Fixed (10 GB)</span></span>|<span data-ttu-id="2a243-180">既定値の **[固定 (10 GB)]** を使用します。</span><span class="sxs-lookup"><span data-stu-id="2a243-180">Use the default value of **Fixed (10 GB)**.</span></span> <span data-ttu-id="2a243-181">この値はデータベースの記憶域容量です。</span><span class="sxs-lookup"><span data-stu-id="2a243-181">This value is the storage capacity of the database.</span></span>
    <span data-ttu-id="2a243-182">スループット</span><span class="sxs-lookup"><span data-stu-id="2a243-182">Throughput</span></span>|<span data-ttu-id="2a243-183">400 RU</span><span class="sxs-lookup"><span data-stu-id="2a243-183">400 RU</span></span>|<span data-ttu-id="2a243-184">スループットを毎秒 400 要求ユニット (RU/秒) に変更します。</span><span class="sxs-lookup"><span data-stu-id="2a243-184">Change the throughput to 400 request units per second (RU/s).</span></span> <span data-ttu-id="2a243-185">スループットを 400 RU/秒に設定するには、記憶域容量を**固定 (10 GB)** に設定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="2a243-185">Storage capacity must be set to **Fixed (10 GB)** in order to set throughput to 400 RU/s.</span></span> <span data-ttu-id="2a243-186">待ち時間を短縮する場合、後でスループットをスケールアップできます。</span><span class="sxs-lookup"><span data-stu-id="2a243-186">If you want to reduce latency, you can scale up the throughput later.</span></span>
    
3. <span data-ttu-id="2a243-187">**[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2a243-187">Click **OK**.</span></span> <span data-ttu-id="2a243-188">新しいデータベースとコレクションがデータ エクスプローラーに表示されます。</span><span class="sxs-lookup"><span data-stu-id="2a243-188">The Data Explorer displays the new database and collection.</span></span> <span data-ttu-id="2a243-189">これでデータベースが用意されました。</span><span class="sxs-lookup"><span data-stu-id="2a243-189">So, now we have a database.</span></span> <span data-ttu-id="2a243-190">データベース内でコレクションを定義しました。</span><span class="sxs-lookup"><span data-stu-id="2a243-190">Inside the database, we've defined a collection.</span></span> <span data-ttu-id="2a243-191">次に、データ (ドキュメント) をいくつか追加します。</span><span class="sxs-lookup"><span data-stu-id="2a243-191">Next we'll add some data, also known as documents.</span></span>

### <a name="add-test-data"></a><span data-ttu-id="2a243-192">テスト データを追加する</span><span class="sxs-lookup"><span data-stu-id="2a243-192">Add test data</span></span>

<span data-ttu-id="2a243-193">[!INCLUDE [cosmos-coll-name](./cosmos-coll-name.md)] という名前のデータベースにコレクションを定義しました。このコレクションには何を保存するのでしょうか。</span><span class="sxs-lookup"><span data-stu-id="2a243-193">We've defined a collection in our database called [!INCLUDE [cosmos-coll-name](./cosmos-coll-name.md)], so what are we intending to store in the collection?</span></span> <span data-ttu-id="2a243-194">その目的は、Web ページ ブックマークの一覧のように、各ドキュメントに URL と ID を保存することにあります。</span><span class="sxs-lookup"><span data-stu-id="2a243-194">Well, the idea is to store a URL and ID in each document, like a list of web page bookmarks.</span></span> 

<span data-ttu-id="2a243-195">データ エクスプローラーを使用し、新しいコレクションにデータを追加します。</span><span class="sxs-lookup"><span data-stu-id="2a243-195">We'll add data to our new collection using Data Explorer.</span></span>

1. <span data-ttu-id="2a243-196">データ エクスプローラーで新しいデータベースが [コレクション] ウィンドウに表示されます。</span><span class="sxs-lookup"><span data-stu-id="2a243-196">In Data Explorer, the new database appears in the Collections pane.</span></span> <span data-ttu-id="2a243-197">[!INCLUDE [cosmos-db-name](./cosmos-db-name.md)] データベースを展開し、[!INCLUDE [cosmos-coll-name](./cosmos-coll-name.md)] コレクションを展開し、**[ドキュメント]** をクリックし、**[新しいドキュメント]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2a243-197">Expand the [!INCLUDE [cosmos-db-name](./cosmos-db-name.md)] database, expand the [!INCLUDE [cosmos-coll-name](./cosmos-coll-name.md)] collection, click **Documents**, and then click **New Document**.</span></span>
  
2. <span data-ttu-id="2a243-198">ここで、次の構造でドキュメントをコレクションに追加します。</span><span class="sxs-lookup"><span data-stu-id="2a243-198">Now add a document to the collection with the following structure.</span></span> <span data-ttu-id="2a243-199">各ドキュメントはスキーマレス JSON ファイルです。</span><span class="sxs-lookup"><span data-stu-id="2a243-199">Each document is schema-less JSON file.</span></span>

     ```json
     {
         "id": "docs",
         "URL": "https://docs.microsoft.com/azure"
     }
     ```

3. <span data-ttu-id="2a243-200">JSON を **[ドキュメント]** タブに追加したら、**[保存]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2a243-200">Once you've added the json to the **Documents** tab, click **Save**.</span></span>

<span data-ttu-id="2a243-201">ドキュメントを保存すると、追加時よりプロパティが増えます。</span><span class="sxs-lookup"><span data-stu-id="2a243-201">When the document is saved, notice that there are more properties than the ones we added.</span></span> <span data-ttu-id="2a243-202">そのプロパティはすべて下線で始まります (_rid、_self、_etag、_attachments、_ts)。</span><span class="sxs-lookup"><span data-stu-id="2a243-202">They all begin with an underline (_rid, _self, _etag, _attachments, _ts).</span></span> <span data-ttu-id="2a243-203">ドキュメント管理に役立てる目的で自動生成されたプロパティです。</span><span class="sxs-lookup"><span data-stu-id="2a243-203">These are properties generated by the system to help manage the document.</span></span> <span data-ttu-id="2a243-204">その概要をまとめたものが次の表です。</span><span class="sxs-lookup"><span data-stu-id="2a243-204">The following table explains briefly what they are.</span></span>


|<span data-ttu-id="2a243-205">プロパティ</span><span class="sxs-lookup"><span data-stu-id="2a243-205">Property</span></span>  |<span data-ttu-id="2a243-206">説明</span><span class="sxs-lookup"><span data-stu-id="2a243-206">Description</span></span>  |
|---------|---------|
|<span data-ttu-id="2a243-207">_rid</span><span class="sxs-lookup"><span data-stu-id="2a243-207">_rid</span></span>     |     <span data-ttu-id="2a243-208">リソース ID (_rid) は一意の識別子であり、リソース モデルのリソース スタックごとの階層も示します。</span><span class="sxs-lookup"><span data-stu-id="2a243-208">The resource ID (_rid) is a unique identifier that is also hierarchical per the resource stack on the resource model.</span></span> <span data-ttu-id="2a243-209">ドキュメント リソースの配置と移動のために内部使用されます。</span><span class="sxs-lookup"><span data-stu-id="2a243-209">It is used internally for placement and navigation of the document resource.</span></span>    |
|<span data-ttu-id="2a243-210">_self</span><span class="sxs-lookup"><span data-stu-id="2a243-210">_self</span></span>     |   <span data-ttu-id="2a243-211">リソースの URI であり、一意にアドレス指定できます。</span><span class="sxs-lookup"><span data-stu-id="2a243-211">The unique addressable URI for the resource.</span></span>      |
|<span data-ttu-id="2a243-212">_etag</span><span class="sxs-lookup"><span data-stu-id="2a243-212">_etag</span></span>     |   <span data-ttu-id="2a243-213">オプティミスティック同時実行制御に必要です。</span><span class="sxs-lookup"><span data-stu-id="2a243-213">Required for optimistic concurrency control.</span></span>     |
|<span data-ttu-id="2a243-214">_attachments</span><span class="sxs-lookup"><span data-stu-id="2a243-214">_attachments</span></span>     |  <span data-ttu-id="2a243-215">添付リソースのアドレス指定可能パス。</span><span class="sxs-lookup"><span data-stu-id="2a243-215">The addressable path for the attachments resource.</span></span>       |
|<span data-ttu-id="2a243-216">_ts</span><span class="sxs-lookup"><span data-stu-id="2a243-216">_ts</span></span>     |    <span data-ttu-id="2a243-217">このリソースの最終更新を示すタイムスタンプ。</span><span class="sxs-lookup"><span data-stu-id="2a243-217">The timestamp of the last update of this resource.</span></span>    |
 

4. <span data-ttu-id="2a243-218">それでは、コレクションにドキュメントをいくつか追加してみましょう。</span><span class="sxs-lookup"><span data-stu-id="2a243-218">Let's add a few more documents into our collection.</span></span> <span data-ttu-id="2a243-219">次のいずれに対しても、**新しいドキュメント** コマンドをもう一度使用し、各々のエントリを作成します。</span><span class="sxs-lookup"><span data-stu-id="2a243-219">For each of the following, use the **New Document** command again to create an entry for each.</span></span> <span data-ttu-id="2a243-220">忘れずに [保存] をクリックし、追加内容を記録してください。</span><span class="sxs-lookup"><span data-stu-id="2a243-220">Don't forget to click ##Save\*\* to capture your additions.</span></span>

|<span data-ttu-id="2a243-221">ID</span><span class="sxs-lookup"><span data-stu-id="2a243-221">id</span></span>  |<span data-ttu-id="2a243-222">値</span><span class="sxs-lookup"><span data-stu-id="2a243-222">value</span></span>  |
|---------|---------|
|<span data-ttu-id="2a243-223">ポータル</span><span class="sxs-lookup"><span data-stu-id="2a243-223">portal</span></span>     |  https://portal.azure.com       |
|<span data-ttu-id="2a243-224">詳細情報</span><span class="sxs-lookup"><span data-stu-id="2a243-224">learn</span></span>     |   https://docs.microsoft.com/learn |
|<span data-ttu-id="2a243-225">マーケットプレース</span><span class="sxs-lookup"><span data-stu-id="2a243-225">marketplace</span></span>     |    https://azuremarketplace.microsoft.com/marketplace/apps  |
|<span data-ttu-id="2a243-226">ブログ</span><span class="sxs-lookup"><span data-stu-id="2a243-226">blog</span></span> | https://azure.microsoft.com/blog |

<span data-ttu-id="2a243-227">完了したら、コレクションは次のスクリーンショットのようになるはずです。</span><span class="sxs-lookup"><span data-stu-id="2a243-227">When you've finished, your collection should look like the following screenshot.</span></span>

![ブックマーク コレクションに追加したエントリ一覧を示す、ポータルの SQL API UI のスクリーンショット。](../media-draft/db-bookmark-coll.PNG)

<span data-ttu-id="2a243-229">ブックマーク コレクションにエントリがいくつか与えられました。</span><span class="sxs-lookup"><span data-stu-id="2a243-229">We now have a few entries in our bookmark collection.</span></span> <span data-ttu-id="2a243-230">今回のシナリオは次のように動作します。</span><span class="sxs-lookup"><span data-stu-id="2a243-230">Our scenario will work as follows.</span></span> <span data-ttu-id="2a243-231">"id=docs" などが指定された要求が届いたら、ブックマーク コレクションでその ID を探し、URL https://docs.microsoft.com/azure を返します。</span><span class="sxs-lookup"><span data-stu-id="2a243-231">If a request arrives with, for example, "id=docs", we'll look up that ID in our bookmarks collection and return the URL https://docs.microsoft.com/azure.</span></span> <span data-ttu-id="2a243-232">それでは、このコレクションで値を探す Azure 関数を作りましょう。</span><span class="sxs-lookup"><span data-stu-id="2a243-232">Let's make an Azure function that looks up values in this collection.</span></span>

## <a name="create-our-function"></a><span data-ttu-id="2a243-233">関数の作成</span><span class="sxs-lookup"><span data-stu-id="2a243-233">Create our function</span></span>

1. <span data-ttu-id="2a243-234">前のユニットで作成した関数アプリに移動します。</span><span class="sxs-lookup"><span data-stu-id="2a243-234">Navigate to the function app you created in the preceding unit.</span></span>

2. <span data-ttu-id="2a243-235">ご利用の関数アプリを展開し、関数のコレクションをポイントし、**[関数]** の横にある [追加] (**+**) ボタンを選択します。</span><span class="sxs-lookup"><span data-stu-id="2a243-235">Expand your function app, then hover over the functions collection and select the Add (**+**) button next to **Functions**.</span></span> <span data-ttu-id="2a243-236">この操作により関数作成プロセスが開始されます。</span><span class="sxs-lookup"><span data-stu-id="2a243-236">This action starts the function creation process.</span></span> <span data-ttu-id="2a243-237">次のアニメーションで、この操作を示します。</span><span class="sxs-lookup"><span data-stu-id="2a243-237">The following animation illustrates this action.</span></span>

![ユーザーが [関数] メニュー項目をポイントしたときにプラス記号が表示されるというアニメーション。](../media-draft/func-app-plus-hover-small.gif)

3. <span data-ttu-id="2a243-239">サポートされているすべてのトリガーがこのページに表示されます。</span><span class="sxs-lookup"><span data-stu-id="2a243-239">The page shows us the complete set of supported triggers.</span></span> <span data-ttu-id="2a243-240">**[HTTP トリガー]** (次のスクリーン ショットの最初のエントリ) を選択します。</span><span class="sxs-lookup"><span data-stu-id="2a243-240">Select **HTTP trigger**, which is the first entry in the following screenshot.</span></span>

![トリガー テンプレートの選択 UI の一部を示すスクリーン ショット。イメージの左上に TTP トリガーが最初に表示されている。](../media-draft/trigger-templates-small.PNG)

4. <span data-ttu-id="2a243-242">右側に表示された **[新しい関数]** ダイアログに、次の値を使用して入力します。</span><span class="sxs-lookup"><span data-stu-id="2a243-242">Fill out the **New Function** dialog that appears to the right  using the following values.</span></span>

|<span data-ttu-id="2a243-243">フィールド</span><span class="sxs-lookup"><span data-stu-id="2a243-243">Field</span></span>  |<span data-ttu-id="2a243-244">値</span><span class="sxs-lookup"><span data-stu-id="2a243-244">Value</span></span>  |
|---------|---------|
|<span data-ttu-id="2a243-245">言語</span><span class="sxs-lookup"><span data-stu-id="2a243-245">Language</span></span>     | <span data-ttu-id="2a243-246">**JavaScript**</span><span class="sxs-lookup"><span data-stu-id="2a243-246">**JavaScript**</span></span>        |
|<span data-ttu-id="2a243-247">名前</span><span class="sxs-lookup"><span data-stu-id="2a243-247">Name</span></span>     |   [!INCLUDE [func-name-find](./func-name-find.md)]     |
| <span data-ttu-id="2a243-248">承認レベル</span><span class="sxs-lookup"><span data-stu-id="2a243-248">Authorization level</span></span> | <span data-ttu-id="2a243-249">**関数**</span><span class="sxs-lookup"><span data-stu-id="2a243-249">**Function**</span></span> |

5. <span data-ttu-id="2a243-250">**[作成]** を選択して関数を作成します。これにより、コード エディターで index.js ファイルが開き、HTTP によってトリガーされる関数の既定の実装が表示されます。</span><span class="sxs-lookup"><span data-stu-id="2a243-250">Select **Create** to create our function, which opens the index.js file in the code editor and displays a default implementation of the HTTP-triggered function.</span></span>

<span data-ttu-id="2a243-251">新しい関数を次のようにテストすることで、ここまでの作業を検証できます。</span><span class="sxs-lookup"><span data-stu-id="2a243-251">You can verify what we have done so far by testing our new function as follows:</span></span>

1. <span data-ttu-id="2a243-252">新しい関数で、右上の **[</> 関数の URL の取得]** をクリックし、**[既定値 (関数キー)]** を選択して、**[コピー]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2a243-252">In your new function, click **</> Get function URL** at the top right, select **default (Function key)**, and then click **Copy**.</span></span>

2. <span data-ttu-id="2a243-253">コピーした関数 URL をご利用のブラウザーのアドレス バーに貼り付けます。</span><span class="sxs-lookup"><span data-stu-id="2a243-253">Paste the function URL you copied into your browser's address bar.</span></span> <span data-ttu-id="2a243-254">この URL の末尾にクエリ文字列 `&name=<yourname>` を追加し、キーボードで `Enter` キーを押して要求を実行します。</span><span class="sxs-lookup"><span data-stu-id="2a243-254">Add the query string value `&name=<yourname>` to the end of this URL and press the `Enter` key on your keyboard to execute the request.</span></span> <span data-ttu-id="2a243-255">次のような応答が関数によって返され、ブラウザーに表示されます。</span><span class="sxs-lookup"><span data-stu-id="2a243-255">You should see a response similar to the following response returned by the function displayed in your browser.</span></span>  

<span data-ttu-id="2a243-256">これで必要最低限の関数が動作することが分かりました。それでは、Azure Cosmos DB (今回のシナリオでは [!INCLUDE [cosmos-coll-name](./cosmos-coll-name.md)] コレクション) からデータを読み込みます。</span><span class="sxs-lookup"><span data-stu-id="2a243-256">Now that we have our bare-bones function working, let's turn our attention to reading data from our Azure Cosmos DB, or in our scenario, our [!INCLUDE [cosmos-coll-name](./cosmos-coll-name.md)] collection.</span></span>

## <a name="add-a-cosmos-db-input-binding"></a><span data-ttu-id="2a243-257">Cosmos DB 入力バインディングの追加</span><span class="sxs-lookup"><span data-stu-id="2a243-257">Add a Cosmos DB input binding</span></span>

<span data-ttu-id="2a243-258">作成したデータベースからデータを読み込みます。そこで、入力バインディングを入力します。</span><span class="sxs-lookup"><span data-stu-id="2a243-258">We want to read data from the database we created, so enter input bindings.</span></span> <span data-ttu-id="2a243-259">ご覧のとおり、わずかな手順でデータベースと通信できるバインディングを構成できます。</span><span class="sxs-lookup"><span data-stu-id="2a243-259">As you'll see, we can configure a binding that can talk to our database in just a few steps.</span></span>

1. <span data-ttu-id="2a243-260">左側にある関数メニューで **[統合]** を選択して、[統合] タブを開きます。</span><span class="sxs-lookup"><span data-stu-id="2a243-260">Select **Integrate** in the function menu on the left to open the integration tab.</span></span>

<span data-ttu-id="2a243-261">使用したテンプレートにより、HTTP トリガーと HTTP 出力バインディングが自動的に作成されました。</span><span class="sxs-lookup"><span data-stu-id="2a243-261">The template we used created an HTTP trigger and an HTTP output binding for us.</span></span> <span data-ttu-id="2a243-262">それでは、新しい Azure Cosmos DB 入力バインディングを追加しましょう。</span><span class="sxs-lookup"><span data-stu-id="2a243-262">Let's add our new Azure Cosmos DB input binding.</span></span> 

2. <span data-ttu-id="2a243-263">**[入力]** 列の下にある **[+ 新しい入力]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="2a243-263">Select **+ New Input** under the **Inputs** column.</span></span> <span data-ttu-id="2a243-264">入力バインディングとして考えられる全種類の一覧が表示されます。</span><span class="sxs-lookup"><span data-stu-id="2a243-264">A list of all possible input binding types is displayed.</span></span>

3. <span data-ttu-id="2a243-265">一覧から **[Azure Cosmos DB]** をクリックし、**[選択]** ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="2a243-265">Click on **Azure Cosmos DB** from the list and then the **Select** button.</span></span> <span data-ttu-id="2a243-266">この操作により、Azure Cosmos DB 入力構成ページが開きます。</span><span class="sxs-lookup"><span data-stu-id="2a243-266">This action opens the Azure Cosmos DB input configuration page.</span></span>

<span data-ttu-id="2a243-267">次に、データベースへの接続を設定します。</span><span class="sxs-lookup"><span data-stu-id="2a243-267">Next, we'll set up a connection to our database.</span></span>

4. <span data-ttu-id="2a243-268">このページにある **Azure Cosmos DB アカウント接続**という名前のフィールドで、空のフィールドの右にある *[新規]* をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2a243-268">In the field named **Azure Cosmos DB account connection** on this page, click on *new* to the right of the empty field.</span></span> <span data-ttu-id="2a243-269">この操作により **[接続]** ダイアログが開きます。このダイアログでは **Azure Cosmos DB アカウント**とご利用の Azure サブスクリプションが既に選択されています。</span><span class="sxs-lookup"><span data-stu-id="2a243-269">This action opens the **Connection** dialog, which already has **Azure Cosmos DB account** and your Azure subscription selected.</span></span> <span data-ttu-id="2a243-270">あとは、データベース アカウント ID を選択するだけです。</span><span class="sxs-lookup"><span data-stu-id="2a243-270">The only thing left to do is to select a database account id.</span></span>

5. <span data-ttu-id="2a243-271">「**データベース アカウントを作成する**」セクションでは、ID 値を入力する必要がありました。</span><span class="sxs-lookup"><span data-stu-id="2a243-271">In the section, **Create a database account**, you had to supply an ID value.</span></span> <span data-ttu-id="2a243-272">ここでその値を *[データベース アカウント]* ドロップダウンで見つけ、**[選択]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="2a243-272">Now find that value in the  *Database Account* dropdown and then click **Select**.</span></span>

<span data-ttu-id="2a243-273">データベースへの新しい接続が構成され、**[Azure Cosmos DB アカウント接続]** フィールドに表示されます。</span><span class="sxs-lookup"><span data-stu-id="2a243-273">A new connection to the database is configured and is shown in the **Azure Cosmos DB account connection** field.</span></span> <span data-ttu-id="2a243-274">この抽象的な名前に隠された実際の意味を知りたければ、*[値の表示]* をクリックしてください。接続文字列が表示されます。</span><span class="sxs-lookup"><span data-stu-id="2a243-274">If you're curious about what is actually behind this abstract name, just click *show value* to reveal the connection string.</span></span>

<span data-ttu-id="2a243-275">特定の ID でブックマークを探します。受け取った ID をバインディングに連結します。</span><span class="sxs-lookup"><span data-stu-id="2a243-275">We want to look up a bookmark with a specific ID, so let's tie the ID we receive to the binding.</span></span>

7. <span data-ttu-id="2a243-276">**[ドキュメント ID (任意)]** フィールドに「`{id}`」を入力します。</span><span class="sxs-lookup"><span data-stu-id="2a243-276">In the **Document ID (optional)** field, enter `{id}`.</span></span> <span data-ttu-id="2a243-277">これは*バインディング式*と呼ばれています。</span><span class="sxs-lookup"><span data-stu-id="2a243-277">This is known as a *binding expression*.</span></span> <span data-ttu-id="2a243-278">関数は、クエリ文字列を使用して検索のための ID を指定する HTTP 要求によってトリガーされます。</span><span class="sxs-lookup"><span data-stu-id="2a243-278">The function is triggered by an HTTP request that uses a query string to specify the ID to look up.</span></span> <span data-ttu-id="2a243-279">ID はコレクション内で一意となるため、バインディングにより 0 ドキュメント (見つからない) か 1 ドキュメント (見つかった) が返されます。</span><span class="sxs-lookup"><span data-stu-id="2a243-279">Since IDs are unique in our collection, the binding will return either 0 (not found) or 1 (found) documents.</span></span>

8. <span data-ttu-id="2a243-280">次の表の値を使用し、このページの残りのフィールドに注意深く入力します。</span><span class="sxs-lookup"><span data-stu-id="2a243-280">Carefully fill out the remaining fields on this page using the values in the following table.</span></span> <span data-ttu-id="2a243-281">各フィールド名の右にある情報アイコンをクリックすれば、各フィールドの詳しい目的をいつでも確認できます。</span><span class="sxs-lookup"><span data-stu-id="2a243-281">At any time, you can click on the information icon to the right of each field name to learn more about the purpose of each field.</span></span>


|<span data-ttu-id="2a243-282">設定</span><span class="sxs-lookup"><span data-stu-id="2a243-282">Setting</span></span>  |<span data-ttu-id="2a243-283">値</span><span class="sxs-lookup"><span data-stu-id="2a243-283">Value</span></span>  |<span data-ttu-id="2a243-284">説明</span><span class="sxs-lookup"><span data-stu-id="2a243-284">Description</span></span>  |
|---------|---------|---------|
|<span data-ttu-id="2a243-285">ドキュメント パラメーター名</span><span class="sxs-lookup"><span data-stu-id="2a243-285">Document parameter name</span></span>     |  <span data-ttu-id="2a243-286">**ブックマーク**</span><span class="sxs-lookup"><span data-stu-id="2a243-286">**bookmark**</span></span>       |  <span data-ttu-id="2a243-287">コードでこのバインディングを識別するための名前。</span><span class="sxs-lookup"><span data-stu-id="2a243-287">The name used to identify this binding in your code.</span></span>      |
|<span data-ttu-id="2a243-288">データベース名</span><span class="sxs-lookup"><span data-stu-id="2a243-288">Database name</span></span>     |  [!INCLUDE [cosmos-db-name](./cosmos-db-name.md)]       | <span data-ttu-id="2a243-289">データが読み取られるデータベース。</span><span class="sxs-lookup"><span data-stu-id="2a243-289">The database where data will be read.</span></span> <span data-ttu-id="2a243-290">これはこのレッスンの前半で設定したデータベース名です。</span><span class="sxs-lookup"><span data-stu-id="2a243-290">This is the database name we set earlier in this lesson.</span></span>        |
|<span data-ttu-id="2a243-291">コレクション名</span><span class="sxs-lookup"><span data-stu-id="2a243-291">Collection Name</span></span>     |  [!INCLUDE [cosmos-db-name](./cosmos-coll-name.md)]        | <span data-ttu-id="2a243-292">データの読み取り元のコレクション。</span><span class="sxs-lookup"><span data-stu-id="2a243-292">The collection from which we'll read data.</span></span> <span data-ttu-id="2a243-293">この設定はレッスンの前半で定義しました。</span><span class="sxs-lookup"><span data-stu-id="2a243-293">This setting was defined earlier in the lesson.</span></span> |
|<span data-ttu-id="2a243-294">SQL クエリ (任意)</span><span class="sxs-lookup"><span data-stu-id="2a243-294">SQL Query (optional)</span></span>    |   <span data-ttu-id="2a243-295">空白のままにします</span><span class="sxs-lookup"><span data-stu-id="2a243-295">leave blank</span></span>       |   <span data-ttu-id="2a243-296">ID に基づき、一度に 1 ドキュメントだけ取得しています。</span><span class="sxs-lookup"><span data-stu-id="2a243-296">We are only retrieving one document at a time based on the ID.</span></span> <span data-ttu-id="2a243-297">そのため、この場合は SQL クエリを使用するよりドキュメント ID フィールドでフィルター処理するほうが効果的です。</span><span class="sxs-lookup"><span data-stu-id="2a243-297">So, filtering with the Document ID field is a better than using a SQL Query in this instance.</span></span> <span data-ttu-id="2a243-298">エントリを 1 つ返す SQL クエリを作成することもできます (`SELECT * from b where b.ID = {id}`)。</span><span class="sxs-lookup"><span data-stu-id="2a243-298">We could craft a SQL Query to return one entry (`SELECT * from b where b.ID = {id}`).</span></span> <span data-ttu-id="2a243-299">このクエリでは確かにドキュメントが返されますが、ドキュメント コレクションのドキュメントを返します。</span><span class="sxs-lookup"><span data-stu-id="2a243-299">That query would indeed return a document, but it would return it in a document collection.</span></span> <span data-ttu-id="2a243-300">コードで無駄にコレクションを操作しなければならないことがあります。</span><span class="sxs-lookup"><span data-stu-id="2a243-300">Our code would have to manipulate a collection unnecessarily.</span></span> <span data-ttu-id="2a243-301">複数のドキュメントを取得するときに SQL クエリの手法を使用してください。</span><span class="sxs-lookup"><span data-stu-id="2a243-301">Use the SQL Query approach when you want to get multiple documents.</span></span>   |
|<span data-ttu-id="2a243-302">パーティション キー (省略可能)</span><span class="sxs-lookup"><span data-stu-id="2a243-302">Partition key (optional)</span></span>     |   <span data-ttu-id="2a243-303">空白のままにします</span><span class="sxs-lookup"><span data-stu-id="2a243-303">leave blank</span></span>      |  <span data-ttu-id="2a243-304">ここでは既定値をそのまま使用してかまいません。</span><span class="sxs-lookup"><span data-stu-id="2a243-304">We can accept the default here.</span></span>       |

9. <span data-ttu-id="2a243-305">**[保存]** をクリックし、このバインディング構成に対する変更をすべて保存します。</span><span class="sxs-lookup"><span data-stu-id="2a243-305">Click **Save** to save all changes to this binding configuration.</span></span> <span data-ttu-id="2a243-306">これでバインディングが定義されたので関数で使用しましょう。</span><span class="sxs-lookup"><span data-stu-id="2a243-306">Now that we have our binding defined, it's time to use it in our function.</span></span>

## <a name="update-function-implementation"></a><span data-ttu-id="2a243-307">関数の実装を更新する</span><span class="sxs-lookup"><span data-stu-id="2a243-307">Update function implementation</span></span>

1. <span data-ttu-id="2a243-308">関数 [!INCLUDE [func-name-find](./func-name-find.md)] をクリックして、*index.js* をコード エディターで開きます。</span><span class="sxs-lookup"><span data-stu-id="2a243-308">Click on our function, [!INCLUDE [func-name-find](./func-name-find.md)], to open up *index.js* in the code editor.</span></span> <span data-ttu-id="2a243-309">データベースから読み込む目的で入力バインディングを追加しています。このバインディングを使用するようにロジックを更新しましょう。</span><span class="sxs-lookup"><span data-stu-id="2a243-309">We've added an input binding to read from our database, so let's update the logic to use this binding.</span></span>

2. <span data-ttu-id="2a243-310">index.js 内のすべてのコードを次のスニペットのコードに置換します。</span><span class="sxs-lookup"><span data-stu-id="2a243-310">Replace all code in index.js with the code from the following snippet.</span></span>

[!code-javascript[](../code/find-bookmark-single.js)]

<span data-ttu-id="2a243-311">HTTP 要求により関数がトリガーされると、`id` クエリ パラメーターが Cosmos DB 入力バインディングに渡されます。</span><span class="sxs-lookup"><span data-stu-id="2a243-311">When an HTTP request causes our function to trigger, the `id` query parameter is passed to our Cosmos DB input binding.</span></span> <span data-ttu-id="2a243-312">この ID に一致するドキュメントが見つかった場合、`bookmark` パラメーターがそれに設定されます。</span><span class="sxs-lookup"><span data-stu-id="2a243-312">If it found a document that matches this ID, then the `bookmark` parameter will be set to it.</span></span> <span data-ttu-id="2a243-313">その場合、ブックマーク ドキュメントで見つかった URL 値を含む応答を作成します。</span><span class="sxs-lookup"><span data-stu-id="2a243-313">In that case, we construct a response that contains the URL value found in the bookmark document.</span></span> <span data-ttu-id="2a243-314">このキーに一致するドキュメントが見つからなかった場合、ペイロードと状態コードで応答し、その旨をユーザーに伝えます。</span><span class="sxs-lookup"><span data-stu-id="2a243-314">If no document was found matching this key, we respond with a payload and status code that tells the user the bad news.</span></span>

## <a name="try-it-out"></a><span data-ttu-id="2a243-315">試してみる</span><span class="sxs-lookup"><span data-stu-id="2a243-315">Try it out</span></span>

1. <span data-ttu-id="2a243-316">通常は、右上の **[</> 関数の URL の取得]** をクリックし、**[既定値 (関数キー)]** を選択して、**[コピー]** をクリックすることで、関数の URL をコピーします。</span><span class="sxs-lookup"><span data-stu-id="2a243-316">As usual, click **</> Get function URL** at the top right, select **default (Function key)**, and then click **Copy** to copy the function's URL.</span></span>

2. <span data-ttu-id="2a243-317">コピーした関数 URL をご利用のブラウザーのアドレス バーに貼り付けます。</span><span class="sxs-lookup"><span data-stu-id="2a243-317">Paste the function URL you copied into your browser's address bar.</span></span> <span data-ttu-id="2a243-318">この URL の末尾にクエリ文字列 `&id=docs` を追加し、キーボードで `Enter` キーを押して要求を実行します。</span><span class="sxs-lookup"><span data-stu-id="2a243-318">Add the query string value `&id=docs` to the end of this URL and press the `Enter` key on your keyboard to execute the request.</span></span> <span data-ttu-id="2a243-319">すべて順調であれば、そのリソースへの URL を含む応答が表示されます。</span><span class="sxs-lookup"><span data-stu-id="2a243-319">All going well, you should see a response that includes a URL to that resource.</span></span>

3. <span data-ttu-id="2a243-320">`&id=docs` を `&id=missing` に置き換え、応答を観察します。</span><span class="sxs-lookup"><span data-stu-id="2a243-320">Replace `&id=docs` with `&id=missing` and observe the response.</span></span>

4. <span data-ttu-id="2a243-321">前のクエリ文字列を `&id=` に置き換え、応答を観察します。</span><span class="sxs-lookup"><span data-stu-id="2a243-321">Replace the previous query string with `&id=` and observe the response.</span></span>

>[!TIP]
><span data-ttu-id="2a243-322">関数ポータル UI の **[テスト]** タブを使用して関数をテストすることもできます。</span><span class="sxs-lookup"><span data-stu-id="2a243-322">You can also test the function using the **Test** tab in the function portal UI.</span></span> <span data-ttu-id="2a243-323">クエリ パラメーターを追加するか、単純に要求本文を指定することで、前の手順で説明した同じ結果を得ることができます。</span><span class="sxs-lookup"><span data-stu-id="2a243-323">You can add a query parameter or just supply a request body to get the same results as described in te preceding steps.</span></span>

<span data-ttu-id="2a243-324">このユニットでは、Azure Cosmos DB データベースから読み取る目的で、最初の入力バインディングを手動で作成しました。</span><span class="sxs-lookup"><span data-stu-id="2a243-324">In this unit, we created our first input binding  manually to read from an Azure Cosmos DB database.</span></span> <span data-ttu-id="2a243-325">バインディングを利用したことで、データベースを検索するために記述するコードの量が最小に抑えられました。</span><span class="sxs-lookup"><span data-stu-id="2a243-325">The amount of code we wrote to search our database and read data was minimal, thanks to bindings.</span></span> <span data-ttu-id="2a243-326">作業の多くはバインディングを宣言によって構成することで行い、残りはプラットフォームにまかせました。</span><span class="sxs-lookup"><span data-stu-id="2a243-326">We did most of our work configuring the binding declaratively and the platform took care of the rest.</span></span>  

<span data-ttu-id="2a243-327">次のユニットでは、Azure Cosmos DB 出力バインディングを利用し、ブックマーク コレクションにさらにデータを追加します。</span><span class="sxs-lookup"><span data-stu-id="2a243-327">In the next unit, we'll add more data to our bookmark collection through an Azure Cosmos DB output binding.</span></span>

> [!TIP]
> <span data-ttu-id="2a243-328">このユニットは Azure Cosmos DB のチュートリアルではありません。</span><span class="sxs-lookup"><span data-stu-id="2a243-328">This unit is not intended to be a tutorial on Azure Cosmos DB.</span></span> <span data-ttu-id="2a243-329">さらに詳しく知りたければ、以下に紹介するリソースから始めてください。</span><span class="sxs-lookup"><span data-stu-id="2a243-329">If you would like to dive deeper, here are a few resources to get you started:</span></span>
>
>* [<span data-ttu-id="2a243-330">Azure Cosmos DB の概要: SQL API</span><span class="sxs-lookup"><span data-stu-id="2a243-330">Introduction to Azure Cosmos DB: SQL API</span></span>](https://docs.microsoft.com/azure/cosmos-db/sql-api-introduction)
>
>* [<span data-ttu-id="2a243-331">Azure Cosmos DB の技術概要</span><span class="sxs-lookup"><span data-stu-id="2a243-331">A technical overview of Azure Cosmos DB</span></span>](https://azure.microsoft.com/blog/a-technical-overview-of-azure-cosmos-db/)
>
>* [<span data-ttu-id="2a243-332">Azure Cosmos DB のドキュメント</span><span class="sxs-lookup"><span data-stu-id="2a243-332">Azure Cosmos DB documentation</span></span>](https://docs.microsoft.com/azure/cosmos-db/)