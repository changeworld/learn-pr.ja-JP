Azure に Linux VM を作成したので、次に Azure に移行するタスク用に VM を構成します。

Azure に対してサイト間 VPN を設定していない場合、Azure VM にはローカル ネットワークからアクセスできません。 Azure を使い始めたばかりの場合は、きっとサイト間 VPN を設定していないでしょう。 それでは、どうすれば仮想マシンに接続できますか?

## <a name="azure-vm-ip-addresses"></a>Azure VM IP アドレス

少し前に説明したように、Azure VM は仮想ネットワーク経由で通信します。 必要に応じてパブリック IP アドレスを VM に割り当てることもできます。 パブリック IP を使用すると、インターネット経由で VM とやり取りができます。 または、オンプレミスのネットワークを Azure に接続する仮想プライベート ネットワーク (VPN) を設定できます。そうすれば、パブリック IP アドレスを公開することなく、安全に VM に接続できます。 そのオプションの詳細に関心がある場合は、別のモジュールでこのアプローチが取り上げられており、詳しいドキュメントもあります。

Azure でのパブリック IP アドレスに関して注意すべき 1 つの点は、多くの場合、それが動的に割り当てられることです。 つまり、時間が経つと IP アドレスが変わる可能性があります。VM の場合、これは VM の再起動時に行われます。 名前ではなく IP アドレスに直接接続し、IP アドレスが確実に変化しないようにしたい場合は、静的アドレスを割り当てることができます。

## <a name="connect-to-an-azure-linux-vm-with-ssh"></a>SSH を使用して Azure の Linux VM に接続する

SSH を使用した Azure の VM への接続はシンプルなプロセスです。 Azure portal で、お使いの VM のプロパティに移動し、 一番上にある **[接続]** をクリックします。 VM に割り当てられている IP アドレスと、SSH に関するログインの詳細がすべて表示されます。 

![Linux VM に関する SSH 接続の詳細](../media-drafts/5-connect-ssh.png)

これらの詳細がわかれば、次のコマンドを使用して Linux VM に接続できます。

```bash
ssh jim@137.117.101.249
```

初めて接続すると、SSH から不明なホストに対する認証についてたずねられます。 SSH は、ユーザーがこれまでこのサーバーに接続していないことを示します。 それが正しい場合、それはまったく普通のことであり、"yes" と応答してサーバーのフィンガープリントを既知のホスト ファイルに保存できます。

```output
The authenticity of host '137.117.101.249 (137.117.101.249)' can't be established.
ECDSA key fingerprint is SHA256:w1h08h4ie1iMq7ibIVSQM/PhcXFV7O7EEhjEqhPYMWY.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '137.117.101.249' (ECDSA) to the list of known hosts.
```

## <a name="transferring-files-to-the-vm"></a>VM にファイルを転送する

もう 1 つの一般的なタスクは、あるサーバーから別のサーバーにローカル ファイルまたはデータをコピーすることです。 ここでは、最終的に、Web サイトのデータを Azure VM にコピーします。 Linux VM と SSH では、`scp` コマンドを使用できます。 コマンドは `cp` でのローカル ファイルのコピーに似ていますが、リモート ユーザーとホストをコマンドで指定する必要がある点が異なります。 

たとえば、IP アドレスが `192.168.1.25` である Linux マシン上の `~/folder` に現在のディレクトリから `somefile.txt` をコピーするには、次のように入力できます。

```bash
scp somefile.txt someuser@192.168.1.25:~/folder/
```

これはリモート システム上で `someuser` として認証され、パスワードの入力を求められるか、またはユーザーの SSH 秘密キーが使用されます。 そのユーザーは、コピー先サーバー上の `~/folder/` に対する書き込みアクセス許可を持っている必要があります。

> [!WARNING]
> コマンド ラインに正確に入力しないと、`scp` はローカル ファイルのコピーを行います。 指定し忘れることが最も多い部分は、コピー先のフォルダーです。

SSH を使用して、実行中の Linux VM に接続してみましょう。