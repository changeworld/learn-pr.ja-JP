このユニットでは、BLOB が作成または更新されたときの名前とサイズを表示する Azure 関数を作成します。

## <a name="create-a-blob-trigger"></a>BLOB トリガーを作成する

ここでも、既存の Azure Functions アプリケーションを引き続き使用し、BLOB トリガーを追加してみましょう。

1. サンドボックスをアクティブ化したときと同じアカウントを使用して [Azure portal](https://portal.azure.com/learn.docs.microsoft.com?azure-portal=true) にサインインしていることを確認します。

1. **[すべてのリソース]** 画面に移動し、関数アプリを選択します。

1. **[関数]** をポイントし、プラス (+) アイコンを選択します。

1. **[BLOB トリガー]** を選択します。

1. **[名前]** は既定値のままにします。

1. **[パス]** は既定値のままにします。

1. **[ストレージ アカウント接続]** ドロップダウンの隣にある_新しい_リンクを選択します。 ブレードが表示されたら、**[新規作成]** をクリックします。 新しいストレージ アカウントに一意の名前を入力し、**[OK]** を選択してストレージ アカウントを作成し、ウィンドウを閉じます。

1. [新しい関数] 画面に戻ったら、**[作成]** を選択して関数を作成します。

## <a name="create-a-blob-container"></a>BLOB コンテナーを作成する

BLOB トリガーが作成されたので、ストレージ エクスプローラーを使用して、BLOB を作成し、関数をトリガーしてみましょう。

1. 新しいタブで使用した (または作成した) ストレージ アカウントを開きます。

    > [!TIP]
    > ほとんどのブラウザーでタブを複製できます。複製するタブを右クリックし、メニューが表示されたら **[複製]** を選択します。 今回、使用中の 2 つのサービスを切り替えることができるように新しいタブを使用します。

1. サイドバーにある **[ストレージ アカウント]** を選択するか、サイズバーの **[すべてのリソース]** を選択し、名前でリソースを絞り込みます。

1. **[ストレージ エクスプローラー (プレビュー)]** セクションをクリックすると、BLOB やファイルを操作できる新しいウィンドウが開きます。

この BLOB トリガーは、**[パス]**  フィールドに示されている場所のみを監視しています。 既定では、パスは次のようになります。

> samples-workitems/{name}

**samples-workitems** という名前のコンテナーを作成する必要があります。

1. **[BLOB コンテナー]** を右クリックし、**[BLOB コンテナーの作成]** を選択します。

1. 名前として **samples-workitems** を入力し、アクセス レベルは既定の**プライベート**の設定のままにして **[OK]** を選択します。

## <a name="turn-on-your-blob-trigger"></a>BLOB トリガーを有効にする

これで、監視するコンテナーが作成されたので、BLOB の作成時に出力を確認するために関数を実行してみましょう。

1. Azure 関数のあるブラウザー タブに戻ります (またはもう一度開きます)。

1. BLOB トリガーを選択してコード画面を開きます。

1. 画面の下部にある **[ログ]** タブを開きます。

## <a name="create-a-blob"></a>BLOB を作成する

BLOB トリガーが有効になっており、アクティビティをリッスンしています。 ログ メッセージを取得しているかどうかを確認するために、BLOB を作成してみましょう。

1. Storage Explorer のあるブラウザー タブに戻ります。

1. Storage Explorer で、**[BLOB コンテナー]** 一覧から **[samples-workitems]** コンテナーを選択します。

1. ツールバーから **[アップロード]** を選択します。

1. コンピューターから任意のファイルを選択します。

1. **[認証の種類]** として **[SAS]** を選択します。

1. **[アップロード]** を選択します。

1. [Azure Function] タブに戻り、どのファイルがアップロードされたか表示するメッセージを出力ログで確認します。