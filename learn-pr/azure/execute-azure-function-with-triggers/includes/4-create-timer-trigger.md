このユニットでは、タイマー トリガーを使用して 20 秒ごとに呼び出される Azure 関数アプリを作成します。

[!include[](../../../includes/azure-sandbox-activate.md)]

## <a name="create-an-azure-function-app"></a>Azure 関数アプリの作成

それではまず、ポータルで Azure 関数アプリを作成しましょう。

1. サンドボックスをアクティブ化したときと同じアカウントを使用して、[Azure portal](https://portal.azure.com/learn.docs.microsoft.com?azure-portal=true) にサインインします。

1. 左側のナビゲーションで、**[リソースの作成]** を選択します。

1. **[コンピューティング]** を選択します。

1. **[Function App]** を検索して選択します。 必要に応じて検索バーを使用してテンプレートを検索することもできます。

    ![Azure portal のスクリーンショット。[リソースの作成] ブレードで Function App が強調表示されています。](../media/4-click-function-app.png)

1. グローバルに一意の**アプリ名**を入力します。

1. **サブスクリプション**を選択します。

1. <rgn>[サンドボックス リソース グループ名]</rgn> という既存の**リソース グループ**を選択します。

1. 使用する **OS** として **[Windows]** を選択します。

1. 使用する**ホスティング プラン**には、**[従量課金プラン]** を選択します。 ご利用の関数を実行するたびに課金されます。 ご利用のアプリケーション ワークロードに基づいてリソースが自動的に割り当てられます。

1. 次の利用可能な一覧から**場所**を選択します。

    [!include[](../../../includes/azure-sandbox-regions-first-mention-note-friendly.md)]

1. 新しい**ストレージ** アカウントを作成します。名前は自由に変更できます。変更しない場合、アプリ名に基づく名前になります。

1. **[作成]** を選択します。 関数アプリがデプロイされたら、ポータルの **[すべてのリソース]** に移動します。 関数アプリはタイプ **[App Service]** の一覧に表示され、指定した名前が付けられます。

## <a name="create-a-timer-trigger"></a>タイマー トリガーを作成する

次に、関数内にタイマー トリガーを作成します。

1. 関数が作成されたら、左側のナビゲーションから **[すべてのリソース]** を選択します。

1. 一覧で関数アプリを見つけて選択します。

1. 新しいブレード上で、**[関数]** をポイントし、プラス (+) アイコンを選択します。

    ![Azure portal のスクリーンショット。[関数アプリ] ブレードで [関数] サブメニューの追加 (+) ボタンが強調表示されています。](../media/4-hover-function.png)

1. **[タイマー]** を選択します。

1. 言語として **[CSharp]** を選択します。

1. **[この関数を作成する]** をクリックします。

## <a name="configure-the-timer-trigger"></a>タイマー トリガーを構成する

ログ ウィンドウにメッセージを出力するロジックを持つ Azure 関数アプリを用意しています。 20 秒ごとに実行されるようにタイマーのスケジュールを設定することにします。

1. **[統合]** を選択します。

1. **[スケジュール]** ボックスに次の値を入力します。

    ```log
    */20 * * * * *
    ```

1. **[保存]** を選択します。

## <a name="test-the-timer"></a>タイマーをテストする

タイマーを設定したので、定義した間隔で関数が呼び出されます。

1. **[TimerTriggerCSharp1]** を選択します。

    > [!NOTE]
    > **[TimerTriggerCSharp1]** は既定の名前です。 これは、トリガーを作成するとき自動的に選択されます。

1. 画面の下部にある **[ログ]** パネルを開きます。

1. 20 秒ごとに新しいメッセージが到着するのをログ ウィンドウで観察してください。

1. 関数の実行を停止するには、**[管理]** を選択し、**[関数の状態]** を *[無効]* に切り替えます。
