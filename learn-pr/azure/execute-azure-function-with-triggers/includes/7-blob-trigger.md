あなたは写真家で、その日の写真を載せる Web サイトを所有しているとします。 忙しさからアップロードのスケジュールが一貫していないため、写真をアップロードするときにファンに通知したいと考えています。 ご利用の Azure Storage Blob コンテナーにイメージをアップロードするたびに、自動的にツイートを送信する Azure 関数を作成することにします。

ここでは、BLOB トリガーを作成して、Azure Storage Blob コンテナーの特定の場所を監視するように指示する方法について説明します。

## <a name="what-is-azure-storage"></a>Azure Storage とは

Azure Storage は、すべての種類のデータ (BLOB、キュー、NoSQL など) をサポートする Microsoft のクラウド ストレージのソリューションです。 Azure Storage の目標は、次のようなデータ ストレージを提供することです。

- 高可用性
- セキュリティ保護
- 拡張性
- 管理者常駐型

ここでは Azure Storage にはあまり焦点を当てません。 代わりに、Azure Storage を使って、関数を実行するようにトリガーする BLOB を作成します。

## <a name="what-is-azure-blob-storage"></a>Azure BLOB Storage とは

Azure BLOB ストレージは、大量の非構造化データを格納するように設計されたオブジェクト ストレージのソリューションです。 

たとえば、Azure BLOB ストレージは次の操作に最適です。

- ファイルを格納する
- ファイルを提供する
- ビデオやオーディオをストリーミング配信する
- データのログを記録する

BLOB には、**ブロック BLOB**、**追加 BLOB**、**ページ BLOB** の 3 種類があります。 ブロック BLOB は最も一般的な種類です。 ブロック BLOB では、テキストやバイナリ データを効率的に格納できます。 追加 BLOB はブロック BLOB に似ていますが、定期的に更新されるログ ファイルの作成など、より追加の操作のために設計されています。 最後に、ページ BLOB はページで構成されており、頻繁なランダムの読み取り/書き込み操作のために設計されています。

## <a name="what-is-a-blob-trigger"></a>BLOB トリガーとは

BLOB トリガーは、Azure BLOB ストレージ内にファイルがアップロードされたり、ファイルが更新されたりしたときに関数を実行するトリガーです。 BLOB トリガーを作成するには、Azure Storage アカウントを作成して、トリガーで監視する場所を指定します。

## <a name="how-to-create-a-blob-trigger"></a>BLOB トリガーを作成する方法

これまでに確認したその他のトリガーのように、Azure portal 内で BLOB トリガーを作成します。 Azure 関数内で、定義済みのトリガーの種類の一覧から **[BLOB トリガー]** を選択します。 次に、BLOB が作成または更新されたときに実行するロジックを入力します。

1 つ確認する必要があるのは、**パス**という設定です。 **パス**によって、BLOB トリガーに、BLOB がアップロードまたは更新されたかどうかを確認するために監視する場所を示します。 既定では、**パス**の値は次のとおりです。 

> samples-workitems/{name}

この概念を *samples-workitems* と *{name}* の 2 つの部分に分割します。 最初の部分の *samples-workitems* は、トリガーを監視する BLOB コンテナーを表します。 2 番目の部分の *{name は、どの種類のファイルでも、このトリガーで関数を呼び出せることを意味します。 関数が呼び出されるのは、フィルターがないからです。 たとえば、PNG ファイルが次のような構文を使用して追加される場合にのみ、トリガーで関数を呼び出すことができます。

> samples-workitems/{name}.png

この概念での情報における重要な最後の部分は、テキストの *name* です。 *name* は、追加されたファイルの名前を受け取る Azure 関数内のパラメーターを表します。 たとえば、*resume.txt* という名前のファイルをアップロードした場合、自分の Azure 関数では *name* と呼ばれるパラメーターを介して、文字列としてその値を受け取ります。

Azure Storage Blob アカウントの特定の場所でアクティビティを表示する場合、BLOB トリガーによって Azure 関数が呼び出されます。 Azure portal 内で**パス**の値を変更することによって、監視する場所を設定します。