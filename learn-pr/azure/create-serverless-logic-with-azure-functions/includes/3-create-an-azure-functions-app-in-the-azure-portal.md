<span data-ttu-id="aaaba-101">これで温度サービスを実装する準備ができました。</span><span class="sxs-lookup"><span data-stu-id="aaaba-101">You are now ready to start implementing the temperature service.</span></span> <span data-ttu-id="aaaba-102">前のユニットでは、サーバーなしのソリューションが自分のニーズに最適であることがわかりました。</span><span class="sxs-lookup"><span data-stu-id="aaaba-102">In the previous unit, you determined that a serverless solution would best fit your needs.</span></span> <span data-ttu-id="aaaba-103">Azure 関数を保持するために、関数アプリを作成することから始めましょう。</span><span class="sxs-lookup"><span data-stu-id="aaaba-103">Let's start by creating a function app to hold our Azure Function.</span></span>

[!include[](../../../includes/azure-sandbox-activate.md)]

## <a name="what-is-a-function-app"></a><span data-ttu-id="aaaba-104">関数アプリとは</span><span class="sxs-lookup"><span data-stu-id="aaaba-104">What is a function app?</span></span>

<span data-ttu-id="aaaba-105">関数は、**関数アプリ**と呼ばれる実行コンテキストでホストされます。</span><span class="sxs-lookup"><span data-stu-id="aaaba-105">Functions are hosted in an execution context called a **function app**.</span></span> <span data-ttu-id="aaaba-106">Azure では、関数とコンピューティング リソースを論理的にグループ化し、構造化するために、関数アプリを定義します。</span><span class="sxs-lookup"><span data-stu-id="aaaba-106">You define function apps to logically group and structure your functions and a compute resource in Azure.</span></span> <span data-ttu-id="aaaba-107">エレベーターの例では、エスカレーター駆動歯車の温度サービスをホストする関数アプリを作成します。</span><span class="sxs-lookup"><span data-stu-id="aaaba-107">In our elevator example, you would create a function app to host the escalator drive gear temperature service.</span></span> <span data-ttu-id="aaaba-108">関数アプリを作成するために、いくつかの決定を行う必要があります。サービス プランを選択し、互換性のあるストレージ アカウントを選択する必要があります。</span><span class="sxs-lookup"><span data-stu-id="aaaba-108">There are a few decisions that need to be made to create the function app; you need to choose a service plan and select a compatible storage account.</span></span>

### <a name="choosing-a-service-plan"></a><span data-ttu-id="aaaba-109">サービス プランを選択する</span><span class="sxs-lookup"><span data-stu-id="aaaba-109">Choosing a service plan</span></span>

<span data-ttu-id="aaaba-110">関数アプリでは、2 種類のサービス プランのいずれかを使用できます。</span><span class="sxs-lookup"><span data-stu-id="aaaba-110">Function apps may use one of two types of service plans.</span></span> <span data-ttu-id="aaaba-111">最初のサービス プランは、**従量課金サービス プラン**です。</span><span class="sxs-lookup"><span data-stu-id="aaaba-111">The first service plan is the **Consumption service plan**.</span></span> <span data-ttu-id="aaaba-112">これは、Azure のサーバーレス アプリケーション プラットフォームを使用するときに選択するプランです。</span><span class="sxs-lookup"><span data-stu-id="aaaba-112">This is the plan that you choose when using the Azure serverless application platform.</span></span> <span data-ttu-id="aaaba-113">従量課金サービス プランでは、自動スケーリングが提供され、関数が実行されているときに課金されます。</span><span class="sxs-lookup"><span data-stu-id="aaaba-113">The Consumption service plan provides automatic scaling and bills you when your functions are running.</span></span> <span data-ttu-id="aaaba-114">従量課金プランには、関数の実行に対して構成可能なタイムアウト期間が付属します。</span><span class="sxs-lookup"><span data-stu-id="aaaba-114">The Consumption plan comes with a configurable timeout period for the execution of a function.</span></span> <span data-ttu-id="aaaba-115">既定は 5 分ですが、最長 10 分までのタイムアウトを構成できます。</span><span class="sxs-lookup"><span data-stu-id="aaaba-115">By default, it is 5 minutes, but may be configured to have a timeout as long as 10 minutes.</span></span>

<span data-ttu-id="aaaba-116">2 つ目のプランは、**Azure App Service プラン**と呼ばれています。</span><span class="sxs-lookup"><span data-stu-id="aaaba-116">The second plan is called the **Azure App Service plan**.</span></span> <span data-ttu-id="aaaba-117">このプランでは、定義した VM 上で関数が連続的に実行されるようにして、タイムアウト期間を避けることができます。</span><span class="sxs-lookup"><span data-stu-id="aaaba-117">This plan allows you to avoid timeout periods by having your function run continuously on a VM that you define.</span></span> <span data-ttu-id="aaaba-118">App Service プランを使用している場合、お客様は関数を実行するアプリ リソースを管理する責任があるため、これは技術的にはサーバーレス プランではありません。</span><span class="sxs-lookup"><span data-stu-id="aaaba-118">When using an App Service plan, you are responsible for managing the app resources the function runs on, so this is technically not a serverless plan.</span></span> <span data-ttu-id="aaaba-119">ただし、関数が連続的に使用される場合、あるいは従量課金プランよりも多くの処理能力または実行時間が必要な場合に、このプランを選択することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="aaaba-119">However, it may be a better choice if your functions are used continuously or if your functions require more processing power or execution time than the Consumption plan can provide.</span></span>

### <a name="storage-account-requirements"></a><span data-ttu-id="aaaba-120">ストレージ アカウントの要件</span><span class="sxs-lookup"><span data-stu-id="aaaba-120">Storage account requirements</span></span>

<span data-ttu-id="aaaba-121">関数アプリを作成する場合、関数アプリはストレージ アカウントにリンクされている必要があります。</span><span class="sxs-lookup"><span data-stu-id="aaaba-121">When you create a function app, it must be linked to a storage account.</span></span> <span data-ttu-id="aaaba-122">既存のアカウントを選択するか、新しいアカウントを作成できます。</span><span class="sxs-lookup"><span data-stu-id="aaaba-122">You can select an existing account or create a new one.</span></span> <span data-ttu-id="aaaba-123">関数アプリでは、関数実行の記録や実行トリガーの管理など、内部操作のためにこのストレージ アカウントが使用されます。</span><span class="sxs-lookup"><span data-stu-id="aaaba-123">The function app uses this storage account for internal operations such as logging function executions and managing execution triggers.</span></span> <span data-ttu-id="aaaba-124">従量課金サービス プランでは、これは関数コードと構成ファイルが格納される場所でもあります。</span><span class="sxs-lookup"><span data-stu-id="aaaba-124">On the Consumption service plan, this is also where the function code and configuration file are stored.</span></span>

## <a name="create-a-function-app"></a><span data-ttu-id="aaaba-125">関数アプリの作成</span><span class="sxs-lookup"><span data-stu-id="aaaba-125">Create a function app</span></span>

<span data-ttu-id="aaaba-126">Azure portal で関数アプリを作成しましょう。</span><span class="sxs-lookup"><span data-stu-id="aaaba-126">Let's create a function app in the Azure portal.</span></span>

1. <span data-ttu-id="aaaba-127">サンドボックスをアクティブ化したときと同じアカウントを使用して、[Azure portal](https://portal.azure.com/learn.docs.microsoft.com?azure-portal=true) にサインインします。</span><span class="sxs-lookup"><span data-stu-id="aaaba-127">Sign into the [Azure portal](https://portal.azure.com/learn.docs.microsoft.com?azure-portal=true) using the same account you activated the sandbox with.</span></span>

1. <span data-ttu-id="aaaba-128">Azure portal の左上隅にある **[リソースの作成]** ボタンを選択し、**[作業の開始] > [Serverless Function App]** の順に選択して、Function App の *[作成]* ブレードを開きます。</span><span class="sxs-lookup"><span data-stu-id="aaaba-128">Select the **Create a resource** button found on the upper left-hand corner of the Azure portal, and then select **Get started > Serverless Function App** to open the Function App *Create* blade.</span></span> <span data-ttu-id="aaaba-129">または、**[計算]、[Function App]** オプションの順に選択して、同じブレードを開くこともできます。</span><span class="sxs-lookup"><span data-stu-id="aaaba-129">Alternatively, you can use the **Compute > Function App** option, which will open the same blade.</span></span>

  ![[計算] セクションと Function App が強調表示されている [リソースの作成] ブレードを示す Azure portal のスクリーンショット。](../media/3-create-function-app-blade.png)

1. <span data-ttu-id="aaaba-131">グローバルに一意のアプリ名を選択します。</span><span class="sxs-lookup"><span data-stu-id="aaaba-131">Choose a globally unique app name.</span></span> <span data-ttu-id="aaaba-132">これはご自分のサービスのベース URL として機能します。</span><span class="sxs-lookup"><span data-stu-id="aaaba-132">This will serve as the base URL of your service.</span></span> <span data-ttu-id="aaaba-133">たとえば、**escalator-functions-xxxxxxx** という名前を付けることができます。xxxxxxx は自分のイニシャルや誕生年に置き換えることができます。</span><span class="sxs-lookup"><span data-stu-id="aaaba-133">For example, you can name it **escalator-functions-xxxxxxx**, where the x's can be replaced with your initials and your birth year.</span></span> <span data-ttu-id="aaaba-134">グローバルに一意でない場合、別の組み合わせをお試しください。</span><span class="sxs-lookup"><span data-stu-id="aaaba-134">If this isn't globally unique, you can try any other combination.</span></span> <span data-ttu-id="aaaba-135">有効な文字は a-z、0-9、- (ハイフン) です。</span><span class="sxs-lookup"><span data-stu-id="aaaba-135">Valid characters are a-z, 0-9 and -.</span></span>

1. <span data-ttu-id="aaaba-136">関数アプリをホストする Azure サブスクリプションを選択します。</span><span class="sxs-lookup"><span data-stu-id="aaaba-136">Select the Azure subscription where you would like the function app hosted.</span></span>

1. <span data-ttu-id="aaaba-137">"**<rgn>[サンドボックス リソース グループ名]</rgn>**" という既存のリソース グループを選択します。</span><span class="sxs-lookup"><span data-stu-id="aaaba-137">Select the existing resource group called "**<rgn>[sandbox resource group name]</rgn>**".</span></span>

1. <span data-ttu-id="aaaba-138">OS として **[Windows]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="aaaba-138">Select **Windows** for OS.</span></span>

1. <span data-ttu-id="aaaba-139">**[ホスティング プラン]** では、サーバーレス ホスティング オプションである **[従量課金プラン]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="aaaba-139">For **Hosting Plan**, select **Consumption Plan**, which is the serverless hosting option.</span></span>

1. <span data-ttu-id="aaaba-140">自分が住んでいる場所に最も近い地域を選択します。</span><span class="sxs-lookup"><span data-stu-id="aaaba-140">Select the geographical location closest to you from the list below.</span></span> <span data-ttu-id="aaaba-141">運用システムでは、関数の顧客やコンシューマーに近い場所を選択します。</span><span class="sxs-lookup"><span data-stu-id="aaaba-141">In a production system, you would want to select a location near your customers or consumers of the function.</span></span>

    [!include[](../../../includes/azure-sandbox-regions-first-mention-note-friendly.md)]

1. <span data-ttu-id="aaaba-142">新しいストレージ アカウントを作成します。</span><span class="sxs-lookup"><span data-stu-id="aaaba-142">Create a new storage account.</span></span> <span data-ttu-id="aaaba-143">Azure では、アプリ名に基づいて名前が指定されます。</span><span class="sxs-lookup"><span data-stu-id="aaaba-143">Azure will give it a name based on the app name.</span></span> <span data-ttu-id="aaaba-144">必要に応じて変更できますが、この名前も固有である必要があります。</span><span class="sxs-lookup"><span data-stu-id="aaaba-144">You can change it if you like, but it must also be unique.</span></span>

1. <span data-ttu-id="aaaba-145">Azure Application Insights が **[オン]** になっていることを確認し、自分 (または顧客) から最も近いリージョンを選択します。</span><span class="sxs-lookup"><span data-stu-id="aaaba-145">Make sure that Azure Application Insights is **On** and select the region closest to you (or your customers).</span></span>
  <span data-ttu-id="aaaba-146">完了したら、構成は次のスクリーンショットにある構成のようになります。</span><span class="sxs-lookup"><span data-stu-id="aaaba-146">When you're finished, your configuration should look like the config in the following screenshot.</span></span>

  ![前の手順に従ってすべてのフィールドが構成された Function App の [作成] ブレードを示す Azure portal のスクリーンショット。](../media/3-create-function-app-settings.png)

1. <span data-ttu-id="aaaba-148">**[作成]** を選択します。デプロイには数分かかります。</span><span class="sxs-lookup"><span data-stu-id="aaaba-148">Select **Create**; deployment will take a few minutes.</span></span> <span data-ttu-id="aaaba-149">完了すると、通知を受け取ります。</span><span class="sxs-lookup"><span data-stu-id="aaaba-149">You'll receive a notification once it's complete.</span></span>

## <a name="verify-your-azure-function-app"></a><span data-ttu-id="aaaba-150">Azure 関数アプリの確認</span><span class="sxs-lookup"><span data-stu-id="aaaba-150">Verify your Azure function app</span></span>

1. <span data-ttu-id="aaaba-151">Azure portal の左側にあるメニューから、**[リソース グループ]** を選択します。</span><span class="sxs-lookup"><span data-stu-id="aaaba-151">From the Azure portal left-hand menu, select **Resource groups**.</span></span> <span data-ttu-id="aaaba-152">これで、使用可能なグループのリストに **<rgn>[サンドボックス リソース グループ名]</rgn>** という名前のリソース グループが表示されます。</span><span class="sxs-lookup"><span data-stu-id="aaaba-152">You should then see a resource group named **<rgn>[sandbox resource group name]</rgn>** in the list of available groups.</span></span>

  ![[リソース グループ] メニュー項目と <rgn>[サンドボックス リソース グループ名]</rgn> リスト項目が強調表示されている [リソース グループ] ブレードを示す Azure portal のスクリーンショット。](../media/3-resource-group.png)

1. <span data-ttu-id="aaaba-154">**<rgn>[サンドボックス リソース グループ名]</rgn>** というリソース グループを選択します。</span><span class="sxs-lookup"><span data-stu-id="aaaba-154">Select the resource group **<rgn>[sandbox resource group name]</rgn>**.</span></span> <span data-ttu-id="aaaba-155">これで、次のリストのようにリソース リストが表示されます。</span><span class="sxs-lookup"><span data-stu-id="aaaba-155">You should then see a resource list like the following list.</span></span>

  ![App Service プラン、Storage アカウント、Application Insights リソースおよび App Service のエントリを含む、<rgn>[サンドボックス リソース グループ名]</rgn> グループ内のすべてのリソースを示す Azure portal のスクリーンショット。](../media/3-resource-list.png)

<span data-ttu-id="aaaba-157">App Service としてリストされている稲妻関数アイコンの付いた項目は、新しい関数アプリです。</span><span class="sxs-lookup"><span data-stu-id="aaaba-157">The item with the lightning bolt Function icon, listed as an App Service, is your new function app.</span></span> <span data-ttu-id="aaaba-158">クリックして新しい関数の詳細を表示することができます。ここには、この関数アプリに割り当てられたパブリック URL があり、ブラウザーで開いた場合は、その Function App が実行されていることを示す既定の Web ページを取得します。</span><span class="sxs-lookup"><span data-stu-id="aaaba-158">You can click on it to open the details about the new function - it has a public URL assigned to it, if you open that in a browser, you should get a default web page that indicates your Function App is running.</span></span>
