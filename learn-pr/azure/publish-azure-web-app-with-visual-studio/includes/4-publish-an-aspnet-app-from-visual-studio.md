サイトが作成され、それを Azure にデプロイしたいとでしょう。 ここで、このニーズに最適な Azure サービスはどれか考える必要があります。 Web Apps は、アプリケーションに、高度にスケーラブルな自己適用型の Web ホスティング サービスを提供します。

ここでは、Visual Studio を使用して Azure App Service プランに ASP.NET Core Web アプリケーションを発行する方法を説明します。

## <a name="azure-subscription"></a>Azure サブスクリプション

Azure に発行するには、Azure サブスクリプションが必要です。 Azure App Service の機能のテストに、[Azure の無料アカウント](https://azure.microsoft.com/free/)を使用できます。

## <a name="what-is-web-apps"></a>Web Apps とは

Azure App Service の Web Apps 機能は、Web アプリケーション、REST API、およびモバイル バックエンドをホストするためのサービスです。 Web Apps のホスト コードは、.NET、.NET Core、Java、Ruby、Node.js、PHP および Python などのさまざまな言語で記述されています。 Web Apps は、特にホスティング インフラストラクチャを制御する必要があまりない、ほとんどの Web サイトに最適です。

## <a name="what-is-the-app-service-plan"></a>App Service プランとは

App Service プランでは、コンピューティング リソースの場所、そのプランで消費できる追加のリソースの数、使用されているサービス プランの種類など、アプリが使用するコンピューティング リソースを定義します。 これらのコンピューティング リソースは従来の Web ホスティングのサーバー ファームに似ています。 同じ App Service プランで 1 つ以上のアプリを実行するように構成することができます。

アプリをデプロイする場合、新しい App Service プランを作成するか、アプリを既存のプランに追加し続けます。  ただし、同じ App Service プラン内のアプリは、同じコンピューティング リソースを共有します。 新しいアプリが必要なリソースを持てるかどうかを判断するには、既存の App Service プランの容量と新しいアプリの予想される負荷について理解する必要があります。 App Service プランのオーバーロードは、新規および既存のアプリのダウンタイムを引き起こす可能性があります。

App Service プランは、事前に Azure portal で、PowerShell または Azure CLI を使用して定義することができます。また、アプリケーションを Visual Studio で発行するときにそれを設定することも可能です。

各 App Service プランでは以下を定義します。

- リージョン (米国西部、米国東部など)
- VM インスタンスの数
- VM インスタンスのサイズ (小、中、大)
- 価格レベル (Free、Shared、Basic、Standard、Premium、PremiumV2、Isolated、従量課金)

## <a name="specify-the-region"></a>リージョンを指定する

App Service プランを作成する場合に、そのプランをホストするリージョンや場所を定義する必要があります。 通常、見込み顧客に地理的に近いリージョンを選択します。

## <a name="what-are-the-pricing-and-reliability-levels"></a>価格と信頼性のレベルとは

Azure App Service にアプリをデプロイするときの重要な要因は、正しいサービス プランの選択です。 App Service プランは、いつでもスケールアップまたはスケールダウンできます。 最初に低い価格レベルを選び、後で App Service 機能がさらに必要になったときにスケールアップできます。

価格レベルにはいくつかのカテゴリがあります。

**共有コンピューティング**: 2 つの基本レベルである **Free** と **Shared** は、他のお客様のアプリを含む他の App Service アプリと同じ Azure VM 上でアプリを実行します。 これらのレベルは共有リソースで実行される各アプリに CPU クォータを割り当て、リソースはスケールアウトできません。

Free および Shared プランは、トラフィックの需要が非常に少ない小規模な個人プロジェクトに最適です。限度として、24 時間ごとに 165 MB の送信データが設定されています。

**専用コンピューティング**: **Basic、Standard、Premium、PremiumV2** のレベルはアプリを専用の Azure VM 上で実行します。 同じ App Service プラン内のアプリのみが同じコンピューティング リソースを共有します。 レベルが高いほど、スケールアウトに使用できる VM インスタンスが多くなります。

Standard サービス プランは、商用のアプリをお客様に発行する、ライブ プロダクション ワークロードに最適です。
Premium サービス プランは、専用 (Isolated) プランによる追加コストを支払いたくない、処理能力の高い Web アプリをサポートしています。

**Isolated**: このレベルは、専用の Azure VM を専用の Azure 仮想ネットワーク上で実行し、コンピューティングの分離の上のネットワークの分離をアプリに提供します。 最大のスケールアウト機能を提供します。 Isolated サービス プランは、最高レベルのセキュリティおよびパフォーマンスが必要な特殊な場合を除き、選択しません。

次の場合にはアプリを新しい App Service プランに分離してください。

- アプリが多くのリソースを消費している。
- 既存のプランの他のアプリとは別に、そのアプリをスケーリングする必要がある。
- アプリに別の地理的なリージョンのリソースが必要である。

**従量課金**: このレベルは関数アプリにのみ使用できます。 ワークロードに応じて関数を動的にスケーリングします。 詳細については、「Azure Functions のホスティング プラン」を参照してください。

## <a name="specify-the-resource-group"></a>リソース グループを指定する

多くの Azure リソース同様、使用するリソース グループを指定する必要があります。 既存のリソース グループを使用することも、Visual Studio から新しいリソース グループを作成することもできます。 リソース グループとは、Web アプリ、データベース、ストレージ アカウントなどの Azure リソースのデプロイと管理に使用する論理コンテナーです。 これは、関連するリソースを一緒に保持する便利なメカニズムです。

## <a name="deploy-your-web-app-from-visual-studio"></a>Visual Studio から Web アプリをデプロイする

アプリの Azure から Visual Studio への発行は、短時間で行えます。

### <a name="select-the-project"></a>プロジェクトを選択する

1. ソリューション エクスプローラーで、プロジェクトを右クリックします。

1. **[発行]、[Azure に発行する]** の順に選択します。

### <a name="configure-the-app-service-plan-in-windows"></a>Windows で App Service のプランを構成する

1. App Service のプランを構成する

    - Hosting\(ホスティング\): このタブでは、App Service のプランを設定します。ここでは、アプリをホストする Web サーバー ファームの場所、サイズ、機能を指定します。 既存のホスティング プランを選択するか、新しいホスティング プランを作成します。 Windows によって、グローバルに一意の名前が自動的に生成されます。この名前は、設定中に変更することができます。
    - サービス: ここで、サイトの SQL データベースを構成できます。

        > [!NOTE]
        > Visual Studio から Azure の SQL データベースに接続し、それを管理します。しかし、このモジュールではそれについては扱いません。

1. **[作成]** をクリックして、アプリをデプロイします。 これが完了すると、Visual Studio によりサイトがホストされている Web ページが起動されます。

### <a name="configure-the-app-service-plan-for-mac"></a>Mac 向けの App Service プランを構成する

1. Azure で設定済みの場合、既存の App Service プランを選択するか、新しいものを作成することができます。

1. このタブで App Service プランを構成します。ここでは、アプリをホストする Web サーバー ファームの場所、サイズ、機能を指定します。 既存のホスティング プランを選択するか、新しいホスティング プランを作成します。 Azure では、Web サイトと、すべてのリソースの名前がグローバルに一意である必要があることに注意してください。

1. **[作成]** をクリックして、アプリをデプロイします。 これが完了すると、Visual Studio によりサイトがホストされている Web ページが起動されます。

## <a name="summary"></a>まとめ

ASP.NET Core Web アプリケーションおよび Azure App Services は、ASP.NET Web アプリをホストする柔軟でスケーラブルなソリューションです。 他の Azure サービス同様、リソース グループを提供し、ニーズを一番満たす価格レベルを選択する必要があります。
