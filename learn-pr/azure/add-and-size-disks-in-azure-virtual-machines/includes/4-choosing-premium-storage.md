一部のアプリケーションでは、データ ストレージに対する要求が他よりも厳しくなります。 たとえば、Microsoft Exchange サーバーや SharePoint サーバーを最適な状態で実行するには、高パフォーマンスのディスクが必要です。

法律事務所の案件履歴データベースを Azure に移行するシナリオをもう一度見てみましょう。 弁護士やその他のスタッフが、案件の詳細情報にできるだけ迅速にアクセスできるようにする必要があります。 事務所の業績が拡大しており、データベースで需要増大に対応できるようにしたいと考えています。

Azure で仮想マシン (VM) のパフォーマンスを最大化する方法の 1 つが、仮想ハード ドライブ (VHD) に Premium Storage を使用することです。 Premium Storage では Standard Storage よりも入出力 (IO) が高速です。 ディスク IO が高速なほど、ディスク使用率の高いアプリケーションのパフォーマンスが向上します。

ストレージのパフォーマンス レベルを比較し、Premium Storage アカウントの詳細を確認してみましょう。

## <a name="how-premium-storage-differs-from-standard-storage"></a>Premium Storage と Standard Storage の違い

Azure では、Premium Storage は、ソリッドステート ドライブ (SSD) に実装されます。 SSD はハード ディスク ドライブ (HDD) よりも IO パフォーマンスが高く、可動部分がないため信頼性にも優れています。 要求されたデータを見つけるために、読み取りまたは書き込みヘッドが、ディスク上の正しい場所に移動するがありません。 

Standard Storage は HDD に実装されます。 Standard Storage は、低いレートで課金されます。 コストを抑えるには Standard Storage を、高い IO パフォーマンスが必要な場合は Premium Storage を選択します。

1 つの VM でディスクごとに Standard Storage と Premium Storage を混在させることもできます。

> [!NOTE]
> マネージド ディスクを使用している場合は、3 つ目のオプションとして Standard SSD を選択できます。 Standard SSD は、パフォーマンスと価格の両方の面で、Standard HDD と Premium SSD の中間に位置付けられており、アンマネージド ディスクでは使用できません。 このモジュールでは、Standard SSD について後で詳しく説明します。

## <a name="premium-storage-accounts"></a>Premium Storage アカウント

Azure の汎用ストレージ アカウントには VHD がページ BLOB として格納されます。 お使いの VHD に Premium Storage を使用するには、VHD を **Premium Storage アカウント**に格納する必要があります。 ストレージ アカウントのパフォーマンス レベルは、そのアカウントを作成するときに選択します。この設定は、後から変更できません。

> [!IMPORTANT]
> Premium Storage は、すべてのAzure リージョンで利用できるわけではありません。 ご自身のリージョンで利用できるかどうかについては、「[リージョン別の利用可能な製品](https://azure.microsoft.com/en-us/global-infrastructure/services/)」をご覧ください。

### <a name="data-replication-and-premium-storage-accounts"></a>データ レプリケーションと Premium Storage アカウント

Microsoft Azure ストレージ アカウント内のデータは、持続性と高可用性を保証するため、常にレプリケートされています。 Azure Storage のレプリケーションでは、計画されたイベントや計画外のイベント (一時的なハードウェア障害、ネットワークの停止または停電、大規模な自然災害など) からデータが保護されるようにデータがコピーされます。 同じデータ センター内、同じリージョンのゾーンのデータ センター間、さらにはリージョン間でデータをレプリケートすることもできます。 レプリケーションには、次の 4 種類があります。

- **ローカル冗長ストレージ (LRS)** - 同じ Azure データ センター内でデータがレプリケートされます。 ノードで障害が発生しても、データは引き続き使用できます。 ただし、データ センター全体で障害が発生すると、データが使用できなくなる場合があります。
- **geo 冗長ストレージ (GRS)** - プライマリ リージョンから数百マイル離れたセカンダリ リージョンにデータがレプリケートされます。 お使いのストレージ アカウントで GRS が有効になっている場合、地域的な停電やプライマリ リージョンが復旧できない災害が発生しても、データは保持されます。
- **読み取りアクセス geo 冗長ストレージ (RA-GRS)** - セカンダリ ロケーションにあるデータに対する読み取り専用アクセス、および 2 つのリージョンにまたがる geo レプリケーションが提供されます。 データ センターで障害が発生しても、データは引き続き読み取り可能ですが、変更できなくなります。
- **ゾーン冗長ストレージ (ZRS)** - 1 つのリージョン内の 3 つのストレージ クラスターにデータが同期的にレプリケートされます。 各ストレージ クラスターは物理的に他のストレージ クラスターと分離されており、それぞれの可用性ゾーン (AZ) 内にあります。 この種類のレプリケーションでは、ゾーンが使用できなくなっても、お使いのデータには引き続きアクセスし、管理することができます。

Standard Storage アカウントでは、すべてのレプリケーションの種類がサポートされますが、Premium Storage アカウントでサポートされるのはローカル冗長ストレージ (LRS) のみです。 VM 自体が 1 つのリージョンで実行されているため、通常、この制限が VHD ストレージにとって問題になることはありません。

## <a name="migrating-from-standard-storage-to-premium-storage"></a>Standard Storage から Premium Storage への移行

最初から適切な種類のストレージ アカウントに VHD を作成することをお勧めします。 しかし、要件が変わったり、需要が増えたり、あるいは間違った種類を選択したことに後から気付くこともあります。 このような場合は、Premium Storage への移行を検討してください。

移行を開始する前に、ユーザーがVM を利用できなくなるダウンタイムがある程度の発生することを考慮してください。

> [!NOTE]
> Standard Storage から Premium Storage への移行の詳細については、「[Azure Premium Storage への移行 (非管理対象ディスク)](https://docs.microsoft.com/azure/storage/common/storage-migration-to-premium-storage)」を参照してください。

Azure で VM を作成する際は、コストとパフォーマンスの間で適切なバランスをとる必要があります。 データベースなど、ディスク使用率の高いアプリケーションについては、Standard Storage よりも IO 速度が速い Premium Storage が適しています。
