アプリケーションでは、データのある部分を変更すると、データの別の部分の変更が必要になるため、一連のデータ更新をグループにまとめることが必要になる場合があります。 トランザクションを使用すると、これらの更新をグループ化して、一連の更新の 1 つのイベントが失敗した場合に、グループ全体をロールバックする、つまり元に戻すことができます。 

たとえば、オンラインの小売店では、注文と支払いの確認にトランザクションを使用できます。 関連するイベントをグループ化すると、支払いの承認済みフォームを受け取るまで、在庫レベルが減りません。

ここでは、トランザクションについて、また自分のデータに対してトランザクションが必要かどうかを学習します。

## <a name="what-is-a-transaction"></a>トランザクションとは

トランザクションとは、データの取得や更新に対して独立して実行される論理単位です。

アプリケーションでトランザクションを使用する必要があるかどうかを確認するには、次のように自問してみてください。データセット内のデータのある部分を変更すると、別の部分に影響がありますか。 答えが "はい" の場合は、データベース サービスでトランザクションをサポートする必要があります。

トランザクションは、多くの場合、ACID 保証と呼ばれる 4 つの要件のセットによって定義されます。 ACID は、原子性 (Atomicity)、一貫性 (Consistency)、分離性 (Isolation)、持続性 (Durability) の頭文字です。

- 原子性とは、すべてのデータが更新される、またはすべてのデータが元の状態にロールバックされることを意味します。
- 一貫性は、トランザクションの途中で何かが起きた場合に、その部分のデータが更新されないことを保証します。 トランザクションは、全体を通じて一貫して適用するか、またはまったく適用しないかのどちらかです。
- 分離性は、あるトランザクションが別のトランザクションの影響を受けないことを保証します。
- 持続性とは、トランザクションによって行われた変更がシステムに永続的に保存されることを意味します。 コミットされたデータは、障害が発生したりシステムが再起動した場合でも、データを正しい状態で使用できるように、システムによって保存されます。

データベースで ACID が保証されていると、これらの原則がすべてのトランザクションに対して一貫して適用されます。

## <a name="oltp-vs-olap"></a>OLTP と OLAP の比較

トランザクション データベースは、OLTP (オンライン トランザクション処理) システムと呼ばれることがよくあります。 一般に、OLTP システムでは、多数のユーザーがサポートされ、応答時間が速く、大量のデータが処理されます。 また、このシステムでは、可用性が高く (つまり、最小限のダウンタイム)、通常は小規模または比較的シンプルなトランザクションが処理されます。

一方、OLAP (オンライン分析処理) システムでは、一般に、少数のユーザーがサポートされ、応答時間が長く、可用性が低いことがあり、通常は大規模で複雑なトランザクションが処理されます。

OLTP と OLAP という用語は一時期ほど頻繁には使用されなくなりましたが、これらを理解していると、アプリケーションのニーズの分類が容易になります。 

トランザクション、OLTP、OLAP について学習したので、オンライン小売りシナリオの各データ セットを調べて、トランザクションが必要かどうかを判断しましょう。

## <a name="product-catalog-data"></a>製品カタログ データ

製品カタログ データは、トランザクション データベースに格納する必要があります。 ユーザーが注文を出して支払いが確認されたら、品目の在庫を更新する必要があります。 同様に、客のクレジット カードが拒否された場合は、注文をロールバックし、在庫を更新しないようにする必要があります。 これらの関係はすべて、トランザクションを必要とします。

## <a name="photos-and-videos"></a>写真とビデオ

製品カタログ内の写真やビデオについては、トランザクションのサポートは必要ありません。 これらのファイルは、更新が行われるとき、または新しいファイルが追加されるときにのみ、変更されます。 イメージと実際の製品データの間には関係がありますが、それは本質的にトランザクションではありません。

## <a name="business-data"></a>ビジネス データ

ビジネス データの場合、すべてのデータは過去のもので変化しないので、トランザクションのサポートは必要ありません。 データを扱うビジネス アナリストの場合、他の小さいデータ ポイントの合計を処理できるように、クエリで集計の操作がしばしば必要になるという、独自のニーズもあります。

## <a name="summary"></a>まとめ

データを正しい状態に維持することは、簡単な作業ではない場合があります。 トランザクションを使用すると、データに対してデータ整合性要件が適用されるので、データの維持に役立つ場合があります。 ACID の原則によってメリットがあるデータの場合は、トランザクションをサポートするストレージ ソリューションを選択します。