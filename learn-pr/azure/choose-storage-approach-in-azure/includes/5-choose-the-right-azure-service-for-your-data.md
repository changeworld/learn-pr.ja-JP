正しいストレージ ソリューションを選択すると、パフォーマンスの向上につながります。 ここでは、オンライン小売りシナリオでのデータについて学習したことを適用して、各データ セットに最適な Azure サービスを見つけます。 

## <a name="product-catalog-data"></a>商品カタログ データ

データの分類: 半構造化

操作:

* 顧客は、多くの読み取り操作と、データベース内の多くのフィールドに対してクエリを実行する機能を、必要とします。
* 店側では、常に変化する在庫を追跡するために多くの書き込み操作が必要です。

待機時間とスループット: 高スループットと低遅延

トランザクションのサポート: 必要

### <a name="recommended-service-azure-cosmos-db"></a>推奨されるサービス: Azure Cosmos DB

Azure Cosmos DB は、設計上、半構造化データつまり NoSQL データをサポートします。 そのため、Bluetooth 対応フィールドや、将来必要になる新しいフィールドなどの新しいフィールドのサポートは、Azure Cosmos DB で実現できます。

操作に関しては、Azure Cosmos DB は SQL でのクエリをサポートし、すべてのプロパティには既定でインデックスが付けられるので、ほとんどすべてのものをフィルター処理するという顧客のニーズに合わせたクエリの作成がサポートされています。

待機時間とスループットに関しては、Azure Cosmos DB ではスループットを構成できるので、ショッピングが増える期間は高い顧客需要を処理するようにスケールアップし、少なくなったらコストを節約するためにスケールダウンすることができます。 また、Azure Cosmos DB では既定ですべてのプロパティにインデックスが付けられるので、顧客は任意のフィールドでクエリを行うことができます。

Azure Cosmos DB は ACID に準拠しているので、トランザクションは厳密な要件に従って完了します。

さらに、Azure Cosmos DB ではボタンをクリックするだけで世界中のどこにでもデータをレプリケートできます。 したがって、eコマース サイトのユーザーが米国、フランス、英国に集中している場合は、これらのデータ センターにデータをレプリケートすると、データがユーザーの近くに物理的に移動するので、待機時間を短縮できます。 そして、世界各地にデータをレプリケートしても、5 つの整合性レベルのいずれかを選択して、整合性、可用性、待機時間、スループットの間のトレードオフを決定できます。

### <a name="why-not-other-azure-services"></a>他の Azure サービスにしない理由

Azure Table Storage、HDInsight の一部としての Azure HBase、Azure Redis Cache などの他の Azure サービスも、NoSQL データを格納できます。 このシナリオでは、ユーザーは複数のフィールドでのクエリを望んでいるため、Azure Table Storage、Azure Redis Cache、HDInsight の一部としての Azure HBase より Azure Cosmos DB の方が適しています。Azure Cosmos DB では既定ですべてのフィールドにインデックスが付けられるのに対し、他のサービスではインデックスが付けられるデータが制限されるため、データベースの任意のフィールドに対してクエリを実行する機能が限定されるためです。

## <a name="photos-and-videos"></a>写真とビデオ

データの分類: 非構造化

操作:

* 写真やビデオでは、ID による取得だけが必要です。
* 作成と更新はあまり頻繁ではなく、読み取り操作より待機時間が長くてもかまいません。

待機時間とスループット: ID による検索では、低遅延と高スループットをサポートする必要があります。 作成と更新は、読み取り操作より待機時間が長くてもかまいません。

トランザクションのサポート: 不要

## <a name="recommended-service-azure-blob-storage"></a>推奨されるサービス: Azure BLOB ストレージ

Azure BLOB ストレージでは、写真やビデオなどのファイルを格納できます。 また、最もよく使用されるコンテンツをキャッシュしてエッジ サーバーに格納することにより Azure Content Delivery Network (CDN) で機能し、それらの画像をユーザーに提供するときの待機時間が減ります。

Azure BLOB ストレージを使用すると、画像をホット ストレージ層からクール ストレージ層またはアーカイブ ストレージ層に移動することもでき、コストを削減して、最もよく見られる画像やビデオにスループットを集中できます。

### <a name="why-not-other-azure-services"></a>他の Azure サービスにしない理由

画像を Azure App Service にアップロードして、アプリを実行しているのと同じサーバーで画像を提供することができます。 画像が多くない場合はそれでもかまいませんが、ファイルが多い場合、およびグローバルなユーザーに対しては、Azure BLOB ストレージと Azure Content Delivery Network を使用した方が、より高いパフォーマンスの結果を得られます。

## <a name="business-data"></a>ビジネス データ

データの分類: 構造化

操作: 複数のデータベースに対する読み取り専用の複雑な分析クエリ

待機時間とスループット: クエリの複雑さによっては、結果においてある程度の待機時間が予想されます。

トランザクションのサポート: 必要

### <a name="recommended-service-azure-sql-database"></a>推奨されるサービス: Azure SQL Database

ほとんどの場合、ビジネス データのクエリはビジネス アナリストによって行われ、アナリストは他のクエリ言語より SQL をよく知っていると思われます。 Azure SQL Database だけでもソリューションとして使用できますが、Azure SQL Database と Azure Analysis Services を組み合わせると、Azure SQL Database 内のデータに対するセマンティック モデルを作成してから、それをビジネス ユーザーと共有することにより、行う必要があるすべてのことを BI ツールからのモデルに接続し、データをすぐに調べて分析情報を得ることができるようになります。 

### <a name="why-not-other-azure-services"></a>他の Azure サービスにしない理由

Azure SQL Data Warehouse は OLAP ソリューションと SQL クエリをサポートしますが、ビジネス アナリストはクロス データベース クエリを実行する必要があり、Azure SQL Data Warehouse ではサポートされていません。

Azure SQL Database に加えて Azure Analysis Services を使用できますが、ビジネス アナリストは Power BI より SQL の方を熟知しているため、SQL クエリをサポートしているデータベースを好み、Azure Analysis Services はそれをサポートしていません。 さらに、ビジネス データ セットに格納する財務データは、リレーショナルで多次元であるという性質を持っており、Azure Analysis Services はサービス自体に格納された表形式のデータはサポートしますが、多次元データはサポートしません。 Azure Analysis Services で多次元データを分析するには、Azure SQL Database への直接クエリを使用できます。

Azure Stream Analytics はデータを分析して、それをアクションにつながる分析情報に変換する優れた手段ですが、重視されているのはストリーミングされるリアルタイム データであり、この例でのビジネス アナリストは履歴データのみを調べています。

## <a name="summary"></a>まとめ

データの各カテゴリはストレージ要件が異なり、どのソリューションが最適か判断するのはユーザーの仕事です。 データのカテゴリ、必要な操作、待機時間、およびトランザクションのサポートの必要性を、常に考慮する必要があります。
