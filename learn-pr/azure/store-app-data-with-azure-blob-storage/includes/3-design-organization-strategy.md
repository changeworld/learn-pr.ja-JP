データを格納する必要があるアプリを設計するときは、そのアプリが、ストレージ アカウント、コンテナー、および BLOB にわたってどのようにデータを整理し、格納するかについて考えることが重要です。

## <a name="storage-accounts"></a>ストレージ アカウント

1 つのストレージ アカウントで BLOB を整理するのに十分な柔軟性がありますが、論理的にコストを分離し、データへのアクセス制御に必要な場合は、追加のストレージ アカウントを使用する必要があります。

## <a name="containers-and-blobs"></a>コンテナーと BLOB

アプリケーションとアプリケーションが格納するデータの性質によって、コンテナーと BLOB の名前付けと整理の方法を決める必要があります。

データベースを含むストレージ スキームの一部として BLOB を使用しているアプリは、多くの場合、そのデータに関することを表示するのに、組織、名前付け、またはメタデータに大きく依存する必要はありません。 このようなアプリは一般的に、GUID のような識別子を BLOB 名として使用し、データベース レコードでこれらの識別子を参照します。 アプリでは、データベースを使用して、BLOB が格納されている場所と BLOB に含まれているデータの種類を判断します。

その他のアプリでは、より個人のファイル システムに近い Azure Blob Storage を使用しているものもあります。この場合、意味と構造を示すためにコンテナーと BLOB の名前が使用されます。 この種のアプリでは、BLOB 名は、従来のファイル名に似ていることが多く、含まれているデータの種類を示すために `.jpg` のようなファイル名拡張子が含まれています。 これらのアプリでは、BLOB を整理するために仮想ディレクトリ (下記参照) が使用され、BLOB とコンテナーに関する情報を格納するためにメタデータ タグが頻繁に使用されます。

BLOB とコンテナーを整理して格納する方法を決定する際に、考慮すべきいくつかの重要事項があります。

### <a name="naming-limitations"></a>名前付けの制限事項

コンテナーと BLOB の名前は、長さ制限や文字の制限を含む、一連の規則に従う必要があります。 名前付け規則に関するより具体的な情報については、このモジュールの最後の「その他のリソース」をご覧ください。

### <a name="public-access-and-containers-as-security-boundaries"></a>パブリック アクセスとセキュリティ境界としてのコンテナー

既定では、すべての BLOB にはアクセスするための認証が必要です。 ただし、個々のコンテナーは、認証がなくてもその BLOB のパブリック ダウンロードができるように構成できます。 この機能は、静的な Web サイト資産のホストやファイルの共有など、多くのユース ケースをサポートします。 BLOB コンテンツのダウンロードが、Web 経由での他の種類のデータの読み取りと同じように機能するため、ブラウザーや、BLOB URL で GET 要求ができるものをポイントするだけで済みます。

**直接アクセスの URL を示す、TODO パブリック コンテナーのイメージ**

サーバー側のアプリに BLOB ストレージから直接ダウンロードしたデータによるトラフィックが生じないため、パブリック アクセスを有効にすることはスケーラビリティにとって重要です。 パブリック アクセスの利点がすぐに得られない場合や、アプリケーション経由でデータへのアクセスを制御するためにデータベースを使用する場合でも、公開するデータ用に個別のコンテナーを使用することを計画してください。

> [!CAUTION]
> パブリック アクセス用に構成されたコンテナー内の BLOB は、そのストレージ URL を知っていれば、誰でもダウンロードでき、いかなる種類の認証や監査も必要としません。 一般に共有する予定がない BLOB データをパブリック コンテナーに配置しないでください。

パブリック アクセスの他に、Azure には、コンテナーでのきめ細かいアクセス制御を可能にする Shared Access Signature 機能があります。 正確なアクセス制御により、スケーラビリティをさらに向上させるシナリオが可能になります。そのため、一般的にセキュリティ境界としてのコンテナーを考えることがガイドラインとして役立ちます。

### <a name="blob-name-prefixes-virtual-directories"></a>BLOB 名のプレフィックス (仮想ディレクトリ)

技術的には、コンテナーは "フラット" で、いかなる種類の入れ子または階層もサポートしません。 しかし、BLOB にファイル パスのような階層名 (`finance/budgets/2017/q1.xls` など) を付けると、API の一覧表示操作によって結果を特定のプレフィックスにフィルター処理できます。 これにより、ファイルとフォルダーの階層的なシステムのように、一覧内を移動できるようになります。

この機能は、一部のツールとクライアント ライブラリでファイル システムのように BLOB ストレージを視覚化して移動するために使用されているため、一般に*仮想ディレクトリ*と呼ばれます。 フォルダーを移動するたびに、そのフォルダー内の BLOB を一覧表示する別の呼び出しがトリガーされます。

**ストレージ エクスプ ローラーおよびフォルダーありのポータルの TODO イメージ**

BLOB にファイル名のような名前を使用するのは、複雑な BLOB データを整理および移動するための一般的な手法です。

### <a name="blob-types"></a>BLOB の種類

データを格納できる BLOB には、次の 3 種類があります。

- **ブロック BLOB** は、個別にまたは並列でアップロードおよびダウンロードできる異なるサイズのブロックで構成されます。 ブロック BLOB に書き込むには、データをブロックにアップロードして、それを BLOB にコミットする必要があります。これはクライアント ライブラリによって処理されます。
- **追加 BLOB** は、新しいデータの追加だけをサポートする (既存のデータの更新または削除はサポートされません) 特殊なブロック BLOB ですが、データの追加には非常に効率的です。 追加 BLOB はログやストリーミング データを格納するようなシナリオに適しています。
- **ページ BLOB** は、ランダム アクセスの読み取りと書き込みを伴うシナリオ用に設計されています。 ページ BLOB は Azure Virtual Machines で使用される仮想ハード ディスク (VHD) ファイルの格納に使用されますが、ランダム アクセスを伴うすべてのシナリオに適しています。

追加 BLOB やページ BLOB を特に必要としないほとんどのシナリオには、ブロック BLOB が最適な選択肢です。