あなたはニュース速報通知を提供する大手のニュース配信会社に勤務していると考えてください。 会社は世界中に広がるジャーナリストのネットワークを擁し、それらのジャーナリストから Web ポータルとモバイル アプリを通して常に更新情報が送信されます。 中間層である Web サービス レイヤーでは、それらの通知の更新情報を受け取り、複数のチャネルを通じてオンラインに公開します。

ただし、世界的に重要なできごとが起こったときに、システムで通知が行われていないことがわりました。 スクープを競争相手に奪われていることになるため、これは "_重大な_" 問題です。 問題を特定して修正するために、あなたが会社の開発者のトップに選定されました。

中間層には、通常の負荷を処理するのに十分な容量があります。 ただし、サーバーのログを見ると、大きめのサイズの記事を複数のジャーナリストが同時にアップロードしようとしたときに、システムがオーバーロード状態になっていたことがわかりました。 ポータルが応答しなくなったと訴えるライターや、記事が全部消失したと訴えるライターもいました。 あなたは、報告された問題と中間層サーバー上での需要の急上昇との間に、直接的な相関関係があることを発見しました。

明らかに、このような予期しない負荷上昇を処理する方法が必要です。 あなたは、Web サイトと中間層の Web サービスのインスタンスを追加することは望んでいません。なぜなら、費用がかかり、しかも通常の状態では冗長だからです。 インスタンスを動的に起動することも可能ですが、それには時間がかかり、新たなサーバーがオンラインになるのを待機する際に問題が発生すると考えられます。

この問題は、Azure Queue Storage を使用して解決することができます。 ストレージ キューは、フロントエンド コンポーネント ("プロデューサー") と中間層 ("コンシューマー") との間でブローカーとして機能することができる、高パフォーマンスのメッセージ バッファーです。 

新たな通知ごとに、フロントエンド コンポーネントによってメッセージがキューに配置されます。 中間層では、これらのメッセージをキューから一度に 1 つずつ取り出して、処理します。 需要が多いときには、キューが長くなる場合がありますが、記事が失われることはありません。また、アプリケーションは応答性を維持します。 需要が通常のレベルに戻ると、たまっているキューのバックログが Web サービスによって処理されます。

Azure Queue Storage を使用して高需要を処理し、分散アプリケーションの復元性を高める方法を学習しましょう。

## <a name="learning-objectives"></a>学習の目的

- キューをサポートする Azure Storage アカウントを作成します。
- C# と .NET 用 Azure Storage クライアント ライブラリを使用してキューを作成します。
- C# と .NET 用 Azure Storage クライアント ライブラリを使用してキューにメッセージを追加し、またキューからメッセージを取得および削除します。