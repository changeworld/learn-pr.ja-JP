この演習では、Azure portal を使用して、南カリフォルニアの架空のサーフィン レポート Web App に適したストレージ アカウントを作成します。

## <a name="design-goals"></a>デザインの目標

このサーフィン レポート サイトでは、ユーザーが現地のビーチの状態の写真とビデオをアップロードすることができる。 表示するユーザーは、そのコンテンツを使って、サーフィンに最適な状態のビーチを選ぶことができる。 デザインと機能の目標は次のとおりです。

- ビデオ コンテンツはすばやく読み込まれる必要がある
- このサイトではアップロード ボリュームの予期しない上昇を処理する必要がある
- サーフィンの状態が変更されると、古くなったコンテンツは削除されるため、サイトでは常に現在の状態が示される

処理用の Azure キューでアップロードされたコンテンツをバッファー処理し、ストレージ用の Azure BLOB に移動する実装に決めます。 コンテンツに対して待機時間の短いアクセスを提供しながら、キューと BLOB の両方を保持できるストレージ アカウントが必要です。

## <a name="exercise-steps"></a>演習の手順

### <a name="launch-the-blade"></a>ブレードを起動する

1. ご利用の Web ブラウザーから [Azure portal](https://portal.azure.com?azure-portal=true) に移動し、ご自分のアカウントでサインインします。

1. 左サイドバーで **[リソースの作成]** を選択します。

1. Azure Marketplace で **[ストレージ]** 見出しを選択します。

1. **[ストレージ アカウント]** を選択します。 ポータルに **[ストレージ アカウントを作成する]** ブレードが表示されます。

### <a name="configure-the-basic-options"></a>基本的なオプションを構成する

1. ブレードの上部で **[基本]** タブを選択します。

1. **[サブスクリプション]**: ご使用のサブスクリプションのいずれかを選択します。

1. **[リソース グループ]**: 「**SurfReportResourceGroup**」という名前の新しいリソース グループを作成します。

1. **[ストレージ アカウント名]**: グローバルに一意の値 (`surfreport` + イニシャル + 数字など) を入力します。

 1. **[場所]**: **[米国西部]** を選択します。

    根拠: このアプリケーションは、南カリフォルニアのユーザーを想定しています。 ビデオを読み込むときの待機時間を最小限に抑えるには、BLOB をこれらのユーザーの近くでホストする必要があります。そのため、**[米国西部]** が最適な選択になります。

1. **[デプロイ モデル]**: **[Resource Manager]** を選択します。
    
    根拠: リソース グループを使用して、このアプリケーション用の Web App、ストレージ アカウントなどを管理できるようにするため、**[Resource Manager]** が適しています。

1. **[パフォーマンス]**: **[Standard]** を選択します。

    根拠: **[Premium]** オプションでは、ページ BLOB に対してストレージ アカウントを制限するため、このオプションを使用することはできません。 どちらも **[Standard]** オプションでのみ利用できる、ビデオ用のブロック BLOB とバッファリング用のキューが必要です。

1. **[アカウントの種類]**: **[StorageV2 (汎用 v2)]** を選択します。

    根拠: ここでは **[StorageV2 (汎用 v2)]** が最適な選択です。 BLOB とキューを組み合わせる必要があるため、**[BLOB ストレージ]** オプションは使用できません。 このアプリケーションでは、アクセスできる機能が制限され、予想されるワークロードのコストを削減できる可能性が低いため、**[Storage (汎用 v1)]** アカウントを選択してもメリットはありません。

1. **[レプリケーション]**: **[ローカル冗長ストレージ (LRS)]** を選択します。

    根拠: イメージとビデオはすぐに古くなり、サイトから削除されます。 つまり、グローバルな冗長性のために追加料金を払う価値がほとんどないということです。 致命的な障害でデータを失った場合は、ユーザーからの最新コンテンツでサイトを再開することができます。

1. **[アクセス層 (既定)]**: **[ホット]** を選択します。
   
    根拠: ビデオをすばやく読み込む必要があるため、BLOB に高パフォーマンス オプションを使用します。
   
次のスクリーンショットは、**[基本]** タブの設定が完了したことを示しています。

![**[基本]** タブが選択されている [ストレージ アカウントを作成する] ブレードのスクリーンショット。](../media-drafts/5-create-storage-account-basics.png)

### <a name="configure-the-advanced-options"></a>詳細オプションを構成する

1. ブレードの上部で **[詳細]** タブを選択します。

1. **[安全な転送が必須]**: **[有効]** を選択します。

    根拠: 一般的にネットワーク全体で HTTP を使用することが、ベスト プラクティスと見なされます。

1. **[仮想ネットワーク]**: **[無効]** を選択します。

    根拠: コンテンツは一般向けであり、パブリック コンテンツからのアクセスを許可する必要があります。

次のスクリーンショットは、**[詳細]** タブの設定が完了したことを示しています。

![**詳細** タブが選択されている [ストレージ アカウントを作成する] ブレードのスクリーンショット。](../media-drafts/5-create-storage-account-advanced.png)

### <a name="create"></a>作成

1. ブレードの下部にある **[確認および作成]** ボタンをクリックします。

1. 次の画面で、ブレードの下部にある **[作成]** をクリックします。

1. リソースが作成されるまで待機します。

### <a name="verify"></a>確認

1. 左サイドバーで **[ストレージ アカウント]** リンクを選択します。

1. 一覧で新しいストレージ アカウントを見つけて、作成が成功したことを確認します。

### <a name="clean-up"></a>クリーンアップ

1. 左サイドバーで **[リソース グループ]** リンクを選択します。

1. 一覧で **[SurfReportResourceGroup]** を見つけます。

1. **[SurfReportResourceGroup]** エントリを右クリックして、コンテキスト メニューから **[リソース グループの削除]** を選択します。

1. 確認フィールドにリソース グループ名を入力します。

1. **[削除]** ボタンをクリックします。

## <a name="summary"></a>まとめ

お客様のビジネス要件による設定でストレージ アカウントを作成しました。 たとえば、顧客の所在地が主に南カリフォルニアのため、米国西部のデータセンターを選択しています。 これが一般的なフローです。まず、ご自分のデータと目標を分析し、条件に合うストレージ アカウントのオプションを構成します。