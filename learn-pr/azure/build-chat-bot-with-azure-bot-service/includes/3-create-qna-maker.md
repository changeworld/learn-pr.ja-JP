[!INCLUDE [0-vm-note](0-vm-note.md)]

[Azure Cognitive Services](https://www.microsoft.com/cognitive-services/) の一部である [QnA Maker](https://www.qnamaker.ai/) は、人工知能 (AI) と機械学習に基づくインテリジェントなアプリを構築するためのサービスと API のスイートです。 ユーザーからのあらゆる質問を予測して応答するようにボットをコーディングするのではなく、QnA Maker で作成された質問と回答のナレッジ ベースにボットを接続することができます。 一般的な使用シナリオは、"Windows プロダクト キーはどこにありますか" や "Visual Studio Code はどこでダウンロードできますか" といったドメイン固有の質問にボットで回答できるように、FAQ ページの URL からナレッジ ベースを作成することです。

このユニットでは、QnA Maker を使用して、"スーパー ボウルで最も優勝回数の多い NFL チームはどこですか" や "世界最大の都市はどこですか" といった質問を含むナレッジ ベースを作成します。 次に、HTTPS エンドポイントを経由してアクセスできるように、ナレッジ ベースを Azure Web アプリにデプロイします。

1. VM ブラウザーで https://www.qnamaker.ai を開いて QnA Maker ポータルを開き、**[サインイン]** を選択し、Azure portal のサインインに使用した同じラボ アカウントでサインインします。 

1. ハンバーガー メニューを選択し、**[ナレッジ ベースの作成]** を選択します。 

1. **[Create a QnA service]\(QnA サービスの作成\)** を選択します。

1. Azure portal タブが新しく開いたら、**[名前]** ボックスに名前を入力します。 この名前は、Azure 内で一意である必要があるため、名前の横*および*ブレードの下の方にある **[アプリ名]** ボックスに緑色のチェック マークが表示されることを確認します。

1. **[リソース グループ]** の下で **[既存のものを使用]** を選択し、この演習のために事前に作成した演習用リソース グループを選択します。

1. ドロップダウンの利用可能な一覧から **[場所]** を選択します。 

1. **[管理価格レベル]** として **[F0]** を選択します。 

1. **[価格レベルの検索]** として **[F]** を選択します。 

1. **[アプリ名]** が Azure に固有であることを確認します。

1. 両方の場所のドロップダウンで最も近い場所を選択してから、ブレードの下部にある **[作成]** ボタンを選択します。

    ![説明した構成値が設定された QnA Maker の [作成] ブレードを表示している Azure portal のスクリーンショット。](../media/3-new-qna-maker-service.png)

1. ポータルの左側にあるリボンで **[リソース グループ]** を選択し、事前に作成した演習用リソース グループを開きます。 ブレードの上部の "デプロイ中" が、QnA のサービスとそれに関連付けられているリソースが正常にデプロイされたことを示す "成功" に変わるまで待ちます。 メッセージが消えたら、メニュー バーのベル アイコンを選択し、状態を表示できます。 また、ブレードの上部の **[更新]** をクリックすると、デプロイ状態が更新されます。

1. VM ブラウザーで https://www.qnamaker.ai/Create を開いて **[ナレッジ ベースの作成]** に戻り、**[手順 2]** までスクロールし、QnA サービスに接続します。

1. **[Microsoft Azure Directory ID]\(Microsoft Azure Directory ID\)** で **[Microsoft Learn Hosting]\(Microsoft Learn Hosting\)** を選択します。

1. **[Azure サブスクリプション名]** ドロップダウン リストから **[Microsoft Learn Hosting]\(Microsoft Learn Hosting\)** を選択します。

1. **[Azure QnA service]\(Azure QnA サービス\)** で、前に指定した QnA サービスの名前を選択します。 サービスが一覧にないときは、場合によっては、ページを更新する必要があります。

1. 次に、ナレッジ ベースに "Factbot ナレッジ ベース" などの名前を割り当てます。

1. QnA Maker のナレッジ ベースに手動で質問と回答を入力することも、オンラインのよく寄せられる質問またはローカル ファイルから質問と回答をインポートすることもできます。 サポートされている形式には、タブ区切りテキスト ファイル、Microsoft Word 文書、Excel スプレッドシート、および PDF ファイルが含まれます。

    たとえば、VM ブラウザーで https://github.com/MicrosoftDocs/mslearn-build-chat-bot-with-azure-bot-service/blob/master/Factbot.tsv.zip を開き、**Factbot.tsv.zip** ファイルをダウンロードします。 この zip フォルダーには **Factbot.tsv** という名前のテキスト ファイルが含まれています。 ファイルを抽出し、コンピューターにコピーします。 次に、VM ブラウザーで、QnA Maker ポータル内を下にスクロールし、**[+ ファイルの追加]** を選択し、**Factbot.tsv** を選択します。 このファイルには、20 個の質問と回答がタブ区切り形式で含まれています。

1. ページの下部の **[Create your KB]\(KB の作成\)** を選択して、ナレッジ ベースが作成されるのを待ちます。 通常は 1 分もかかりません。

1. **Factbot.tsv** からインポートされた質問と回答がナレッジ ベースに表示されることを確認します。 次に、**[Save and train]\(保存してトレーニング\)** を選択し、トレーニングが完了するのを待ちます。

    ![読み込まれたナレッジ ベースのデータを表示している Factbot ナレッジ ベース サイトのスクリーンショット。](../media/3-save-and-train.png)

1. **[Save and train]\(保存してトレーニング\)** ボタンの右にある **[テスト]** ボタンを選択します。 メッセージ ボックスに「こんにちは」と入力して、**Enter** キーを押します。 次に示すように、応答が "QnA Factbot へようこそ" となることを確認します。

    ![作成されたチャット ボットとの対話テストのスクリーンショット。](../media/3-test-kb.png)

1. メッセージ ボックスに、「最も売れた本は何ですか?」と入力し、 **Enter** キーを押します。 応答はどのようになるでしょう。

1. もう一度 **[テスト]** ボタンを選択し、[テスト] パネルを折りたたみます。 
1. ページ上部のメニューで **[発行]** を選択し、ページの下部にある **[発行]** ボタンを選択してナレッジ ベースを発行します。 *発行* すると、ナレッジ ベースが HTTPS エンドポイントで使用可能になります。

発行プロセスが完了するまで待機し、QnA サービスがデプロイされたことを確認します。 これで、ナレッジ ベースが独自の Azure Web アプリでホストされるようになったので、次の手順では、それを使用できるボットをデプロイします。
