<span data-ttu-id="54aaa-101">アプリケーションに必要なクライアント ライブラリを追加し、Azure Storage アカウントに接続する準備が整いました。</span><span class="sxs-lookup"><span data-stu-id="54aaa-101">You have added the required client libraries to your application and are ready to connect to your Azure Storage account.</span></span> <span data-ttu-id="54aaa-102">ただ、接続するアカウントと、そのストレージ アカウントの存在領域を、アプリはどのように把握するのでしょうか?</span><span class="sxs-lookup"><span data-stu-id="54aaa-102">However, how does your app know what account to connect to and what region that storage account exists in?</span></span> <span data-ttu-id="54aaa-103">正しく構成しないと、アプリは Azure Storage アカウントに接続する方法がわかりません。</span><span class="sxs-lookup"><span data-stu-id="54aaa-103">Without appropriate configuration, your app will not know how to connect to your Azure Storage account.</span></span> 

<span data-ttu-id="54aaa-104">ここでは、Azure portal でストレージ アカウントの接続情報を検索し、アプリケーションの構成に追加して、アプリが Azure Storage アカウントに接続できるようにします。</span><span class="sxs-lookup"><span data-stu-id="54aaa-104">Here, you'll locate the storage account connection information in the Azure portal and place it into your application configuration so that your app is ready to connect to your Azure Storage account.</span></span>

## <a name="access-keys"></a><span data-ttu-id="54aaa-105">アクセス キー</span><span class="sxs-lookup"><span data-stu-id="54aaa-105">Access keys</span></span>

<span data-ttu-id="54aaa-106">各ストレージ アカウントには、ストレージ アカウントへのアクセスが許可されるアクセス キーのセットがあります。</span><span class="sxs-lookup"><span data-stu-id="54aaa-106">Each storage account has a set of access keys that allow access to the storage account.</span></span> <span data-ttu-id="54aaa-107">アプリが複数のストレージ アカウントに接続する必要がある場合、アプリには各ストレージ アカウント用にアクセス キーが必要です。</span><span class="sxs-lookup"><span data-stu-id="54aaa-107">If your app needs to connect to multiple storage accounts, then your app will require access keys for each storage account.</span></span>

![複数のアカウント](..\media-draft\7-multiple-accounts.png)

<span data-ttu-id="54aaa-109">Azure はクラウド プロバイダーであるため、ストレージ アカウントへの認証用のアクセス キーに加え、インターネットからストレージ アカウントにアクセスするためのストレージ サービスのエンドポイントを認識している必要があります。</span><span class="sxs-lookup"><span data-stu-id="54aaa-109">Since Azure is a cloud provider, in addition to access keys for authentication to storage accounts, your app will need to know the storage service endpoints that provide access over the internet to your storage account.</span></span> <span data-ttu-id="54aaa-110">この情報を処理する最もシンプルな方法は、1 つの文字列に必要なすべての接続情報が含まれるストレージ アカウント接続文字列を使用することです。</span><span class="sxs-lookup"><span data-stu-id="54aaa-110">The simplest way to handle this information is to use the storage account connection string, which contains all needed connectivity information in a single string.</span></span>

<span data-ttu-id="54aaa-111">Azure Storage Connection 文字列は、下の例と類似していますが、ご利用の特定のストレージ アカウントのアクセス キーとアカウント名が使用されたものである必要があります。</span><span class="sxs-lookup"><span data-stu-id="54aaa-111">Azure Storage Connection strings look similar to the example below but with the access key and account name of your specific storage account:</span></span>

```csharp
DefaultEndpointsProtocol=https;AccountName={your-storage};AccountKey={your-access-key};EndpointSuffix=core.windows.net
```

## <a name="security"></a><span data-ttu-id="54aaa-112">セキュリティ</span><span class="sxs-lookup"><span data-stu-id="54aaa-112">Security</span></span>

<span data-ttu-id="54aaa-113">アクセス キーは、ストレージ アカウントにアクセスするために重要で、ストレージ アカウントにアクセスを許可したくないシステムまたはユーザーには知らせないようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="54aaa-113">Access keys are critical to providing access to your storage account and as a result, should not be given to any system or person that you do not wish to have access to your storage account.</span></span> <span data-ttu-id="54aaa-114">アクセス キーは、コンピューターにアクセスするためのユーザー名とパスワードと同じです。</span><span class="sxs-lookup"><span data-stu-id="54aaa-114">Access keys are the equivalent of a username and password to access your computer.</span></span>

![コンテナー内のキー](..\media-draft\8-keys-vault.png)

<span data-ttu-id="54aaa-116">通常、ストレージ アカウントの接続情報は、環境変数、データベース、または構成ファイルに格納されます。</span><span class="sxs-lookup"><span data-stu-id="54aaa-116">Typically, storage account connectivity information is stored within an environment variable, database, or configuration file.</span></span>

<span data-ttu-id="54aaa-117">この情報を構成ファイルに格納した場合、そのファイルがソース コントロールに含められ、パブリック リポジトリに格納された場合も危険であることに注意をすることが重要です。</span><span class="sxs-lookup"><span data-stu-id="54aaa-117">It is important to note that storing this information in a configuration file can also be dangerous if you include that file in source control and store it in a public repository.</span></span> <span data-ttu-id="54aaa-118">これはよく行われる間違いで、パブリック リポジトリにあるソース コードのストレージ アカウントの接続情報は、すべてのユーザーが参照できてしまいます。</span><span class="sxs-lookup"><span data-stu-id="54aaa-118">This is a common mistake and means that anyone can browse your source code in the public repository and see your storage account connection information.</span></span>

<span data-ttu-id="54aaa-119">ストレージ アカウントには、Shared Access Signatures と呼ばれる、有効期限と、アクセスを制限したいシナリオでの制限付きのアクセス許可の付与をサポートする別の認証メカニズムがあります。</span><span class="sxs-lookup"><span data-stu-id="54aaa-119">Storage Accounts offer a separate authentication mechanism called Shared Access Signatures that support expiration and limited permissions for scenarios where you need to grant limited access.</span></span> <span data-ttu-id="54aaa-120">このトピックは、このモジュールに必要な知識ではなく、ここでは取り上げません。詳細については、[こちら](https://docs.microsoft.com/en-us/azure/storage/common/storage-dotnet-shared-access-signature-part-1)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="54aaa-120">This topic will not be covered here and is not required knowledge for this module, however more information can be found [here](https://docs.microsoft.com/en-us/azure/storage/common/storage-dotnet-shared-access-signature-part-1).</span></span>

<span data-ttu-id="54aaa-121">各ストレージ アカウントには、アクセス キーが 2 つあります。</span><span class="sxs-lookup"><span data-stu-id="54aaa-121">Each storage account has two access keys.</span></span> <span data-ttu-id="54aaa-122">これは、ストレージ アカウントを安全に保つためのセキュリティ上のベスト プラクティスとして、キーを定期的にローテーション (再生成) するためです。</span><span class="sxs-lookup"><span data-stu-id="54aaa-122">The reason for this is to allow keys to be rotated (regenerated) periodically as part of security best practice in keeping your storage account secure.</span></span> <span data-ttu-id="54aaa-123">この手順は、Azure portal または CLI から実行できます。</span><span class="sxs-lookup"><span data-stu-id="54aaa-123">This process can be done from the Azure portal or the CLI.</span></span>

<span data-ttu-id="54aaa-124">キーをローテーションすると元のキー値が即座に無効になり、キーを不正に取得したユーザーのアクセスが取り消されます。</span><span class="sxs-lookup"><span data-stu-id="54aaa-124">Rotating a key will invalidate the original key value immediately and will revoke access to anyone who obtained the key inappropriately.</span></span> <span data-ttu-id="54aaa-125">2 つのキーがサポートされているため、キーのローテーション時に、キーを使用するアプリケーションでダウンタイムが発生しないようにできます。</span><span class="sxs-lookup"><span data-stu-id="54aaa-125">With support for two keys, you can rotate keys without causing downtime in your applications that use them.</span></span> <span data-ttu-id="54aaa-126">アプリで別のアクセス キーを使用するように切り替えて、その間にもう 1 つのキーを再生成します。</span><span class="sxs-lookup"><span data-stu-id="54aaa-126">Your app can switch to using the alternate access key, while the other key is regenerated.</span></span> <span data-ttu-id="54aaa-127">このストレージ アカウントを使用するアプリが複数ある場合、このテクニックを使用するために、すべてで同じキーを使用するようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="54aaa-127">If you have multiple apps using this storage account, they should all use the same key to support this technique.</span></span> <span data-ttu-id="54aaa-128">詳細については、[こちらを](https://docs.microsoft.com/en-us/azure/storage/common/storage-create-storage-account#manage-your-storage-access-keys)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="54aaa-128">See [here](https://docs.microsoft.com/en-us/azure/storage/common/storage-create-storage-account#manage-your-storage-access-keys) for more information.</span></span>

## <a name="advanced-security-options"></a><span data-ttu-id="54aaa-129">高度なセキュリティ オプション</span><span class="sxs-lookup"><span data-stu-id="54aaa-129">Advanced security options</span></span>

<span data-ttu-id="54aaa-130">Azure には、アクセス キー、パスワードや証明書など、すべての形式のシークレットを安全に格納するよう設計されている、Azure Key Vault と呼ばれる優秀なセキュリティ ストアがあります。</span><span class="sxs-lookup"><span data-stu-id="54aaa-130">Azure offers a high-grade security store called Azure Key Vault designed to securely store any form of secrets like access keys, passwords, or certificates.</span></span> <span data-ttu-id="54aaa-131">この機能を使用すると、アクセス キーを安全に格納して、自動的にローテーションされるようにできます。</span><span class="sxs-lookup"><span data-stu-id="54aaa-131">Using this feature, you can safely store your access keys and have them auto-rotated.</span></span>

<span data-ttu-id="54aaa-132">この機能は、このモジュールでは扱いません。詳細については、[こちら](https://docs.microsoft.com/en-us/azure/key-vault/key-vault-ovw-storage-keys)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="54aaa-132">This feature is outside the scope of this module, but more information can be found [here](https://docs.microsoft.com/en-us/azure/key-vault/key-vault-ovw-storage-keys)</span></span>

## <a name="summary"></a><span data-ttu-id="54aaa-133">まとめ</span><span class="sxs-lookup"><span data-stu-id="54aaa-133">Summary</span></span>

<span data-ttu-id="54aaa-134">Azure Storage アカウントに接続するには、次の 2 つが必要です。</span><span class="sxs-lookup"><span data-stu-id="54aaa-134">To connect to an Azure Storage account, you need two things.</span></span> <span data-ttu-id="54aaa-135">機密にする必要がある、ユーザー名とパスワードと似ているアクセス キーです。</span><span class="sxs-lookup"><span data-stu-id="54aaa-135">An access key, which is similar to a username and password and should be kept confidential.</span></span> <span data-ttu-id="54aaa-136">接続文字列で表現するストレージ サービス エンドポイントも必要です。</span><span class="sxs-lookup"><span data-stu-id="54aaa-136">You also need a storage service endpoint, which is represented by a connection string.</span></span>

