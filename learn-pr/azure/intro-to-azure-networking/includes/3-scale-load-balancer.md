現在あなたのサイトは、Azure で実行されています。 毎日 24 時間、サイトが確実に稼働するようにするにはどうすればよいですか?

たとえば、毎週のメンテナンスを行う必要がある場合は、どうなりますか? メンテナンス期間中、サービスは使用できなくなります。 また、あなたのサイトのユーザーは世界中にいるため、メンテナンスのためにシステムを停止するのに都合のよい時間帯はありません。 同時に接続するユーザーが多すぎると、パフォーマンスの問題も発生します。

## <a name="what-are-availability-and-high-availability"></a>耐久性と高可用性とは何ですか?

_可用性_とは、サービスが中断なく稼働する長さを指します。 _高可用性_は _、_ 長期間稼働するサービスを指します。

あなたが毎日アクセスしているソーシャル メディアやニュース サイトを考えてみてください。 そのサイトには常にアクセスできますか、それとも "503 サービス利用不可" などのエラー メッセージが頻繁に表示されますか? 必要な情報にアクセスできないことがどれほどいら立たしいことかはおわかりでしょう。

「ファイブ ナイン可用性」のような言葉を聞いたかもしれません ファイブ ナインの可用性とは、サービスが 99.999% の時間実行されることを保証することを意味しています。 100% の可用性を実現するのは困難ですが、多くのチームが少なくともファイブ ナインの実現に努めています。

## <a name="what-is-resiliency"></a>回復性とは何ですか?

_回復性_は、異常な状態でシステムが機能を維持できる能力を指します。

異常な状態には次のようなものがあります。

- 自然災害。
- システム メンテナンスの場合は、計画的および計画されていない、ソフトウェア更新プログラムやセキュリティ更新プログラムを含むです。
- サイトにトラフィックの急増します。
- サービス、または、DDoS の分散の拒否攻撃など、悪意のある関係者による脅威について取り上げます。

マーケティング チームは、新製品の行を昇格するフラッシュ セールがある必要があることを想像してください。 あなたはこの期間にトラフィックが急増することを予想しています。 この急増がシステムの処理能力を上回ると、システムが遅くなったり停止したりして、ユーザーを失望させる恐れがあります。 あなた自分、こうした失望を味わった経験があるでしょう。 思ったことは、web サイトが応答を見つけるためだけに、イベントのチケットでしょうか。

## <a name="what-is-a-load-balancer"></a>ロード バランサーとは何ですか?

_ロード バランサー_は、プール内の各システムにトラフィックを均等に分散させます。 ロード バランサーは、高可用性と回復性の両方を実現するのに役立ちます。

たとえば、それぞれ同じように構成された VM を各階層に追加することから始めるとします。 考え方は、同時に多数のユーザーを提供しているかがダウンした場合に、追加のシステムにです。

ここでの問題は、VM ごとに独自の IP アドレスがあることです。 さらに、1 つのシステムがダウンまたはビジー状態になったときに、トラフィックを分散させる方法がないことです。 ユーザーからは 1 つのシステムと見えるように VM を接続するにはどうすればよいですか?

答えは、ロード バランサーを使用してトラフィックを分散させることです。 ロード バランサーは、ユーザーへのエントリ ポイントになります。 ロード バランサーが要求を受信するのにどのシステムを選ぶかは、ユーザーにはわかりません (知る必要はありません)。

次の図は、ロード バランサーの役割を示します。

![3 層アーキテクチャの web 層を示す図。 Web 層では、ユーザーの要求を複数の仮想マシンがあります。 仮想マシン間でユーザー要求を分散するロード バランサーがあります。](../media/3-load-balancer.png)

ロード バランサーが、ユーザーの要求を受信しているのがわかります。 ロード バランサーは、要求を Web 層内のいずれかの VM に要求を送信します。 VM が使用できない、または応答を停止している場合は、ロード バランサーはその VM へのトラフィックの送信を停止します。 次にロード バランサーは、応答しているサーバーのいずれかにトラフィックを送信します。

負荷分散することで、サービスを中断せずにメンテナンス タスクを実行することができます。 たとえば、メンテナンス期間が重ならないように VM ごとに調整することができます。 メンテナンス期間は、ロード バランサーは、VM が、応答していないと、プール内の他の Vm にトラフィックを転送を検出します。

あなたの e コマース サイトの場合、アプリ層とデータ層にもロード バランサーを配置することができます。 これは提供するサービスの必要性に応じて決まります。

## <a name="what-is-azure-load-balancer"></a>Azure Load Balancer とは何ですか?

Azure Load Balancer は、Microsoft が提供するロード バランサー サービスです。

仮想マシンにロード バランサー ソフトウェアを手動で構成できます。 欠点は、メンテナンスする必要があるシステムが増えることです。 ロード バランサーがダウンしたり定期的なメンテナンスが必要になったりすると、元の問題に戻ります。

代わりに、インフラストラクチャまたは管理するためのソフトウェアがないために、Azure Load Balancer を使用することができます。 メンテナンスするの azure で管理します。

次の図は、多層アーキテクチャでは、Azure ロード バランサーの役割を示します。

![3 層アーキテクチャの web 層を示す図。 Web 層では、ユーザーの要求を複数の仮想マシンがあります。 仮想マシン間でユーザー要求を分散するロード バランサーがあります。](../media/3-azure-load-balancer.png)

## <a name="what-about-dns"></a>DNS とは何ですか?

ドメイン ネーム システム (DNS) は、わかりやすい名前をその IP アドレスにマップする方法です。 DNS は、インターネットの電話帳として考えることができます。

たとえば、ドメイン名 contoso.com を Web 層のロード バランサーの IP アドレス 40.65.106.192 にマップできます。

独自の DNS サーバーを導入することも、Azure DNS (Azure インフラストラクチャで実行される DNS ドメインのホスティング サービス) を使用することもできます。

次の図は、Azure DNS を示します。 ユーザーが contoso.com に移動すると、Azure DNS によってトラフィックがロード バランサーにルーティングされます。

![ロード バランサーの前に配置されている Azure のドメイン ネーム システムを示す図。](../media/3-dns.png)

## <a name="summary"></a>まとめ

負荷分散を配置することで、あなたの e コマース サイトの可用性と回復力がさらに向上しました。 メンテナンスを実行したり、トラフィックが増加すると、ロード バランサーによってトラフィックを別の使用可能なシステムに分散させることができます。

ロード バランサーを構成するには、VM で、Azure Load Balancer は、インフラストラクチャまたは維持するためにソフトウェアがないため、維持費を減らします。

DNS は、わかりやすい名前をその IP アドレスにマップします。これは、電話帳で人名または企業名を電話番号にマップする方法とよく似ています。 独自の DNS サーバーを表示したり、Azure DNS を使用できます。
